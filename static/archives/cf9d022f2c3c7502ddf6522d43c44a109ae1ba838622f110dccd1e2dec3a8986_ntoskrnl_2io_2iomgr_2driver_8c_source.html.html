<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ReactOS: ntoskrnl/io/iomgr/driver.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="ReactOS"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ReactOS<span id="projectnumber">&#160;0.4.15-dev-6680-g8c76870</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">driver.c</div></div>
</div><!--header-->
<div class="contents">
<a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * PROJECT:         ReactOS Kernel</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> * LICENSE:         GPL - See COPYING in the top level directory</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * FILE:            ntoskrnl/io/iomgr/driver.c</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * PURPOSE:         Driver Object Management</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * PROGRAMMERS:     Alex Ionescu (alex.ionescu@reactos.org)</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> *                  Filip Navara (navaraf@reactos.org)</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> *                  Hervé Poussineau (hpoussin@reactos.org)</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> */</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment">/* INCLUDES *******************************************************************/</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;ntoskrnl.h&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a8de3ed741dadc9c979a4ff17c0a9116e">   14</a></span><span class="preprocessor">#define NDEBUG</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;debug.h&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="../../d5/da2/miarm_8h.html">mm/ARM3/miarm.h</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">/* GLOBALS ********************************************************************/</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a2a33c1cd002e9d995c25647d13ece5b9">   20</a></span><a class="code hl_typedef" href="../../dd/df3/env__spec__w32_8h.html#ace3f02f841a8f943fa9499f9f0e72d56">ERESOURCE</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a2a33c1cd002e9d995c25647d13ece5b9">IopDriverLoadResource</a>;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a023fc8a7d57b06273584cc58d8825bab">   22</a></span><a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">LIST_ENTRY</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a023fc8a7d57b06273584cc58d8825bab">DriverReinitListHead</a>;</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a89a6b27be872011e4186ca371e294cad">   23</a></span><a class="code hl_typedef" href="../../dd/df3/env__spec__w32_8h.html#a3b1cccdc66d3d057df043a9bed972270">KSPIN_LOCK</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a89a6b27be872011e4186ca371e294cad">DriverReinitListLock</a>;</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af04fbbfa46bf88ceb926349a5b378a18">   24</a></span><a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">PLIST_ENTRY</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af04fbbfa46bf88ceb926349a5b378a18">DriverReinitTailEntry</a>;</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a480c985e73b8981c367efb9005641f95">   26</a></span><a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">PLIST_ENTRY</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a480c985e73b8981c367efb9005641f95">DriverBootReinitTailEntry</a>;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a877184253b37df8518f2c99eb916194f">   27</a></span><a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">LIST_ENTRY</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a877184253b37df8518f2c99eb916194f">DriverBootReinitListHead</a>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4e4e9004f1cf0ca3142470fbb15c408a">   28</a></span><a class="code hl_typedef" href="../../dd/df3/env__spec__w32_8h.html#a3b1cccdc66d3d057df043a9bed972270">KSPIN_LOCK</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4e4e9004f1cf0ca3142470fbb15c408a">DriverBootReinitListLock</a>;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af5f9fd11ddb2267584071ff7ff1281d5">   30</a></span><a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af5f9fd11ddb2267584071ff7ff1281d5">IopHardwareDatabaseKey</a> =</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>   <a class="code hl_define" href="../../de/d46/tunneltest_8c.html#a450dec8394441d2f3bb56b715b899ca2">RTL_CONSTANT_STRING</a>(<a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;\\REGISTRY\\MACHINE\\HARDWARE\\DESCRIPTION\\SYSTEM&quot;</span>);</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a35bd509e60d7df316691497f034341ff">   32</a></span><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a35bd509e60d7df316691497f034341ff">ServicesKeyName</a>[] = <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;\\Registry\\Machine\\System\\CurrentControlSet\\Services\\&quot;</span>;</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a089710c43d7e59e34be0f1781ffc8806">   34</a></span><a class="code hl_struct" href="../../de/ddc/struct__OBJECT__TYPE.html">POBJECT_TYPE</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a089710c43d7e59e34be0f1781ffc8806">IoDriverObjectType</a> = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>;</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="keyword">extern</span> <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ab31507f021fd38901f993086f281ff67">ExpInTextModeSetup</a>;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="keyword">extern</span> <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a40e488e1c78783004c68c56f0eefb252">PnpSystemInit</a>;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="keyword">extern</span> <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af6db1729b6878ac9e25cb0e6b23e6326">PnPBootDriversLoaded</a>;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="keyword">extern</span> <a class="code hl_struct" href="../../df/d92/struct__KEVENT.html">KEVENT</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a235196d589c1bf0e2acdfd8c8ea1e9c9">PiEnumerationFinished</a>;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">   41</a></span><a class="code hl_typedef" href="../../dd/d43/pedump_8c.html#acbe62d57a534c724ae14fcec5318b033">USHORT</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">IopGroupIndex</a>;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">   42</a></span><a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">PLIST_ENTRY</a> <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a>;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment">/* TYPES *********************************************************************/</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="comment">// Parameters packet for Load/Unload work item&#39;s context</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html">   47</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html">_LOAD_UNLOAD_PARAMS</a></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>{</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno"><a class="line" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0873879312b77cb4345ce0f7b6c3dd24">   49</a></span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0873879312b77cb4345ce0f7b6c3dd24">Status</a>;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#ae7565826a8d199333d11158f12b51124">   50</a></span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#ae7565826a8d199333d11158f12b51124">RegistryPath</a>;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0395027b9f688a70c102e7cb01696203">   51</a></span>    <a class="code hl_struct" href="../../d3/d7f/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a> <a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0395027b9f688a70c102e7cb01696203">WorkItem</a>;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno"><a class="line" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a8b6d5f4a9a64eacc7e2b61082374b139">   52</a></span>    <a class="code hl_struct" href="../../df/d92/struct__KEVENT.html">KEVENT</a> <a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a8b6d5f4a9a64eacc7e2b61082374b139">Event</a>;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno"><a class="line" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#aec96717639a93639a7a3635397420557">   53</a></span>    <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#aec96717639a93639a7a3635397420557">DriverObject</a>;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno"><a class="line" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a2d73c8dfafd1fd005cbbe9953d41ced6">   54</a></span>    <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> <a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a2d73c8dfafd1fd005cbbe9953d41ced6">SetEvent</a>;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a07d4f3f30eddaf5464462159ffb30e2a">   55</a></span>} <a class="code hl_typedef" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a07d4f3f30eddaf5464462159ffb30e2a">LOAD_UNLOAD_PARAMS</a>, *<a class="code hl_typedef" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a2beb144d9ffa796f3c6480cb03ec83b1">PLOAD_UNLOAD_PARAMS</a>;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#acee5e07a3e07721bb0b8f6b5f9ed27ca">IopDoLoadUnloadDriver</a>(</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> *<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="comment">/* PRIVATE FUNCTIONS **********************************************************/</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a6dd290dcc1d2874e4fa5734521428a41">   66</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a6dd290dcc1d2874e4fa5734521428a41">IopInvalidDeviceRequest</a>(</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <a class="code hl_struct" href="../../d3/d53/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> <a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a>,</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <a class="code hl_struct" href="../../d2/d97/struct__IRP.html">PIRP</a> <a class="code hl_typedef" href="../../d1/dc0/csq_8h.html#a28644ba4160d7ddafde9f17e91b75b1a">Irp</a>)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>{</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <a class="code hl_typedef" href="../../d1/dc0/csq_8h.html#a28644ba4160d7ddafde9f17e91b75b1a">Irp</a>-&gt;IoStatus.Status = <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#a120a187f72577ad105c76fea7124fb72">STATUS_INVALID_DEVICE_REQUEST</a>;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <a class="code hl_typedef" href="../../d1/dc0/csq_8h.html#a28644ba4160d7ddafde9f17e91b75b1a">Irp</a>-&gt;IoStatus.Information = 0;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <a class="code hl_define" href="../../d6/dfc/ntoskrnl_2io_2iomgr_2irp_8c.html#a2c1eb93fe2e6a647e9848c37c94e61f1">IoCompleteRequest</a>(<a class="code hl_typedef" href="../../d1/dc0/csq_8h.html#a28644ba4160d7ddafde9f17e91b75b1a">Irp</a>, <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#a3823437693f46c40cf52800c2879d2d6">IO_NO_INCREMENT</a>);</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#a120a187f72577ad105c76fea7124fb72">STATUS_INVALID_DEVICE_REQUEST</a>;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>}</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno"><a class="line" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#aa4961bc581c67a08388252576ac0618d">   78</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa4961bc581c67a08388252576ac0618d">IopDeleteDriver</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> ObjectBody)</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>{</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a> = ObjectBody;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <a class="code hl_struct" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html">PIO_CLIENT_EXTENSION</a> <a class="code hl_variable" href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a>, NextDriverExtension;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <a class="code hl_define" href="../../dc/d2f/Bus__PDO__QueryResourceRequirements_8c.html#a6bd166eae176f14d4174ba4931d5b80c">PAGED_CODE</a>();</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Deleting driver object &#39;%wZ&#39;\n&quot;</span>, &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="comment">/* There must be no device objects remaining at this point */</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(!<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DeviceObject);</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    <span class="comment">/* Get the extension and loop them */</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <a class="code hl_variable" href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a> = <a class="code hl_define" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81f61f779d7dd41614cd190dc653c44b">IoGetDrvObjExtension</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>)-&gt;ClientDriverExtension;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keywordflow">while</span> (<a class="code hl_variable" href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a>)</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    {</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="comment">/* Get the next one */</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        NextDriverExtension = <a class="code hl_variable" href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a>-&gt;NextExtension;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(<a class="code hl_variable" href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#aa721980a71e3fbd417666df64ce05e04">TAG_DRIVER_EXTENSION</a>);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        <span class="comment">/* Move on */</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        <a class="code hl_variable" href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a> = NextDriverExtension;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    }</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="comment">/* Check if the driver image is still loaded */</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverSection)</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    {</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        <span class="comment">/* Unload it */</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        <a class="code hl_function" href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a8a7939b3703b2a698eb129a2d7aa6b81">MmUnloadSystemImage</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverSection);</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    }</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    <span class="comment">/* Check if it has a name */</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName.Buffer)</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    {</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        <span class="comment">/* Free it */</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName.Buffer);</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    }</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <span class="comment">/* Check if it has a service key name */</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverExtension-&gt;ServiceKeyName.Buffer)</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    {</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        <span class="comment">/* Free it */</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverExtension-&gt;ServiceKeyName.Buffer);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    }</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>}</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno"><a class="line" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#aa65653309b9be07552286681e498bc62">  124</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa65653309b9be07552286681e498bc62">IopGetDriverNames</a>(</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> ServiceHandle,</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> DriverName,</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a0cee083d022d10fcad4840d6debdedb8">_Out_opt_</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>)</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>{</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> driverName = {.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>}, <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    <a class="code hl_struct" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html">PKEY_VALUE_FULL_INFORMATION</a> kvInfo;</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <a class="code hl_define" href="../../dc/d2f/Bus__PDO__QueryResourceRequirements_8c.html#a6bd166eae176f14d4174ba4931d5b80c">PAGED_CODE</a>();</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    <span class="comment">/* 1. Check the &quot;ObjectName&quot; field in the driver&#39;s registry key (it has priority) */</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81d50dfa1cd5946c225a6db89dc11df4">IopGetRegistryValue</a>(ServiceHandle, <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;ObjectName&quot;</span>, &amp;kvInfo);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>))</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        <span class="comment">/* We&#39;ve got the ObjectName, use it as the driver name */</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        <span class="keywordflow">if</span> (kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a2d830e8dad303c46a6b9d5f159e59994">Type</a> != <a class="code hl_define" href="../../dd/dad/layer_8c.html#ae7c552d6e252741d01dbb89c2ac7e69d">REG_SZ</a> || kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a> == 0)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>            <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/d93/ntstatus_8h.html#a5eb20a2ed21575310c474c1241656b1a">STATUS_ILL_FORMED_SERVICE_ENTRY</a>;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>        }</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>        driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a> - <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a>;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>, driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        <span class="keywordflow">if</span> (!driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>)</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        }</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>        <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adb696f4512c9ed33dd7d571f296b7ebb">RtlMoveMemory</a>(driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>,</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>                      (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>)((<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ac078b01ba50a19d9467601bd01f70131">ULONG_PTR</a>)kvInfo + kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a513fbe4d9ba9d970466025722570355a">DataOffset</a>),</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                      driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a>);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>[driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>)] = <a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    }</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    <span class="comment">/* Check whether we need to get ServiceName as well, either to construct</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span><span class="comment">     * the driver name (because we could not use &quot;ObjectName&quot;), or because</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span><span class="comment">     * it is requested by the caller. */</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <a class="code hl_struct" href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html">PKEY_BASIC_INFORMATION</a> basicInfo = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>) || <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a> != <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    {</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        <span class="comment">/* Retrieve the necessary buffer size */</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>        <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> infoLength;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = ZwQueryKey(ServiceHandle, <a class="code hl_enumvalue" href="../../db/dc9/nt__native_8h.html#a253bba9c575cd482f9b16ba67fd6cac7aa95e628590fe86fd05c0da2be52c9535">KeyBasicInformation</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, 0, &amp;infoLength);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>        <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> != <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#ac978cc4096a590979ae52c9fd4f62ee0">STATUS_BUFFER_TOO_SMALL</a>)</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        {</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>            <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = (<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>) ? <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a> : <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>        }</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <span class="comment">/* Allocate the buffer and retrieve the data */</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        basicInfo = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>, infoLength, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        <span class="keywordflow">if</span> (!basicInfo)</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        {</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>            <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>        }</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = ZwQueryKey(ServiceHandle, <a class="code hl_enumvalue" href="../../db/dc9/nt__native_8h.html#a253bba9c575cd482f9b16ba67fd6cac7aa95e628590fe86fd05c0da2be52c9535">KeyBasicInformation</a>, basicInfo, infoLength, &amp;infoLength);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>))</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        {</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        }</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.Length = basicInfo-&gt;<a class="code hl_variable" href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html#afae31f01287262679ac988e567e0b774">NameLength</a>;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>        <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.MaximumLength = basicInfo-&gt;<a class="code hl_variable" href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html#afae31f01287262679ac988e567e0b774">NameLength</a>;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>        <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.Buffer = basicInfo-&gt;<a class="code hl_variable" href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html#a59beb4a726fd868b08ec17af9e7c86f5">Name</a>;</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    }</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <span class="comment">/* 2. There is no &quot;ObjectName&quot; - construct it ourselves. Depending on the driver type,</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="comment">     * it will be either &quot;\Driver&lt;ServiceName&gt;&quot; or &quot;\FileSystem&lt;ServiceName&gt;&quot; */</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="keywordflow">if</span> (driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(basicInfo); <span class="comment">// Container for serviceName</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        <span class="comment">/* Retrieve the driver type */</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>        <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> driverType;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81d50dfa1cd5946c225a6db89dc11df4">IopGetRegistryValue</a>(ServiceHandle, <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;Type&quot;</span>, &amp;kvInfo);</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>))</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        }</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <span class="keywordflow">if</span> (kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a2d830e8dad303c46a6b9d5f159e59994">Type</a> != <a class="code hl_define" href="../../d2/d33/sdbapi_8c.html#ae75057ff9465c28e9c7822c7e89e1c21">REG_DWORD</a> || kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a> != <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a>))</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        {</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = <a class="code hl_define" href="../../d3/d93/ntstatus_8h.html#a5eb20a2ed21575310c474c1241656b1a">STATUS_ILL_FORMED_SERVICE_ENTRY</a>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adb696f4512c9ed33dd7d571f296b7ebb">RtlMoveMemory</a>(&amp;driverType,</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>                      (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>)((<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ac078b01ba50a19d9467601bd01f70131">ULONG_PTR</a>)kvInfo + kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a513fbe4d9ba9d970466025722570355a">DataOffset</a>),</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>                      <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a>));</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        <span class="comment">/* Compute the necessary driver name string size */</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>        <span class="keywordflow">if</span> (driverType == <a class="code hl_define" href="../../de/d2f/xdk_2cmtypes_8h.html#a7d622c6e8def9d54f2887f46175bd0be">SERVICE_RECOGNIZER_DRIVER</a> || driverType == <a class="code hl_define" href="../../de/d2f/xdk_2cmtypes_8h.html#af0d572c918e9e1758273b92149dabc79">SERVICE_FILE_SYSTEM_DRIVER</a>)</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../df/def/ldr_8h.html#ab519b402883bc7aec80dffde6b67cbf7">FILESYSTEM_ROOT_NAME</a>);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../df/def/ldr_8h.html#a964bc036dd01080400547c81b212f938">DRIVER_ROOT_NAME</a>);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>        driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> += <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.Length;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>        driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = 0;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        <span class="comment">/* Allocate and build it */</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>, driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>        <span class="keywordflow">if</span> (!driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>        {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>        <span class="keywordflow">if</span> (driverType == <a class="code hl_define" href="../../de/d2f/xdk_2cmtypes_8h.html#a7d622c6e8def9d54f2887f46175bd0be">SERVICE_RECOGNIZER_DRIVER</a> || driverType == <a class="code hl_define" href="../../de/d2f/xdk_2cmtypes_8h.html#af0d572c918e9e1758273b92149dabc79">SERVICE_FILE_SYSTEM_DRIVER</a>)</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            <a class="code hl_function" href="../../dd/df3/env__spec__w32_8h.html#a832b89e2aa20339385183cfeb9cf9d9b">RtlAppendUnicodeToString</a>(&amp;driverName, <a class="code hl_define" href="../../df/def/ldr_8h.html#ab519b402883bc7aec80dffde6b67cbf7">FILESYSTEM_ROOT_NAME</a>);</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            <a class="code hl_function" href="../../dd/df3/env__spec__w32_8h.html#a832b89e2aa20339385183cfeb9cf9d9b">RtlAppendUnicodeToString</a>(&amp;driverName, <a class="code hl_define" href="../../df/def/ldr_8h.html#a964bc036dd01080400547c81b212f938">DRIVER_ROOT_NAME</a>);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a39e62609550e6c4ab06fb4968d08efef">RtlAppendUnicodeStringToString</a>(&amp;driverName, &amp;<a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>);</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    }</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span> </div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a> != <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(basicInfo); <span class="comment">// Container for serviceName</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        <span class="comment">/* Allocate a copy for the caller */</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#adba92689f88eda4c80df8f61dccff189">PWCHAR</a> <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#a7efe1049f91e2c78098872da38facd4b">buf</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>, <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.Length, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        <span class="keywordflow">if</span> (!<a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#a7efe1049f91e2c78098872da38facd4b">buf</a>)</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        {</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        }</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>        <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adb696f4512c9ed33dd7d571f296b7ebb">RtlMoveMemory</a>(<a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#a7efe1049f91e2c78098872da38facd4b">buf</a>, <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.Buffer, <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.Length);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>-&gt;MaximumLength = <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.Length;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>-&gt;Length = <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>.Length;</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>-&gt;Buffer = <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#a7efe1049f91e2c78098872da38facd4b">buf</a>;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    *DriverName = driverName;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a>;</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span><a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>:</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="keywordflow">if</span> (basicInfo)</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(basicInfo, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>) &amp;&amp; driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>)</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(driverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    <span class="keywordflow">return</span> <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>;</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>}</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span><span class="comment">/*</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span><span class="comment"> * RETURNS</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span><span class="comment"> *  TRUE if String2 contains String1 as a suffix.</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span><span class="comment"> */</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span><a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a8f586067dc8ee6d715e85041c811fa54">  282</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a8f586067dc8ee6d715e85041c811fa54">IopSuffixUnicodeString</a>(</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PCUNICODE_STRING</a> String1,</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PCUNICODE_STRING</a> <a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a0e6448edc6c4fd133baecebd58966664">String2</a>)</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>{</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#adba92689f88eda4c80df8f61dccff189">PWCHAR</a> <a class="code hl_variable" href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#a5e7a131b68a2b70172ead7110bc7eb37">pc1</a>;</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#adba92689f88eda4c80df8f61dccff189">PWCHAR</a> <a class="code hl_variable" href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#acd3c1acca7ec1543e6244cf7d8fcc669">pc2</a>;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> <a class="code hl_typedef" href="../../d3/d2b/ntddpcm_8h.html#a82f4bcb08cf0e8b5f5226d189208a696">Length</a>;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span> </div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a0e6448edc6c4fd133baecebd58966664">String2</a>-&gt;Length &lt; String1-&gt;Length)</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    <a class="code hl_typedef" href="../../d3/d2b/ntddpcm_8h.html#a82f4bcb08cf0e8b5f5226d189208a696">Length</a> = String1-&gt;Length / 2;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <a class="code hl_variable" href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#a5e7a131b68a2b70172ead7110bc7eb37">pc1</a> = String1-&gt;Buffer;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <a class="code hl_variable" href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#acd3c1acca7ec1543e6244cf7d8fcc669">pc2</a> = &amp;<a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a0e6448edc6c4fd133baecebd58966664">String2</a>-&gt;Buffer[<a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a0e6448edc6c4fd133baecebd58966664">String2</a>-&gt;Length / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>) - <a class="code hl_typedef" href="../../d3/d2b/ntddpcm_8h.html#a82f4bcb08cf0e8b5f5226d189208a696">Length</a>];</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span> </div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#a5e7a131b68a2b70172ead7110bc7eb37">pc1</a> &amp;&amp; <a class="code hl_variable" href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#acd3c1acca7ec1543e6244cf7d8fcc669">pc2</a>)</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    {</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        <span class="keywordflow">while</span> (<a class="code hl_typedef" href="../../d3/d2b/ntddpcm_8h.html#a82f4bcb08cf0e8b5f5226d189208a696">Length</a>--)</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>        {</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            <span class="keywordflow">if</span>( *<a class="code hl_variable" href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#a5e7a131b68a2b70172ead7110bc7eb37">pc1</a>++ != *<a class="code hl_variable" href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#acd3c1acca7ec1543e6244cf7d8fcc669">pc2</a>++ )</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        }</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a>;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    }</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>}</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span><span class="comment">/*</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span><span class="comment"> * IopDisplayLoadingMessage</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span><span class="comment"> *</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="comment"> * Display &#39;Loading XXX...&#39; message.</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span><span class="comment"> */</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span><a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a6f671bc94a3e87fcef3b36ec87d34bff">FASTCALL</a></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af6c7e94cbee2947162fdbb446b2fb7d7">  316</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af6c7e94cbee2947162fdbb446b2fb7d7">IopDisplayLoadingMessage</a>(<a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>)</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>{</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    <a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> <a class="code hl_variable" href="../../d6/d03/combotst_8c.html#a4a632a1997904dd335dc21a97d09101d">TextBuffer</a>[256];</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> DotSys = <a class="code hl_define" href="../../de/d46/tunneltest_8c.html#a450dec8394441d2f3bb56b715b899ca2">RTL_CONSTANT_STRING</a>(<a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;.SYS&quot;</span>);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ab31507f021fd38901f993086f281ff67">ExpInTextModeSetup</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d3/df7/krnlinit_8c.html#a560229594ee147b02b22e331c3f9ad03">KeLoaderBlock</a>) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    <a class="code hl_function" href="../../dd/df3/env__spec__w32_8h.html#a7cdc4345afd9ecf2fa718b4c762bbf74">RtlUpcaseUnicodeString</a>(<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>, <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <a class="code hl_define" href="../../d2/d3a/wintirpc_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code hl_variable" href="../../d6/d03/combotst_8c.html#a4a632a1997904dd335dc21a97d09101d">TextBuffer</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d6/d03/combotst_8c.html#a4a632a1997904dd335dc21a97d09101d">TextBuffer</a>),</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            <span class="stringliteral">&quot;%s%sSystem32\\Drivers\\%wZ%s\r\n&quot;</span>,</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            <a class="code hl_variable" href="../../d3/df7/krnlinit_8c.html#a560229594ee147b02b22e331c3f9ad03">KeLoaderBlock</a>-&gt;<a class="code hl_variable" href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#abd3d1861bc76b2a95e8ce5ca481b0b51">ArcBootDeviceName</a>,</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            <a class="code hl_variable" href="../../d3/df7/krnlinit_8c.html#a560229594ee147b02b22e331c3f9ad03">KeLoaderBlock</a>-&gt;<a class="code hl_variable" href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#ac83315556babec8d9a3fa1023e112209">NtBootPathName</a>,</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>,</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>            <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a8f586067dc8ee6d715e85041c811fa54">IopSuffixUnicodeString</a>(&amp;DotSys, <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>) ? <span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;.SYS&quot;</span>);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    <a class="code hl_function" href="../../d4/d40/id__ata_8cpp.html#a07b40eba20737f52617534874c638bd1">HalDisplayString</a>(<a class="code hl_variable" href="../../d6/d03/combotst_8c.html#a4a632a1997904dd335dc21a97d09101d">TextBuffer</a>);</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>}</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span> </div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span><span class="comment">/*</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span><span class="comment"> * IopNormalizeImagePath</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span><span class="comment"> *</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span><span class="comment"> * Normalize an image path to contain complete path.</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span><span class="comment"> *</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span><span class="comment"> * Parameters</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span><span class="comment"> *    ImagePath</span></div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span><span class="comment"> *       The input path and on exit the result path. ImagePath.Buffer</span></div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span><span class="comment"> *       must be allocated by ExAllocatePool on input. Caller is responsible</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span><span class="comment"> *       for freeing the buffer when it&#39;s no longer needed.</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span><span class="comment"> *</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span><span class="comment"> *    ServiceName</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="comment"> *       Name of the service that ImagePath belongs to.</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="comment"> *</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span><span class="comment"> * Return Value</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="comment"> *    Status</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment"> *</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment"> * Remarks</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="comment"> *    The input image path isn&#39;t freed on error.</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="comment"> */</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a6f671bc94a3e87fcef3b36ec87d34bff">FASTCALL</a></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aea42c837ff323fc083e3cff1f8a92cc2">  355</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aea42c837ff323fc083e3cff1f8a92cc2">IopNormalizeImagePath</a>(</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a9fb26ab9367e31c510733b0958e5b073">_When_</a>(<span class="keywordflow">return</span>&gt;=0, <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a96941fe6cafa15069eddc5dccce6b320">_At_</a>(ImagePath-&gt;Buffer, <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a1a312a888a8d2b90592cc619a0571d92">_Post_notnull_</a> <a class="code hl_define" href="../../d5/db6/driverspecs_8h.html#a7855d0a8318de9cfdfc99e7902e8e81e">__drv_allocatesMem</a>(Mem)))</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>         <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> ImagePath,</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>)</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>{</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> SystemRootString = <a class="code hl_define" href="../../de/d46/tunneltest_8c.html#a450dec8394441d2f3bb56b715b899ca2">RTL_CONSTANT_STRING</a>(<a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;\\SystemRoot\\&quot;</span>);</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> DriversPathString = <a class="code hl_define" href="../../de/d46/tunneltest_8c.html#a450dec8394441d2f3bb56b715b899ca2">RTL_CONSTANT_STRING</a>(<a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;\\SystemRoot\\System32\\drivers\\&quot;</span>);</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> DotSysString = <a class="code hl_define" href="../../de/d46/tunneltest_8c.html#a450dec8394441d2f3bb56b715b899ca2">RTL_CONSTANT_STRING</a>(<a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;.sys&quot;</span>);</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> InputImagePath;</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;Normalizing image path &#39;%wZ&#39; for service &#39;%wZ&#39;\n&quot;</span>, ImagePath, <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    InputImagePath = *ImagePath;</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    <span class="keywordflow">if</span> (InputImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> == 0)</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    {</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>        ImagePath-&gt;<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = 0;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>        ImagePath-&gt;MaximumLength = DriversPathString.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> +</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>                                   <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>-&gt;Length +</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>                                   DotSysString.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> +</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>                                   <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        ImagePath-&gt;Buffer = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>,</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>                                                  ImagePath-&gt;MaximumLength,</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>                                                  <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <span class="keywordflow">if</span> (ImagePath-&gt;Buffer == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/d93/ntstatus_8h.html#a821aeaec567da53a136174d941ca2e7d">STATUS_NO_MEMORY</a>;</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a0050303384bee38cd30898b2c12dae71">RtlCopyUnicodeString</a>(ImagePath, &amp;DriversPathString);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a39e62609550e6c4ab06fb4968d08efef">RtlAppendUnicodeStringToString</a>(ImagePath, <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a39e62609550e6c4ab06fb4968d08efef">RtlAppendUnicodeStringToString</a>(ImagePath, &amp;DotSysString);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    }</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (InputImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>[0] != <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="charliteral">&#39;\\&#39;</span>)</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    {</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>        ImagePath-&gt;Length = 0;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        ImagePath-&gt;MaximumLength = SystemRootString.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> +</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>                                   InputImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> +</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>                                   <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        ImagePath-&gt;Buffer = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>,</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>                                                  ImagePath-&gt;MaximumLength,</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>                                                  <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        <span class="keywordflow">if</span> (ImagePath-&gt;Buffer == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/d93/ntstatus_8h.html#a821aeaec567da53a136174d941ca2e7d">STATUS_NO_MEMORY</a>;</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span> </div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a0050303384bee38cd30898b2c12dae71">RtlCopyUnicodeString</a>(ImagePath, &amp;SystemRootString);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a39e62609550e6c4ab06fb4968d08efef">RtlAppendUnicodeStringToString</a>(ImagePath, &amp;InputImagePath);</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>        <span class="comment">/* Free caller&#39;s string */</span></div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(InputImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a6f0ee2ea2d6b53a2e0584162ca106677">TAG_RTLREGISTRY</a>);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    }</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;Normalized image path is &#39;%wZ&#39; for service &#39;%wZ&#39;\n&quot;</span>, ImagePath, <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a>;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>}</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno"><a class="line" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a13316c5882ddc3aac9893aed2143c694">  429</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a7ff70ce4037c9632cb68f1e3d3db77bd">IopInitializeDriverModule</a>(</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> <a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">PLDR_DATA_TABLE_ENTRY</a> ModuleObject,</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> ServiceHandle,</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> *OutDriverObject,</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> *DriverEntryStatus)</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>{</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> DriverName, <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>, <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>;</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <a class="code hl_define" href="../../dc/d2f/Bus__PDO__QueryResourceRequirements_8c.html#a6bd166eae176f14d4174ba4931d5b80c">PAGED_CODE</a>();</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa65653309b9be07552286681e498bc62">IopGetDriverNames</a>(ServiceHandle, &amp;DriverName, &amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    {</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>        <a class="code hl_function" href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a8a7939b3703b2a698eb129a2d7aa6b81">MmUnloadSystemImage</a>(ModuleObject);</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    }</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span> </div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;Driver name: &#39;%wZ&#39;\n&quot;</span>, &amp;DriverName);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span><span class="comment">     * Retrieve the driver&#39;s PE image NT header and perform some sanity checks.</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span><span class="comment">     * NOTE: We suppose that since the driver has been successfully loaded,</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span><span class="comment">     * its NT and optional headers are all valid and have expected sizes.</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span><span class="comment">     */</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <a class="code hl_struct" href="../../dc/de5/struct__IMAGE__NT__HEADERS.html">PIMAGE_NT_HEADERS</a> NtHeaders = <a class="code hl_define" href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h.html#ab7d451b8a146c9f5e65d15587a9d2c2a">RtlImageNtHeader</a>(ModuleObject-&gt;DllBase);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(NtHeaders);</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="comment">// NOTE: ModuleObject-&gt;SizeOfImage is actually (number of PTEs)*PAGE_SIZE.</span></div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(ModuleObject-&gt;SizeOfImage == <a class="code hl_define" href="../../d8/db7/xdk_2mmfuncs_8h.html#a1ba20ae43929e8210df45da3126902ad">ROUND_TO_PAGES</a>(NtHeaders-&gt;<a class="code hl_variable" href="../../dc/de5/struct__IMAGE__NT__HEADERS.html#a71de2ed0819a8fac537db2e9daedfe05">OptionalHeader</a>.<a class="code hl_variable" href="../../d8/dec/struct__IMAGE__OPTIONAL__HEADER.html#a1f2b84cc41930af41550fee60bb72381">SizeOfImage</a>));</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(ModuleObject-&gt;EntryPoint == <a class="code hl_typedef" href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h.html#a4f2397ef2cae63421c68e281d78a5089">RVA</a>(ModuleObject-&gt;DllBase, NtHeaders-&gt;<a class="code hl_variable" href="../../dc/de5/struct__IMAGE__NT__HEADERS.html#a71de2ed0819a8fac537db2e9daedfe05">OptionalHeader</a>.<a class="code hl_variable" href="../../d8/dec/struct__IMAGE__OPTIONAL__HEADER.html#a68d3ff18e90131fbe88111dfee17b1f1">AddressOfEntryPoint</a>));</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    <span class="comment">/* Obtain the registry path for the DriverInit routine */</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    <a class="code hl_struct" href="../../d4/dc5/struct__KEY__NAME__INFORMATION.html">PKEY_NAME_INFORMATION</a> nameInfo;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> infoLength;</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = ZwQueryKey(ServiceHandle, <a class="code hl_enumvalue" href="../../d6/d9e/include_2reactos_2wine_2winternl_8h.html#a253bba9c575cd482f9b16ba67fd6cac7a6acd39f49a00a4f2150cfc1b4ccce33d">KeyNameInformation</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, 0, &amp;infoLength);</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <span class="keywordflow">if</span> (<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> == <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#ac978cc4096a590979ae52c9fd4f62ee0">STATUS_BUFFER_TOO_SMALL</a>)</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    {</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        nameInfo = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>, infoLength, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        <span class="keywordflow">if</span> (nameInfo)</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>        {</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>            <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = ZwQueryKey(ServiceHandle,</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>                                <a class="code hl_enumvalue" href="../../d6/d9e/include_2reactos_2wine_2winternl_8h.html#a253bba9c575cd482f9b16ba67fd6cac7a6acd39f49a00a4f2150cfc1b4ccce33d">KeyNameInformation</a>,</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>                                nameInfo,</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>                                infoLength,</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>                                &amp;infoLength);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>            {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>                <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>.Length = nameInfo-&gt;<a class="code hl_variable" href="../../d4/dc5/struct__KEY__NAME__INFORMATION.html#a0a366430dcfefdb0512fe5b83e615e56">NameLength</a>;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>                <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>.MaximumLength = nameInfo-&gt;<a class="code hl_variable" href="../../d4/dc5/struct__KEY__NAME__INFORMATION.html#a0a366430dcfefdb0512fe5b83e615e56">NameLength</a>;</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>                <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>.Buffer = nameInfo-&gt;<a class="code hl_variable" href="../../d4/dc5/struct__KEY__NAME__INFORMATION.html#a9db5186cd2e80e3dd2026d5cd1a09def">Name</a>;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>                <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(nameInfo, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>            }</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        }</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        {</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>            <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        }</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    }</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    {</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>) ? <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a> : <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    }</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    {</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;DriverName);</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>        <a class="code hl_function" href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a8a7939b3703b2a698eb129a2d7aa6b81">MmUnloadSystemImage</a>(ModuleObject);</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    }</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <span class="comment">/* Create the driver object */</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> ObjectSize = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d1b/xdk_2iotypes_8h.html#a4c50fee2eca9a0ea94b1098ee59a9137">DRIVER_OBJECT</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d7/d80/struct__EXTENDED__DRIVER__EXTENSION.html">EXTENDED_DRIVER_EXTENSION</a>);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>    <a class="code hl_struct" href="../../d6/d32/struct__OBJECT__ATTRIBUTES.html">OBJECT_ATTRIBUTES</a> objAttrs;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> driverObject;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <a class="code hl_define" href="../../de/d63/modules_2rostests_2winetests_2ntdll_2reg_8c.html#a327a7264f49955a340d1b07a90e1c62e">InitializeObjectAttributes</a>(&amp;objAttrs,</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                               &amp;DriverName,</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>                               <a class="code hl_define" href="../../de/d7d/include_2psdk_2winternl_8h.html#ae65366b3f012988240f2ed8ad14e1356">OBJ_PERMANENT</a> | <a class="code hl_define" href="../../de/d7d/include_2psdk_2winternl_8h.html#a5fb824737b82a44c9dcf0f07316602c4">OBJ_CASE_INSENSITIVE</a> | <a class="code hl_define" href="../../de/d7d/include_2psdk_2winternl_8h.html#a29c69e248fc19f729a5ad8b57bdcf1cf">OBJ_KERNEL_HANDLE</a>,</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                               <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>                               <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span> </div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d3/d29/oblife_8c.html#a4d6fd4313677c77f824e941b80cd65ca">ObCreateObject</a>(<a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>,</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>                            <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a089710c43d7e59e34be0f1781ffc8806">IoDriverObjectType</a>,</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>                            &amp;objAttrs,</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>                            <a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>,</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>                            <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                            ObjectSize,</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>                            0,</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                            0,</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>                            (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>*)&amp;driverObject);</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>    {</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(nameInfo, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>); <span class="comment">// container for RegistryPath</span></div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;DriverName);</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>        <a class="code hl_function" href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a8a7939b3703b2a698eb129a2d7aa6b81">MmUnloadSystemImage</a>(ModuleObject);</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Error while creating driver object \&quot;%wZ\&quot; status %x\n&quot;</span>, &amp;DriverName, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>    }</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span> </div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;Created driver object 0x%p for \&quot;%wZ\&quot;\n&quot;</span>, driverObject, &amp;DriverName);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span> </div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>    <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#abd90afec09d7094004e811f9056461b3">RtlZeroMemory</a>(driverObject, ObjectSize);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a80102a79b46d8ae8c097b5070ee6654a">Type</a> = <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#ade157ec6ad626917e601334a1432402d">IO_TYPE_DRIVER</a>;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a6ce206fa4c79e6f591d07d269956e7b7">Size</a> = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d1b/xdk_2iotypes_8h.html#a4c50fee2eca9a0ea94b1098ee59a9137">DRIVER_OBJECT</a>);</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    <span class="comment">/* Set the legacy flag if this is not a WDM driver */</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    <span class="keywordflow">if</span> (!(NtHeaders-&gt;<a class="code hl_variable" href="../../dc/de5/struct__IMAGE__NT__HEADERS.html#a71de2ed0819a8fac537db2e9daedfe05">OptionalHeader</a>.<a class="code hl_variable" href="../../d8/dec/struct__IMAGE__OPTIONAL__HEADER.html#a27fb50e564e65b74a1142bd6d750aa21">DllCharacteristics</a> &amp; <a class="code hl_define" href="../../d5/d44/ntimage_8h.html#a38fb8f1d8f545c0f2880a49cd1b2caf5">IMAGE_DLLCHARACTERISTICS_WDM_DRIVER</a>))</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#aeeeeb24f7c061f50df72e6d527bd2480">Flags</a> |= <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#ae5b6ac2bff8546255ae112e3031eaf73">DRVO_LEGACY_DRIVER</a>;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a3a9528958da88c3aface7225fef57201">DriverSection</a> = ModuleObject;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a15dd1ea21612b2d23087a7791794734a">DriverStart</a> = ModuleObject-&gt;DllBase;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a794427f841f09f738f8b7d3cdc482b50">DriverSize</a> = ModuleObject-&gt;SizeOfImage;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a7a21171ec2be18dd1ec5b8c74fc0c425">DriverInit</a> = ModuleObject-&gt;EntryPoint;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a112fcbcac6369066a448fd7622670535">HardwareDatabase</a> = &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af5f9fd11ddb2267584071ff7ff1281d5">IopHardwareDatabaseKey</a>;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a7e5dc9baae90572acab2d120eb80777c">DriverExtension</a> = (<a class="code hl_struct" href="../../d0/d9f/struct__DRIVER__EXTENSION.html">PDRIVER_EXTENSION</a>)(driverObject + 1);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a7e5dc9baae90572acab2d120eb80777c">DriverExtension</a>-&gt;<a class="code hl_variable" href="../../d0/d9f/struct__DRIVER__EXTENSION.html#a65f6fe4eb8f99cb9c26c9fc38ad71d03">DriverObject</a> = driverObject;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span> </div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    <span class="comment">/* Loop all Major Functions */</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#aaac1612081decdfbec707942ad793490">INT</a> <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> = 0; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> &lt;= <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#afd014f12d0198da8a080c3b856803795">IRP_MJ_MAXIMUM_FUNCTION</a>; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>++)</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        <span class="comment">/* Invalidate each function */</span></div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a177654e7cb46dd09a0c481f1d1188203">MajorFunction</a>[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>] = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a6dd290dcc1d2874e4fa5734521428a41">IopInvalidDeviceRequest</a>;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <span class="comment">/* Add the Object and get its handle */</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> <a class="code hl_typedef" href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a>;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d4/df6/obhandle_8c.html#a5a78c6116c097c9ee18cc64b7b512483">ObInsertObject</a>(driverObject, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, <a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a2f899eca0dc42731afb043b6aacb0bd5">FILE_READ_DATA</a>, 0, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, &amp;<a class="code hl_typedef" href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a>);</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    {</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(nameInfo, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;DriverName);</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    }</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    <span class="comment">/* Now reference it */</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../db/d18/obref_8c.html#ac203db242742089bdaa6846a09383053">ObReferenceObjectByHandle</a>(<a class="code hl_typedef" href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a>,</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>                                       0,</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>                                       <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a089710c43d7e59e34be0f1781ffc8806">IoDriverObjectType</a>,</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>                                       <a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>,</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>                                       (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>*)&amp;driverObject,</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>                                       <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    <span class="comment">/* Close the extra handle */</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    <a class="code hl_function" href="../../de/df6/ndk_2obfuncs_8h.html#a5e0a128a3b03af9e6deef339000e30e0">ZwClose</a>(<a class="code hl_typedef" href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a>);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>    {</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(nameInfo, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>); <span class="comment">// container for RegistryPath</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;DriverName);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>    }</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>    <span class="comment">/* Set up the service key name buffer */</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> serviceKeyName;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>    serviceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = 0;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>    <span class="comment">// NULL-terminate for Windows compatibility</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>    serviceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>.MaximumLength + <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>    serviceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>,</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>                                                  serviceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a>,</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>                                                  <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    <span class="keywordflow">if</span> (!serviceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>)</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>        <a class="code hl_function" href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a>(driverObject);</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(driverObject);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(nameInfo, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>); <span class="comment">// container for RegistryPath</span></div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;DriverName);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    }</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span> </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    <span class="comment">/* Copy the name and set it in the driver extension */</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a0050303384bee38cd30898b2c12dae71">RtlCopyUnicodeString</a>(&amp;serviceKeyName, &amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a7e5dc9baae90572acab2d120eb80777c">DriverExtension</a>-&gt;<a class="code hl_variable" href="../../d0/d9f/struct__DRIVER__EXTENSION.html#aa3a6f76b67b89a18d60f16a980b1515f">ServiceKeyName</a> = serviceKeyName;</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <span class="comment">/* Make a copy of the driver name to store in the driver object */</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> driverNamePaged;</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    driverNamePaged.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = 0;</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>    <span class="comment">// NULL-terminate for Windows compatibility</span></div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    driverNamePaged.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = DriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> + <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    driverNamePaged.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>,</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>                                                   driverNamePaged.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a>,</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>                                                   <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    <span class="keywordflow">if</span> (!driverNamePaged.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>)</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>    {</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        <a class="code hl_function" href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a>(driverObject);</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(driverObject);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(nameInfo, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>); <span class="comment">// container for RegistryPath</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;DriverName);</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    }</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a0050303384bee38cd30898b2c12dae71">RtlCopyUnicodeString</a>(&amp;driverNamePaged, &amp;DriverName);</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#ad9f9e0f5c2b147cc664df4116a13c877">DriverName</a> = driverNamePaged;</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span> </div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    <span class="comment">/* Finally, call its init function */</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a7a21171ec2be18dd1ec5b8c74fc0c425">DriverInit</a>(driverObject, &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    *DriverEntryStatus = <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;&#39;%wZ&#39; initialization failed, status (0x%08lx)\n&quot;</span>, &amp;DriverName, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        <span class="comment">// return a special status value in case of failure</span></div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_define" href="../../d3/d93/ntstatus_8h.html#a5225ba01a4be529cef218cb8d783a35b">STATUS_FAILED_DRIVER_ENTRY</a>;</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    }</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>    <span class="comment">/* HACK: We&#39;re going to say if we don&#39;t have any DOs from DriverEntry, then we&#39;re not legacy.</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span><span class="comment">     * Other parts of the I/O manager depend on this behavior */</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>    <span class="keywordflow">if</span> (!driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#aa53b7e6c1566d9260b3d83a77b486af6">DeviceObject</a>)</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    {</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>        driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#aeeeeb24f7c061f50df72e6d527bd2480">Flags</a> &amp;= ~DRVO_LEGACY_DRIVER;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    }</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span> </div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    <span class="comment">/* Windows does this fixup, keep it for compatibility */</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#aaac1612081decdfbec707942ad793490">INT</a> <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> = 0; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> &lt;= <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#afd014f12d0198da8a080c3b856803795">IRP_MJ_MAXIMUM_FUNCTION</a>; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>++)</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    {</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span><span class="comment">         * Make sure the driver didn&#39;t set any dispatch entry point to NULL!</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span><span class="comment">         * Doing so is illegal; drivers shouldn&#39;t touch entry points they</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span><span class="comment">         * do not implement.</span></div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span><span class="comment">         */</span></div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span> </div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>        <span class="comment">/* Check if it did so anyway */</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>        <span class="keywordflow">if</span> (!driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a177654e7cb46dd09a0c481f1d1188203">MajorFunction</a>[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>])</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>        {</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>            <span class="comment">/* Print a warning in the debug log */</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>            <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Driver &lt;%wZ&gt; set DriverObject-&gt;MajorFunction[%lu] to NULL!\n&quot;</span>,</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>                    &amp;driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#ad9f9e0f5c2b147cc664df4116a13c877">DriverName</a>, <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>);</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span> </div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>            <span class="comment">/* Fix it up */</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>            driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a177654e7cb46dd09a0c481f1d1188203">MajorFunction</a>[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>] = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a6dd290dcc1d2874e4fa5734521428a41">IopInvalidDeviceRequest</a>;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>        }</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    }</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>    <span class="comment">// TODO: for legacy drivers, unload the driver if it didn&#39;t create any DO</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span> </div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(nameInfo, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>); <span class="comment">// container for RegistryPath</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;DriverName);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>    {</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        <span class="comment">// if the driver entry has been failed, clear the object</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>        <a class="code hl_function" href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a>(driverObject);</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(driverObject);</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>    }</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>    *OutDriverObject = driverObject;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span> </div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>    <a class="code hl_function" href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a564ac4ba44b4604485870689db6bb725">MmFreeDriverInitialization</a>((<a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">PLDR_DATA_TABLE_ENTRY</a>)driverObject-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a3a9528958da88c3aface7225fef57201">DriverSection</a>);</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    <span class="comment">/* Set the driver as initialized */</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>    <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#af2bbe27f75828905de206d5205684eb8">IopReadyDeviceObjects</a>(driverObject);</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span> </div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a40e488e1c78783004c68c56f0eefb252">PnpSystemInit</a>) <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ac3a7a1a03e84c61dc478fc7fa4279467">IopReinitializeDrivers</a>();</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a>;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>}</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span> </div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a50e26ae27a3979781e5e1907e1ae8509">MiResolveImageReferences</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> ImageBase,</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>                         <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> ImageFileDirectory,</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>                         <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> NamePrefix <a class="code hl_typedef" href="../../d7/d5a/storage_2ide_2uniata_2inc_2CrossNt_8h.html#a2289c48e2d17972915192c184ea46d11">OPTIONAL</a>,</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>                         <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#afce6a8c69adf1a5b94e5b1ed9618c542">PCHAR</a> *MissingApi,</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>                         <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#adba92689f88eda4c80df8f61dccff189">PWCHAR</a> *MissingDriver,</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>                         <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code hl_struct" href="../../d2/dfd/struct__LOAD__IMPORTS.html">PLOAD_IMPORTS</a> *LoadImports);</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span> </div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span><span class="comment">//</span></div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span><span class="comment">// Used for images already loaded (boot drivers)</span></div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span><span class="comment">//</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span><a class="code hl_function" href="../../d7/d23/isapnp_8c.html#a3026b3abb11e0b864e969889a78ed1d4">CODE_SEG</a>(<span class="stringliteral">&quot;INIT&quot;</span>)</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ae6f7198a8f7a7acdc84f912419bfebc6">  708</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ae6f7198a8f7a7acdc84f912419bfebc6">LdrProcessDriverModule</a>(<a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">PLDR_DATA_TABLE_ENTRY</a> LdrEntry,</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>                       <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_struct" href="../../d4/dff/struct__FileName.html">FileName</a>,</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>                       <a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">PLDR_DATA_TABLE_ENTRY</a> *ModuleObject)</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>{</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> BaseName, BaseDirectory;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    <a class="code hl_struct" href="../../d2/dfd/struct__LOAD__IMPORTS.html">PLOAD_IMPORTS</a> LoadedImports = <a class="code hl_define" href="../../d5/da2/miarm_8h.html#a97dfb9cc4a34821e2abe23084fa1a13e">MM_SYSLDR_NO_IMPORTS</a>;</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#afce6a8c69adf1a5b94e5b1ed9618c542">PCHAR</a> MissingApiName, <a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#adba92689f88eda4c80df8f61dccff189">PWCHAR</a> MissingDriverName;</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> DriverBase = LdrEntry-&gt;DllBase;</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>    <span class="comment">/* Allocate a buffer we&#39;ll use for names */</span></div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    <a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>,</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>                                   <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a4fc6529ce775df5fb3ceff4e7674db71">MAXIMUM_FILENAME_LENGTH</a>,</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>                                   <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a5fda82920711fed638f144aff052d4e3">TAG_LDR_WSTR</a>);</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>    <span class="keywordflow">if</span> (!<a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>)</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>        <span class="comment">/* Fail */</span></div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    }</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>    <span class="comment">/* Check for a separator */</span></div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d4/dff/struct__FileName.html">FileName</a>-&gt;Buffer[0] == <a class="code hl_define" href="../../d4/d42/arcname__tests_8c.html#a7820a5513c1236a41b6e2bd94d073868">OBJ_NAME_PATH_SEPARATOR</a>)</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#adba92689f88eda4c80df8f61dccff189">PWCHAR</a> <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a>;</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> BaseLength;</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span> </div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>        <span class="comment">/* Loop the path until we get to the base name */</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>        <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a> = &amp;<a class="code hl_struct" href="../../d4/dff/struct__FileName.html">FileName</a>-&gt;Buffer[<a class="code hl_struct" href="../../d4/dff/struct__FileName.html">FileName</a>-&gt;Length / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>)];</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>        <span class="keywordflow">while</span> (*(<a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a> - 1) != <a class="code hl_define" href="../../d4/d42/arcname__tests_8c.html#a7820a5513c1236a41b6e2bd94d073868">OBJ_NAME_PATH_SEPARATOR</a>) <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a>--;</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>        <span class="comment">/* Get the length */</span></div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>        BaseLength = (<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a>)(&amp;<a class="code hl_struct" href="../../d4/dff/struct__FileName.html">FileName</a>-&gt;Buffer[<a class="code hl_struct" href="../../d4/dff/struct__FileName.html">FileName</a>-&gt;Length / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>)] - <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a>);</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>        BaseLength *= <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>        <span class="comment">/* Setup the string */</span></div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>        BaseName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = (<a class="code hl_typedef" href="../../dd/d43/pedump_8c.html#acbe62d57a534c724ae14fcec5318b033">USHORT</a>)BaseLength;</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>        BaseName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a>;</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>    }</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>    {</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>        <span class="comment">/* Otherwise, we already have a base name */</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>        BaseName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = <a class="code hl_struct" href="../../d4/dff/struct__FileName.html">FileName</a>-&gt;Length;</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        BaseName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_struct" href="../../d4/dff/struct__FileName.html">FileName</a>-&gt;Buffer;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>    }</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span> </div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    <span class="comment">/* Setup the maximum length */</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    BaseName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = BaseName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a>;</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span> </div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    <span class="comment">/* Now compute the base directory */</span></div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    BaseDirectory = *<a class="code hl_typedef" href="../../d3/d3c/filecomp_8c.html#ae4a7372767a090a7f593944a057378a3">FileName</a>;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>    BaseDirectory.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> -= BaseName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a>;</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    BaseDirectory.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = BaseDirectory.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a>;</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>    <span class="comment">/* Resolve imports */</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    MissingApiName = <a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>;</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a50e26ae27a3979781e5e1907e1ae8509">MiResolveImageReferences</a>(DriverBase,</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>                                      &amp;BaseDirectory,</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>                                      <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>                                      &amp;MissingApiName,</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>                                      &amp;MissingDriverName,</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>                                      &amp;LoadedImports);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    <span class="comment">/* Free the temporary buffer */</span></div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>    <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(<a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a5fda82920711fed638f144aff052d4e3">TAG_LDR_WSTR</a>);</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span> </div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    <span class="comment">/* Check the result of the imports resolution */</span></div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>)) <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span> </div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>    <span class="comment">/* Return */</span></div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>    *ModuleObject = LdrEntry;</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a>;</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>}</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span> </div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span><a class="code hl_struct" href="../../d3/d53/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a16bb1bd87bf3b75b1c7d117258e8cc4b">IopGetDeviceObjectFromDeviceInstance</a>(<a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_variable" href="../../d5/d94/dll_2win32_2setupapi_2interface_8c.html#ad67bebb4417022298668247311d200a0">DeviceInstance</a>);</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> </div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span><span class="comment">/*</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span><span class="comment"> * IopInitializeBuiltinDriver</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span><span class="comment"> *</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span><span class="comment"> * Initialize a driver that is already loaded in memory.</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span><span class="comment"> */</span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span><a class="code hl_function" href="../../d7/d23/isapnp_8c.html#a3026b3abb11e0b864e969889a78ed1d4">CODE_SEG</a>(<span class="stringliteral">&quot;INIT&quot;</span>)</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>static</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span><a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a></div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a20d0829ad7bb53dbcb79aa85a924d511">  793</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a20d0829ad7bb53dbcb79aa85a924d511">IopInitializeBuiltinDriver</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">PLDR_DATA_TABLE_ENTRY</a> BootLdrEntry)</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>{</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>    <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>;</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#adba92689f88eda4c80df8f61dccff189">PWCHAR</a> <a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>, FileNameWithoutPath;</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#a0d5351e5911d4fb8332795b1b4f35b7d">PWSTR</a> FileExtension;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a> = &amp;BootLdrEntry-&gt;BaseDllName;</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    <a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">PLDR_DATA_TABLE_ENTRY</a> LdrEntry;</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>    <a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">PLIST_ENTRY</a> NextEntry;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>;</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> <a class="code hl_enumvalue" href="../../d9/de6/eventcreate_8c.html#a2a84ee9db787ac089de35348b3e1e3b4afdfbdf3247bd36a1f17270d5cec74c9c">Success</a>;</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span> </div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span><span class="comment">     * Display &#39;Loading XXX...&#39; message</span></div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span><span class="comment">     */</span></div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af6c7e94cbee2947162fdbb446b2fb7d7">IopDisplayLoadingMessage</a>(<a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a>);</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>    <a class="code hl_function" href="../../da/dac/inbv_8c.html#a568119eba8ef3c8bf7da01b11218176c">InbvIndicateProgress</a>();</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span> </div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>    <a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>,</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>                                   <a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a>-&gt;<a class="code hl_variable" href="../../d0/d73/structacpi__buffer.html#ae7c06f2850a47879d14be25a906d2c22">Length</a> + <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>),</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>                                   <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a> == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>    {</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>    }</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>    <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ab329f640d89ba58a8e81e19004bdb7bd">RtlCopyMemory</a>(<a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>, <a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a>-&gt;Buffer, <a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a>-&gt;<a class="code hl_variable" href="../../d0/d73/structacpi__buffer.html#ae7c06f2850a47879d14be25a906d2c22">Length</a>);</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    <a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>[<a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a>-&gt;<a class="code hl_variable" href="../../d0/d73/structacpi__buffer.html#ae7c06f2850a47879d14be25a906d2c22">Length</a> / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>)] = <a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>;</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span><span class="comment">     * Generate filename without path (not needed by freeldr)</span></div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span><span class="comment">     */</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>    FileNameWithoutPath = <a class="code hl_define" href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h.html#a4b00ec817c92b8d31e51af992a9fd5f1">wcsrchr</a>(<a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>, <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="charliteral">&#39;\\&#39;</span>);</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    <span class="keywordflow">if</span> (FileNameWithoutPath == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    {</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>        FileNameWithoutPath = <a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>;</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    }</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>    {</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>        FileNameWithoutPath++;</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>    }</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span> </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span><span class="comment">     * Strip the file extension from ServiceName</span></div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span><span class="comment">     */</span></div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>    <a class="code hl_enumvalue" href="../../d9/de6/eventcreate_8c.html#a2a84ee9db787ac089de35348b3e1e3b4afdfbdf3247bd36a1f17270d5cec74c9c">Success</a> = <a class="code hl_function" href="../../df/db6/connection_8cpp.html#ac5a73e4ec00f3dd0cfcac413fbdb0247">RtlCreateUnicodeString</a>(&amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>, FileNameWithoutPath);</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>    <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(<a class="code hl_struct" href="../../d0/d11/classBuffer.html">Buffer</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>    <span class="keywordflow">if</span> (!<a class="code hl_enumvalue" href="../../d9/de6/eventcreate_8c.html#a2a84ee9db787ac089de35348b3e1e3b4afdfbdf3247bd36a1f17270d5cec74c9c">Success</a>)</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>    {</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    }</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    FileExtension = <a class="code hl_define" href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h.html#a4b00ec817c92b8d31e51af992a9fd5f1">wcsrchr</a>(<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>.Buffer, <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>    <span class="keywordflow">if</span> (FileExtension != <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    {</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>        <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>.Length -= (<a class="code hl_typedef" href="../../dd/d43/pedump_8c.html#acbe62d57a534c724ae14fcec5318b033">USHORT</a>)<a class="code hl_function" href="../../d9/d58/include_2crt_2wchar_8h.html#a8f651a8b8fa7440574ba4de80addcad6">wcslen</a>(FileExtension) * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>);</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>        FileExtension[0] = <a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>;</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>    }</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span> </div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span> </div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    <span class="comment">// Make the registry path for the driver</span></div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>.Length = 0;</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>.MaximumLength = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a35bd509e60d7df316691497f034341ff">ServicesKeyName</a>) + <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>.Length;</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>.Buffer = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>, <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>.MaximumLength, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>    <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>.Buffer == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>    {</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>    }</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>    <a class="code hl_function" href="../../dd/df3/env__spec__w32_8h.html#a832b89e2aa20339385183cfeb9cf9d9b">RtlAppendUnicodeToString</a>(&amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>, <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a35bd509e60d7df316691497f034341ff">ServicesKeyName</a>);</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a39e62609550e6c4ab06fb4968d08efef">RtlAppendUnicodeStringToString</a>(&amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>, &amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>    <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> serviceHandle;</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a01f4b50eabb9378327c4e6893b8b4300">IopOpenRegistryKeyEx</a>(&amp;serviceHandle, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>, <a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a4ba1e0505cff2982015419c9004954d4">KEY_READ</a>);</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>);</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    {</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    }</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span> </div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>    <span class="comment">/* Lookup the new Ldr entry in PsLoadedModuleList */</span></div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>    <span class="keywordflow">for</span> (NextEntry = <a class="code hl_variable" href="../../d0/d31/ps_8h.html#a29704f42e7d2a3b9ffd710572179418b">PsLoadedModuleList</a>.<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>;</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>         NextEntry != &amp;<a class="code hl_variable" href="../../d0/d31/ps_8h.html#a29704f42e7d2a3b9ffd710572179418b">PsLoadedModuleList</a>;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>         NextEntry = NextEntry-&gt;<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>)</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>    {</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>        LdrEntry = <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(NextEntry,</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>                                     <a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">LDR_DATA_TABLE_ENTRY</a>,</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>                                     InLoadOrderLinks);</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a651271c57d5fbbba1df1936b1e0a2a66">RtlEqualUnicodeString</a>(<a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a>, &amp;LdrEntry-&gt;<a class="code hl_variable" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html#ae862e70d4b69c8de9547400c9f615cb6">BaseDllName</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a>))</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>        {</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>        }</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>    }</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(NextEntry != &amp;<a class="code hl_variable" href="../../d0/d31/ps_8h.html#a29704f42e7d2a3b9ffd710572179418b">PsLoadedModuleList</a>);</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span> </div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span><span class="comment">     * Initialize the driver</span></div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span><span class="comment">     */</span></div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> driverEntryStatus;</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a7ff70ce4037c9632cb68f1e3d3db77bd">IopInitializeDriverModule</a>(LdrEntry,</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>                                       serviceHandle,</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>                                       &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>,</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>                                       &amp;driverEntryStatus);</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span> </div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    {</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Driver &#39;%wZ&#39; load failed, status (%x)\n&quot;</span>, <a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a>, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>    }</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span> </div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>    <span class="comment">// The driver has been loaded, now check if where are any PDOs</span></div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>    <span class="comment">// for that driver, and queue AddDevice call for them.</span></div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>    <span class="comment">// The check is possible because HKLM/SYSTEM/CCS/Services/&lt;ServiceName&gt;/Enum directory</span></div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    <span class="comment">// is populated upon a new device arrival based on a (critical) device database</span></div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span> </div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    <span class="comment">// Legacy drivers may add devices inside DriverEntry.</span></div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    <span class="comment">// We&#39;re lazy and always assume that they are doing so</span></div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> deviceAdded = !!(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Flags &amp; <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#ae5b6ac2bff8546255ae112e3031eaf73">DRVO_LEGACY_DRIVER</a>);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> enumServiceHandle;</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> enumName = <a class="code hl_define" href="../../de/d46/tunneltest_8c.html#a450dec8394441d2f3bb56b715b899ca2">RTL_CONSTANT_STRING</a>(<a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;Enum&quot;</span>);</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span> </div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a01f4b50eabb9378327c4e6893b8b4300">IopOpenRegistryKeyEx</a>(&amp;enumServiceHandle, serviceHandle, &amp;enumName, <a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a4ba1e0505cff2982015419c9004954d4">KEY_READ</a>);</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>    <a class="code hl_function" href="../../de/df6/ndk_2obfuncs_8h.html#a5e0a128a3b03af9e6deef339000e30e0">ZwClose</a>(serviceHandle);</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span> </div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>    {</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>        <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> instanceCount = 0;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>        <a class="code hl_struct" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html">PKEY_VALUE_FULL_INFORMATION</a> kvInfo;</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>        <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81d50dfa1cd5946c225a6db89dc11df4">IopGetRegistryValue</a>(enumServiceHandle, <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;Count&quot;</span>, &amp;kvInfo);</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>        <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>        {</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>        }</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>        <span class="keywordflow">if</span> (kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a2d830e8dad303c46a6b9d5f159e59994">Type</a> != <a class="code hl_define" href="../../d2/d33/sdbapi_8c.html#ae75057ff9465c28e9c7822c7e89e1c21">REG_DWORD</a> || kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a> != <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a>))</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>        {</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>            <span class="keywordflow">goto</span> <a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>;</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>        }</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span> </div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>        <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adb696f4512c9ed33dd7d571f296b7ebb">RtlMoveMemory</a>(&amp;instanceCount,</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>                      (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>)((<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ac078b01ba50a19d9467601bd01f70131">ULONG_PTR</a>)kvInfo + kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a513fbe4d9ba9d970466025722570355a">DataOffset</a>),</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>                      <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a>));</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span> </div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>        <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;Processing %u instances for %wZ module\n&quot;</span>, instanceCount, <a class="code hl_variable" href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a>);</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span> </div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> = 0; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> &lt; instanceCount; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>++)</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>        {</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>            <a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a> <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#ab63d454b0ac4842ab53ff3ca9926436c">num</a>[11];</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>            <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> instancePath;</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>            <a class="code hl_function" href="../../d5/d69/ntstrsafe_8h.html#aa0d2d62f8917579f4406a58eb6351932">RtlStringCchPrintfW</a>(<a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#ab63d454b0ac4842ab53ff3ca9926436c">num</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#ab63d454b0ac4842ab53ff3ca9926436c">num</a>), <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;%u&quot;</span>, <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>);</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span> </div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>            <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81d50dfa1cd5946c225a6db89dc11df4">IopGetRegistryValue</a>(enumServiceHandle, <a class="code hl_typedef" href="../../dc/dd2/glext_8h.html#ab63d454b0ac4842ab53ff3ca9926436c">num</a>, &amp;kvInfo);</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>            <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>            {</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>            }</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>            <span class="keywordflow">if</span> (kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a2d830e8dad303c46a6b9d5f159e59994">Type</a> != <a class="code hl_define" href="../../dd/dad/layer_8c.html#ae7c552d6e252741d01dbb89c2ac7e69d">REG_SZ</a> || kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a> == 0)</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>            {</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>                <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>            }</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>            instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a> - <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>            instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a>;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>            instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>,</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>                                                        instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a>,</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>                                                        <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>            <span class="keywordflow">if</span> (instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>)</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>            {</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>                <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adb696f4512c9ed33dd7d571f296b7ebb">RtlMoveMemory</a>(instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>,</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>                              (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>)((<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ac078b01ba50a19d9467601bd01f70131">ULONG_PTR</a>)kvInfo + kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a513fbe4d9ba9d970466025722570355a">DataOffset</a>),</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>                              instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a>);</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>                instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>[instancePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>)] = <a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>;</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span> </div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>                <a class="code hl_struct" href="../../d3/d53/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> pdo = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a16bb1bd87bf3b75b1c7d117258e8cc4b">IopGetDeviceObjectFromDeviceInstance</a>(&amp;instancePath);</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>                <span class="keywordflow">if</span> (pdo != <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>                {</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>                    <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#adc16be901fc9fe68da1f7ddf30e7c2d7">PiQueueDeviceAction</a>(pdo, <a class="code hl_enumvalue" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a11ed42bf95c6c3488946cdd008d1bb5da47eeb1850d5bab45c1099d673e78a082">PiActionAddBootDevices</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>                    <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(pdo);</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>                    deviceAdded = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a>;</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>                }</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>                {</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>                    <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;No device node found matching instance path &#39;%wZ&#39;\n&quot;</span>, &amp;instancePath);</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>                }</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>            }</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> </div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>            <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>        }</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>        <a class="code hl_function" href="../../de/df6/ndk_2obfuncs_8h.html#a5e0a128a3b03af9e6deef339000e30e0">ZwClose</a>(enumServiceHandle);</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>    }</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span><a class="code hl_variable" href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a>:</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    <span class="comment">/* Remove extra reference from IopInitializeDriverModule */</span></div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span> </div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    <span class="keywordflow">return</span> deviceAdded;</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>}</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span> </div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span><span class="comment">/*</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span><span class="comment"> * IopInitializeBootDrivers</span></div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span><span class="comment"> *</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span><span class="comment"> * Initialize boot drivers and free memory for boot files.</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span><span class="comment"> *</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span><span class="comment"> * Parameters</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span><span class="comment"> *    None</span></div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span><span class="comment"> *</span></div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span><span class="comment"> * Return Value</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span><span class="comment"> *    None</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span><span class="comment"> */</span></div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span><a class="code hl_function" href="../../d7/d23/isapnp_8c.html#a3026b3abb11e0b864e969889a78ed1d4">CODE_SEG</a>(<span class="stringliteral">&quot;INIT&quot;</span>)</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span><a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a6f671bc94a3e87fcef3b36ec87d34bff">FASTCALL</a></div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"><a class="line" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#aa6ddc4736018d8d024c1f277a8fbb504"> 1009</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa6ddc4736018d8d024c1f277a8fbb504">IopInitializeBootDrivers</a>(<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a>)</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>{</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    <a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">PLIST_ENTRY</a> ListHead, NextEntry, NextEntry2;</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>    <a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">PLDR_DATA_TABLE_ENTRY</a> LdrEntry;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> DriverName;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>, <a class="code hl_typedef" href="../../d1/d7b/wdfcollection_8h.html#ade891b5bceeb9043185424b74b336930">Index</a>;</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>    <a class="code hl_struct" href="../../d0/dd0/struct__DRIVER__INFORMATION.html">PDRIVER_INFORMATION</a> <a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>, DriverInfoTag;</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>    <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> <a class="code hl_variable" href="../../d9/d16/ndis_8h.html#ae58477bab924c4413afd3a1405993ee5">KeyHandle</a>;</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>    <a class="code hl_struct" href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html">PBOOT_DRIVER_LIST_ENTRY</a> BootEntry;</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;IopInitializeBootDrivers()\n&quot;</span>);</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span> </div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>    <span class="comment">/* Create the RAW FS built-in driver */</span></div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a5e6d7af51cb6d106401f3967b6b44b12">RtlInitUnicodeString</a>(&amp;DriverName, <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;\\FileSystem\\RAW&quot;</span>);</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span> </div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a3b38bafeb96d588a0c1993af7c0e933b">IoCreateDriver</a>(&amp;DriverName, <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a0dd8d2221f01bb5553522914091e7522">RawFsDriverEntry</a>);</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>    {</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>        <span class="comment">/* Fail */</span></div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>    }</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span> </div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    <span class="comment">/* Get highest group order index */</span></div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>    <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">IopGroupIndex</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a2df29150566a07af377b4e725e55af02">PpInitGetGroupOrderIndex</a>(<a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">IopGroupIndex</a> == 0xFFFF)</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>    {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>        <a class="code hl_define" href="../../dc/d22/drivers_2network_2dd_2e1000_2debug_8h.html#a24bae9bc8db795c75682c03f038cf092">UNIMPLEMENTED_DBGBREAK</a>();</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>    }</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span> </div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    <span class="comment">/* Allocate the group table */</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>    <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>,</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>                                          <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">IopGroupIndex</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">LIST_ENTRY</a>),</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>                                          <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a> == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>    {</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>        <a class="code hl_define" href="../../dc/d22/drivers_2network_2dd_2e1000_2debug_8h.html#a24bae9bc8db795c75682c03f038cf092">UNIMPLEMENTED_DBGBREAK</a>();</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>    }</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span> </div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    <span class="comment">/* Initialize the group table lists */</span></div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>    <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> = 0; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> &lt; <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">IopGroupIndex</a>; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>++) <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acec93a755836f578590339c921773e21">InitializeListHead</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a>[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>]);</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span> </div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>    <span class="comment">/* Loop the boot modules */</span></div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>    ListHead = &amp;<a class="code hl_variable" href="../../d3/df7/krnlinit_8c.html#a560229594ee147b02b22e331c3f9ad03">KeLoaderBlock</a>-&gt;<a class="code hl_variable" href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#a623b26c4210067111bd27f552243adba">LoadOrderListHead</a>;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>    <span class="keywordflow">for</span> (NextEntry = ListHead-&gt;<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>;</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>         NextEntry != ListHead;</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>         NextEntry = NextEntry-&gt;<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>)</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>    {</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>        <span class="comment">/* Get the entry */</span></div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>        LdrEntry = <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(NextEntry,</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>                                     <a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">LDR_DATA_TABLE_ENTRY</a>,</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>                                     InLoadOrderLinks);</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span> </div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>        <span class="comment">/* Check if the DLL needs to be initialized */</span></div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>        <span class="keywordflow">if</span> (LdrEntry-&gt;<a class="code hl_variable" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html#a5e68353a301bbe93b0ae307c8865a2f6">Flags</a> &amp; <a class="code hl_define" href="../../d1/d97/ldrtypes_8h.html#a2d6daf18dd920c9fafef774705002749">LDRP_DRIVER_DEPENDENT_DLL</a>)</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>        {</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>            <span class="comment">/* Call its entrypoint */</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>            <a class="code hl_function" href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a7fba743375036dac487f7ea2086903f3">MmCallDllInitialize</a>(LdrEntry, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>        }</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>    }</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span> </div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>    <span class="comment">/* Loop the boot drivers */</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>    ListHead = &amp;<a class="code hl_variable" href="../../d3/df7/krnlinit_8c.html#a560229594ee147b02b22e331c3f9ad03">KeLoaderBlock</a>-&gt;<a class="code hl_variable" href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#a07be85fd15367882127cbde3d560b6f6">BootDriverListHead</a>;</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>    <span class="keywordflow">for</span> (NextEntry = ListHead-&gt;<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>;</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>         NextEntry != ListHead;</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>         NextEntry = NextEntry-&gt;<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>)</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    {</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>        <span class="comment">/* Get the entry */</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>        BootEntry = <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(NextEntry,</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>                                      <a class="code hl_struct" href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html">BOOT_DRIVER_LIST_ENTRY</a>,</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>                                      <a class="code hl_function" href="../../da/d5a/vfdcmd_8c.html#a5453a8bc4f99562e51daa49d57a65f3e">Link</a>);</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span> </div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>        <span class="comment">// FIXME: TODO: This LdrEntry is to be used in a special handling</span></div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>        <span class="comment">// for SETUPLDR (a similar procedure is done on Windows), where</span></div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>        <span class="comment">// the loader would, under certain conditions, be loaded in the</span></div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>        <span class="comment">// SETUPLDR-specific code block below...</span></div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span><span class="preprocessor">#if 0</span></div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>        <span class="comment">/* Get the driver loader entry */</span></div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>        LdrEntry = BootEntry-&gt;<a class="code hl_variable" href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html#ac990accd79f4676331b1aa34538d5ba2">LdrEntry</a>;</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span> </div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>        <span class="comment">/* Allocate our internal accounting structure */</span></div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>        <a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>,</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>                                           <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d0/dd0/struct__DRIVER__INFORMATION.html">DRIVER_INFORMATION</a>),</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>                                           <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>)</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>        {</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>            <span class="comment">/* Zero it and initialize it */</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>            <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#abd90afec09d7094004e811f9056461b3">RtlZeroMemory</a>(<a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d0/dd0/struct__DRIVER__INFORMATION.html">DRIVER_INFORMATION</a>));</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>            <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acec93a755836f578590339c921773e21">InitializeListHead</a>(&amp;<a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>-&gt;<a class="code hl_variable" href="../../d0/dd0/struct__DRIVER__INFORMATION.html#a8ea0daa8424484defd29e52fb1dadd39">Link</a>);</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>            <a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>-&gt;<a class="code hl_variable" href="../../d0/dd0/struct__DRIVER__INFORMATION.html#a52cdbb2321c92acc8c088feba060a956">DataTableEntry</a> = BootEntry;</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span> </div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>            <span class="comment">/* Open the registry key */</span></div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>            <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a01f4b50eabb9378327c4e6893b8b4300">IopOpenRegistryKeyEx</a>(&amp;<a class="code hl_variable" href="../../d9/d16/ndis_8h.html#ae58477bab924c4413afd3a1405993ee5">KeyHandle</a>,</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>                                          <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>                                          &amp;BootEntry-&gt;<a class="code hl_variable" href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html#a8890ceae0b70258491fcbebf83e0fbba">RegistryPath</a>,</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>                                          <a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a4ba1e0505cff2982015419c9004954d4">KEY_READ</a>);</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>            <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;IopOpenRegistryKeyEx(%wZ) returned 0x%08lx\n&quot;</span>, &amp;BootEntry-&gt;<a class="code hl_variable" href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html#a8890ceae0b70258491fcbebf83e0fbba">RegistryPath</a>, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span><span class="preprocessor">#if 0</span></div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span><span class="preprocessor">#else </span><span class="comment">// Hack still needed...</span></div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>            <span class="keywordflow">if</span> ((<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>)) || <span class="comment">/* ReactOS HACK for SETUPLDR */</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>                ((<a class="code hl_variable" href="../../d3/df7/krnlinit_8c.html#a560229594ee147b02b22e331c3f9ad03">KeLoaderBlock</a>-&gt;<a class="code hl_variable" href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#afcde932ba7c29c5e6650e780561d9bcf">SetupLdrBlock</a>) &amp;&amp; ((<a class="code hl_variable" href="../../d9/d16/ndis_8h.html#ae58477bab924c4413afd3a1405993ee5">KeyHandle</a> = (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>)1)))) <span class="comment">// yes, it&#39;s an assignment!</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>            {</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>                <span class="comment">/* Save the handle */</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>                <a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>-&gt;<a class="code hl_variable" href="../../d0/dd0/struct__DRIVER__INFORMATION.html#a355018a71ce64e9a0e25877663be3c21">ServiceHandle</a> = <a class="code hl_variable" href="../../d9/d16/ndis_8h.html#ae58477bab924c4413afd3a1405993ee5">KeyHandle</a>;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span> </div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>                <span class="comment">/* Get the group oder index */</span></div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>                <a class="code hl_typedef" href="../../d1/d7b/wdfcollection_8h.html#ade891b5bceeb9043185424b74b336930">Index</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a2df29150566a07af377b4e725e55af02">PpInitGetGroupOrderIndex</a>(<a class="code hl_variable" href="../../d9/d16/ndis_8h.html#ae58477bab924c4413afd3a1405993ee5">KeyHandle</a>);</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span> </div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>                <span class="comment">/* Get the tag position */</span></div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>                <a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>-&gt;<a class="code hl_variable" href="../../d0/dd0/struct__DRIVER__INFORMATION.html#ac62e548f292261c31ea52f5295d61c87">TagPosition</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a6a0a117e522e4be01bfc2ce04688b463">PipGetDriverTagPriority</a>(<a class="code hl_variable" href="../../d9/d16/ndis_8h.html#ae58477bab924c4413afd3a1405993ee5">KeyHandle</a>);</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span> </div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>                <span class="comment">/* Insert it into the list, at the right place */</span></div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>                <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(<a class="code hl_typedef" href="../../d1/d7b/wdfcollection_8h.html#ade891b5bceeb9043185424b74b336930">Index</a> &lt; <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">IopGroupIndex</a>);</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>                NextEntry2 = <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a>[<a class="code hl_typedef" href="../../d1/d7b/wdfcollection_8h.html#ade891b5bceeb9043185424b74b336930">Index</a>].<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>;</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>                <span class="keywordflow">while</span> (NextEntry2 != &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a>[<a class="code hl_typedef" href="../../d1/d7b/wdfcollection_8h.html#ade891b5bceeb9043185424b74b336930">Index</a>])</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>                {</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>                    <span class="comment">/* Get the driver info */</span></div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>                    DriverInfoTag = <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(NextEntry2,</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>                                                      <a class="code hl_struct" href="../../d0/dd0/struct__DRIVER__INFORMATION.html">DRIVER_INFORMATION</a>,</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>                                                      <a class="code hl_function" href="../../da/d5a/vfdcmd_8c.html#a5453a8bc4f99562e51daa49d57a65f3e">Link</a>);</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span> </div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>                    <span class="comment">/* Check if we found the right tag position */</span></div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>                    <span class="keywordflow">if</span> (DriverInfoTag-&gt;<a class="code hl_variable" href="../../d0/dd0/struct__DRIVER__INFORMATION.html#ac62e548f292261c31ea52f5295d61c87">TagPosition</a> &gt; <a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>-&gt;<a class="code hl_variable" href="../../d0/dd0/struct__DRIVER__INFORMATION.html#ac62e548f292261c31ea52f5295d61c87">TagPosition</a>)</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>                    {</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>                        <span class="comment">/* We&#39;re done */</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>                    }</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span> </div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>                    <span class="comment">/* Next entry */</span></div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>                    NextEntry2 = NextEntry2-&gt;<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>;</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>                }</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span> </div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>                <span class="comment">/* Insert us right before the next entry */</span></div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>                NextEntry2 = NextEntry2-&gt;<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a3a60644cad17d7dd53f6b7b378b191f3">Blink</a>;</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>                <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a14f3c1fe642e4927959b4beed2852e2a">InsertHeadList</a>(NextEntry2, &amp;<a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>-&gt;<a class="code hl_variable" href="../../d0/dd0/struct__DRIVER__INFORMATION.html#a8ea0daa8424484defd29e52fb1dadd39">Link</a>);</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>            }</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>        }</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>    }</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span> </div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    <span class="comment">/* Loop each group index */</span></div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> = 0; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> &lt; <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">IopGroupIndex</a>; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>++)</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>    {</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>        <span class="comment">/* Loop each group table */</span></div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>        <span class="keywordflow">for</span> (NextEntry = <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a>[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>].Flink;</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>             NextEntry != &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a>[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>];</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>             NextEntry = NextEntry-&gt;<a class="code hl_variable" href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">Flink</a>)</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>        {</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>            <span class="comment">/* Get the entry */</span></div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>            <a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a> = <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(NextEntry,</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>                                           <a class="code hl_struct" href="../../d0/dd0/struct__DRIVER__INFORMATION.html">DRIVER_INFORMATION</a>,</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>                                           <a class="code hl_function" href="../../da/d5a/vfdcmd_8c.html#a5453a8bc4f99562e51daa49d57a65f3e">Link</a>);</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span> </div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>            <span class="comment">/* Get the driver loader entry */</span></div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>            LdrEntry = <a class="code hl_variable" href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a>-&gt;<a class="code hl_variable" href="../../d0/dd0/struct__DRIVER__INFORMATION.html#a52cdbb2321c92acc8c088feba060a956">DataTableEntry</a>-&gt;<a class="code hl_variable" href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html#ac990accd79f4676331b1aa34538d5ba2">LdrEntry</a>;</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span> </div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>            <span class="comment">/* Initialize it */</span></div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a20d0829ad7bb53dbcb79aa85a924d511">IopInitializeBuiltinDriver</a>(LdrEntry))</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>            {</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>                <span class="comment">// it does not make sense to enumerate the tree if there are no new devices added</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>                <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#adc16be901fc9fe68da1f7ddf30e7c2d7">PiQueueDeviceAction</a>(<a class="code hl_variable" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#ae37eeb0422b9790743c16ac4d1f11aef">IopRootDeviceNode</a>-&gt;<a class="code hl_variable" href="../../d1/d86/struct__DEVICE__NODE.html#a500b45022d89f965df144b9851b2f789">PhysicalDeviceObject</a>,</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>                                    <a class="code hl_enumvalue" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a11ed42bf95c6c3488946cdd008d1bb5da85400f67cedf1285b9b68d9190fbb231">PiActionEnumRootDevices</a>,</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>                                    <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>                                    <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>            }</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>        }</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    }</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span> </div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>    <span class="comment">/* HAL Root Bus is being initialized before loading the boot drivers so this may cause issues</span></div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span><span class="comment">     * when some devices are not being initialized with their drivers. This flag is used to delay</span></div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span><span class="comment">     * all actions with devices (except PnP root device) until boot drivers are loaded.</span></div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span><span class="comment">     * See PiQueueDeviceAction function</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span><span class="comment">     */</span></div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>    <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af6db1729b6878ac9e25cb0e6b23e6326">PnPBootDriversLoaded</a> = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a>;</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span> </div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>    <a class="code hl_define" href="../../d6/dda/hal_2halarm_2include_2hal_8h.html#a9d1c3f4a4128b2f289d2b7e83a5da33b">DbgPrint</a>(<span class="stringliteral">&quot;BOOT DRIVERS LOADED\n&quot;</span>);</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span> </div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>    <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#adc16be901fc9fe68da1f7ddf30e7c2d7">PiQueueDeviceAction</a>(<a class="code hl_variable" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#ae37eeb0422b9790743c16ac4d1f11aef">IopRootDeviceNode</a>-&gt;<a class="code hl_variable" href="../../d1/d86/struct__DEVICE__NODE.html#a500b45022d89f965df144b9851b2f789">PhysicalDeviceObject</a>,</div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>                        <a class="code hl_enumvalue" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a11ed42bf95c6c3488946cdd008d1bb5dac3099ebd61d3f888786371a76c3effbf">PiActionEnumDeviceTree</a>,</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>                        <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>                        <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>}</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span> </div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span><a class="code hl_function" href="../../d7/d23/isapnp_8c.html#a3026b3abb11e0b864e969889a78ed1d4">CODE_SEG</a>(<span class="stringliteral">&quot;INIT&quot;</span>)</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span><a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a6f671bc94a3e87fcef3b36ec87d34bff">FASTCALL</a></div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"><a class="line" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a4393bd21f047135c71d08a82be27837d"> 1196</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4393bd21f047135c71d08a82be27837d">IopInitializeSystemDrivers</a>(<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a>)</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>{</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> *DriverList, *SavedList;</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span> </div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>    <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#aef12f707ee359865fc99d25c7b3b3f97">PiPerformSyncDeviceAction</a>(<a class="code hl_variable" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#ae37eeb0422b9790743c16ac4d1f11aef">IopRootDeviceNode</a>-&gt;<a class="code hl_variable" href="../../d1/d86/struct__DEVICE__NODE.html#a500b45022d89f965df144b9851b2f789">PhysicalDeviceObject</a>, <a class="code hl_enumvalue" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a11ed42bf95c6c3488946cdd008d1bb5dac3099ebd61d3f888786371a76c3effbf">PiActionEnumDeviceTree</a>);</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span> </div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>    <span class="comment">/* No system drivers on the boot cd */</span></div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d3/df7/krnlinit_8c.html#a560229594ee147b02b22e331c3f9ad03">KeLoaderBlock</a>-&gt;<a class="code hl_variable" href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#afcde932ba7c29c5e6650e780561d9bcf">SetupLdrBlock</a>) <span class="keywordflow">return</span>; <span class="comment">// ExpInTextModeSetup</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span> </div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>    <span class="comment">/* Get the driver list */</span></div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>    SavedList = DriverList = <a class="code hl_function" href="../../df/d04/cmsysini_8c.html#ae5165e6c3f5650676e67ba301c1a90d8">CmGetSystemDriverList</a>();</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>    <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(DriverList);</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span> </div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    <span class="comment">/* Loop it */</span></div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>    <span class="keywordflow">while</span> (*DriverList)</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    {</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>        <span class="comment">/* Load the driver */</span></div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>        ZwLoadDriver(*DriverList);</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span> </div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>        <span class="comment">/* Free the entry */</span></div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>        <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(*DriverList);</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(*DriverList);</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span> </div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>        <span class="comment">/* Next entry */</span></div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>        <a class="code hl_function" href="../../da/dac/inbv_8c.html#a568119eba8ef3c8bf7da01b11218176c">InbvIndicateProgress</a>();</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>        DriverList++;</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>    }</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span> </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    <span class="comment">/* Free the list */</span></div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(SavedList);</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#adc16be901fc9fe68da1f7ddf30e7c2d7">PiQueueDeviceAction</a>(<a class="code hl_variable" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#ae37eeb0422b9790743c16ac4d1f11aef">IopRootDeviceNode</a>-&gt;<a class="code hl_variable" href="../../d1/d86/struct__DEVICE__NODE.html#a500b45022d89f965df144b9851b2f789">PhysicalDeviceObject</a>,</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>                        <a class="code hl_enumvalue" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a11ed42bf95c6c3488946cdd008d1bb5dac3099ebd61d3f888786371a76c3effbf">PiActionEnumDeviceTree</a>,</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>                        <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>                        <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>}</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span> </div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span><span class="comment">/*</span></div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span><span class="comment"> * IopUnloadDriver</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span><span class="comment"> *</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span><span class="comment"> * Unloads a device driver.</span></div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span><span class="comment"> *</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span><span class="comment"> * Parameters</span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span><span class="comment"> *    DriverServiceName</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span><span class="comment"> *       Name of the service to unload (registry key).</span></div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span><span class="comment"> *</span></div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span><span class="comment"> *    UnloadPnpDrivers</span></div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span><span class="comment"> *       Whether to unload Plug &amp; Plug or only legacy drivers. If this</span></div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span><span class="comment"> *       parameter is set to FALSE, the routine will unload only legacy</span></div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span><span class="comment"> *       drivers.</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span><span class="comment"> *</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span><span class="comment"> * Return Value</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span><span class="comment"> *    Status</span></div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span><span class="comment"> *</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span><span class="comment"> * To do</span></div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span><span class="comment"> *    Guard the whole function by SEH.</span></div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span><span class="comment"> */</span></div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span> </div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4f9928a6c28075abfa3d31f2d3e65a59"> 1255</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4f9928a6c28075abfa3d31f2d3e65a59">IopUnloadDriver</a>(<a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> DriverServiceName, <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> UnloadPnpDrivers)</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>{</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> Backslash = <a class="code hl_define" href="../../de/d46/tunneltest_8c.html#a450dec8394441d2f3bb56b715b899ca2">RTL_CONSTANT_STRING</a>(<a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;\\&quot;</span>);</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>    <a class="code hl_struct" href="../../d1/d10/struct__RTL__QUERY__REGISTRY__TABLE.html">RTL_QUERY_REGISTRY_TABLE</a> <a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a408fd7b7ff70f01bc61a6e9a47bb7f51">QueryTable</a>[2];</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> ImagePath;</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>;</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> <a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>;</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>    <a class="code hl_struct" href="../../d3/d53/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> <a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a>;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>    <a class="code hl_struct" href="../../d0/dc5/struct__EXTENDED__DEVOBJ__EXTENSION.html">PEXTENDED_DEVOBJ_EXTENSION</a> DeviceExtension;</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>    <a class="code hl_typedef" href="../../dd/d43/pedump_8c.html#acbe62d57a534c724ae14fcec5318b033">USHORT</a> LastBackslash;</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>    <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> SafeToUnload = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a>;</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>    <a class="code hl_typedef" href="../../d7/deb/xdk_2ketypes_8h.html#a425eea3f57239dc3a8b77669eba3ca97">KPROCESSOR_MODE</a> <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>;</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> CapturedServiceName;</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span> </div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>    <a class="code hl_define" href="../../dc/d2f/Bus__PDO__QueryResourceRequirements_8c.html#a6bd166eae176f14d4174ba4931d5b80c">PAGED_CODE</a>();</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span> </div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>    <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a> = <a class="code hl_define" href="../../d0/d72/ex_8h.html#a3ff9102189bcbf0a250156b3c66a9f61">ExGetPreviousMode</a>();</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span> </div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>    <span class="comment">/* Need the appropriate priviliege */</span></div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../da/d6e/ntoskrnl_2se_2priv_8c.html#ab4a255ad2a1c77fa035c8f42ef4fcc5d">SeSinglePrivilegeCheck</a>(<a class="code hl_variable" href="../../d4/d92/ntoskrnl_2include_2internal_2se_8h.html#a88234f816d0abbbf629186b4041fbd2f">SeLoadDriverPrivilege</a>, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>))</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>    {</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;No unload privilege!\n&quot;</span>);</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../de/d19/DriverTester_8h.html#a62f33d4e46ad5b4ca3e889ded4c0f7a1">STATUS_PRIVILEGE_NOT_HELD</a>;</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>    }</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span> </div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>    <span class="comment">/* Capture the service name */</span></div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a354b39ea4abc3b4d09b2744b11ed9ac4">ProbeAndCaptureUnicodeString</a>(&amp;CapturedServiceName,</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>                                          <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>,</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>                                          DriverServiceName);</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>    {</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>    }</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span> </div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;IopUnloadDriver(&#39;%wZ&#39;, %u)\n&quot;</span>, &amp;CapturedServiceName, UnloadPnpDrivers);</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span> </div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>    <span class="comment">/* We need a service name */</span></div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    <span class="keywordflow">if</span> (CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> == 0 || CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    {</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>        <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a>(&amp;CapturedServiceName, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>);</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#a52c9a508482278e5a91348ba542df15f">STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>    }</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span> </div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span><span class="comment">     * Get the service name from the registry key name</span></div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span><span class="comment">     */</span></div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../df/d26/ntoskrnl_2include_2internal_2rtl_8h.html#a78b7b2b4d693be0ce2aa0b208aca4dc4">RtlFindCharInUnicodeString</a>(<a class="code hl_define" href="../../df/d26/ntoskrnl_2include_2internal_2rtl_8h.html#a1821685c69fd3c9881bd4258a135ec59">RTL_FIND_CHAR_IN_UNICODE_STRING_START_AT_END</a>,</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>                                        &amp;CapturedServiceName,</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>                                        &amp;Backslash,</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>                                        &amp;LastBackslash);</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>    {</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>        <a class="code hl_define" href="../../de/df5/xdk_2rtlfuncs_8h.html#a19cb1e15111d509d36c6a5d59f8ff9af">NT_ASSERT</a>(CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> &gt;= LastBackslash + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>));</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>        <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>.Buffer = &amp;CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>[LastBackslash / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>) + 1];</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>        <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>.Length = CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> - LastBackslash - <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>);</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>        <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>.MaximumLength = CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> - LastBackslash - <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>);</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>    }</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>    {</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>        <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a> = CapturedServiceName;</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>    }</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span> </div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span><span class="comment">     * Construct the driver object name</span></div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span><span class="comment">     */</span></div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = RtlUShortAdd(<span class="keyword">sizeof</span>(<a class="code hl_define" href="../../df/def/ldr_8h.html#a964bc036dd01080400547c81b212f938">DRIVER_ROOT_NAME</a>),</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>                          <a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>.Length,</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>                          &amp;<a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>.MaximumLength);</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    {</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>        <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a>(&amp;CapturedServiceName, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>);</div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>    }</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>    <a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>.Length = 0;</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>    <a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>.Buffer = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>,</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>                                              <a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>.MaximumLength,</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>                                              <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>.Buffer)</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>    {</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>        <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a>(&amp;CapturedServiceName, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>);</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>    }</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>    <a class="code hl_define" href="../../de/df5/xdk_2rtlfuncs_8h.html#a24df31d3375dfa4f65e93007d984d3a1">NT_VERIFY</a>(<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_function" href="../../dd/df3/env__spec__w32_8h.html#a832b89e2aa20339385183cfeb9cf9d9b">RtlAppendUnicodeToString</a>(&amp;<a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>, <a class="code hl_define" href="../../df/def/ldr_8h.html#a964bc036dd01080400547c81b212f938">DRIVER_ROOT_NAME</a>)));</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>    <a class="code hl_define" href="../../de/df5/xdk_2rtlfuncs_8h.html#a24df31d3375dfa4f65e93007d984d3a1">NT_VERIFY</a>(<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a39e62609550e6c4ab06fb4968d08efef">RtlAppendUnicodeStringToString</a>(&amp;<a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>, &amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>)));</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span> </div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span><span class="comment">     * Find the driver object</span></div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span><span class="comment">     */</span></div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../db/d18/obref_8c.html#a727c1f0726c97a4d0f526d541cee1f6a">ObReferenceObjectByName</a>(&amp;<a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>,</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>                                     0,</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>                                     0,</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>                                     0,</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>                                     <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a089710c43d7e59e34be0f1781ffc8806">IoDriverObjectType</a>,</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>                                     <a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>,</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>                                     0,</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>                                     (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>*)&amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span> </div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>    {</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Can&#39;t locate driver object for %wZ\n&quot;</span>, &amp;<a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>);</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(<a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>.Buffer, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>        <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a>(&amp;CapturedServiceName, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>);</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>    }</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span> </div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>    <span class="comment">/* Free the buffer for driver object name */</span></div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>    <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(<a class="code hl_variable" href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a>.Buffer, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span> </div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>    <span class="comment">/* Check that driver is not already unloading */</span></div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>    <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Flags &amp; <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#abfb03142686df4cd9bf3f3f4bce08141">DRVO_UNLOAD_INVOKED</a>)</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>    {</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Driver deletion pending\n&quot;</span>);</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>        <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a>(&amp;CapturedServiceName, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>);</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/d93/ntstatus_8h.html#a25c21b1ffe961a8e2e58e24695250927">STATUS_DELETE_PENDING</a>;</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>    }</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span> </div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span><span class="comment">     * Get path of service...</span></div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span><span class="comment">     */</span></div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>    <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#abd90afec09d7094004e811f9056461b3">RtlZeroMemory</a>(<a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a408fd7b7ff70f01bc61a6e9a47bb7f51">QueryTable</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a408fd7b7ff70f01bc61a6e9a47bb7f51">QueryTable</a>));</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span> </div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a5e6d7af51cb6d106401f3967b6b44b12">RtlInitUnicodeString</a>(&amp;ImagePath, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span> </div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>    <a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a408fd7b7ff70f01bc61a6e9a47bb7f51">QueryTable</a>[0].<a class="code hl_variable" href="../../d1/d10/struct__RTL__QUERY__REGISTRY__TABLE.html#a02bb1408f29dbed00cb59d2a5730b696">Name</a> = <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;ImagePath&quot;</span>;</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>    <a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a408fd7b7ff70f01bc61a6e9a47bb7f51">QueryTable</a>[0].<a class="code hl_variable" href="../../d1/d10/struct__RTL__QUERY__REGISTRY__TABLE.html#a7300ff2835155bd276fa8b24d246539c">Flags</a> = <a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a988a60bc626d7b297d869d8c9b03ab41">RTL_QUERY_REGISTRY_DIRECT</a>;</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>    <a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a408fd7b7ff70f01bc61a6e9a47bb7f51">QueryTable</a>[0].<a class="code hl_variable" href="../../d1/d10/struct__RTL__QUERY__REGISTRY__TABLE.html#a8814fdfb9d1b14abbc619167b0bad4a5">EntryContext</a> = &amp;ImagePath;</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span> </div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d6/d9e/include_2reactos_2wine_2winternl_8h.html#a904c1e40a6ca2ce657f7c9286f435db4">RtlQueryRegistryValues</a>(<a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a6604a8babb329baba07e91693c3335f1">RTL_REGISTRY_ABSOLUTE</a>,</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>                                    CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>,</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>                                    <a class="code hl_variable" href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a408fd7b7ff70f01bc61a6e9a47bb7f51">QueryTable</a>,</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>                                    <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>                                    <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span> </div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>    <span class="comment">/* We no longer need service name */</span></div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>    <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a>(&amp;CapturedServiceName, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>);</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span> </div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>    {</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;RtlQueryRegistryValues() failed (Status %x)\n&quot;</span>, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>    }</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span> </div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span><span class="comment">     * Normalize the image path for all later processing.</span></div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span><span class="comment">     */</span></div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aea42c837ff323fc083e3cff1f8a92cc2">IopNormalizeImagePath</a>(&amp;ImagePath, &amp;<a class="code hl_variable" href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a>);</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span> </div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>    {</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;IopNormalizeImagePath() failed (Status %x)\n&quot;</span>, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>    }</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span> </div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>    <span class="comment">/* Free the service path */</span></div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>    <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>);</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span> </div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span><span class="comment">     * Unload the module and release the references to the device object</span></div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span><span class="comment">     */</span></div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span> </div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>    <span class="comment">/* Call the load/unload routine, depending on current process */</span></div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>    <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverUnload &amp;&amp; <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverSection &amp;&amp;</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>        (UnloadPnpDrivers || (<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Flags &amp; <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#ae5b6ac2bff8546255ae112e3031eaf73">DRVO_LEGACY_DRIVER</a>)))</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>    {</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>        <span class="comment">/* Loop through each device object of the driver</span></div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span><span class="comment">           and set DOE_UNLOAD_PENDING flag */</span></div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>        <a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a> = <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DeviceObject;</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>        <span class="keywordflow">while</span> (<a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a>)</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>        {</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>            <span class="comment">/* Set the unload pending flag for the device */</span></div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>            DeviceExtension = <a class="code hl_define" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#afd969d4fefb00d6a25e6f453e27ca3f1">IoGetDevObjExtension</a>(<a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a>);</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>            DeviceExtension-&gt;<a class="code hl_variable" href="../../d0/dc5/struct__EXTENDED__DEVOBJ__EXTENSION.html#acdada0c7292023e165436029909c3d16">ExtensionFlags</a> |= <a class="code hl_define" href="../../d6/d0e/ndk_2iotypes_8h.html#ad4bbef1db9f40e2e3b69d610203d89a6">DOE_UNLOAD_PENDING</a>;</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span> </div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>            <span class="comment">/* Make sure there are no attached devices or no reference counts */</span></div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>            <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a>-&gt;ReferenceCount) || (<a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a>-&gt;AttachedDevice))</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>            {</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>                <span class="comment">/* Not safe to unload */</span></div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>                <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Drivers device object is referenced or has attached devices\n&quot;</span>);</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span> </div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>                SafeToUnload = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>            }</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span> </div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>            <a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a> = <a class="code hl_typedef" href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a>-&gt;NextDevice;</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>        }</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span> </div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>        <span class="comment">/* If not safe to unload, then return success */</span></div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>        <span class="keywordflow">if</span> (!SafeToUnload)</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>        {</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>            <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a>;</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>        }</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span> </div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Unloading driver &#39;%wZ&#39; (manual)\n&quot;</span>, &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName);</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span> </div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>        <span class="comment">/* Set the unload invoked flag and call the unload routine */</span></div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>        <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Flags |= <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#abfb03142686df4cd9bf3f3f4bce08141">DRVO_UNLOAD_INVOKED</a>;</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>        <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#acee5e07a3e07721bb0b8f6b5f9ed27ca">IopDoLoadUnloadDriver</a>(<a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>        <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> == <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a>);</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span> </div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>        <span class="comment">/* Mark the driver object temporary, so it could be deleted later */</span></div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>        <a class="code hl_function" href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span> </div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>        <span class="comment">/* Dereference it 2 times */</span></div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span> </div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>    }</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>    {</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;No DriverUnload function! &#39;%wZ&#39; will not be unloaded!\n&quot;</span>, &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName);</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span> </div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>        <span class="comment">/* Dereference one time (refd inside this function) */</span></div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span> </div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>        <span class="comment">/* Return unloading failure */</span></div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#a120a187f72577ad105c76fea7124fb72">STATUS_INVALID_DEVICE_REQUEST</a>;</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>    }</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>}</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span> </div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"><a class="line" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#ac3a7a1a03e84c61dc478fc7fa4279467"> 1482</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ac3a7a1a03e84c61dc478fc7fa4279467">IopReinitializeDrivers</a>(<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a>)</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>{</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>    <a class="code hl_struct" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">PDRIVER_REINIT_ITEM</a> ReinitItem;</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>    <a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">PLIST_ENTRY</a> <a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a>;</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span> </div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>    <span class="comment">/* Get the first entry and start looping */</span></div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>    <a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a> = <a class="code hl_function" href="../../da/dd8/interlocked_8c.html#af4c6d8697a92628801df34ab85a92a24">ExInterlockedRemoveHeadList</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a023fc8a7d57b06273584cc58d8825bab">DriverReinitListHead</a>,</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>                                        &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a89a6b27be872011e4186ca371e294cad">DriverReinitListLock</a>);</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>    <span class="keywordflow">while</span> (<a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a>)</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>    {</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>        <span class="comment">/* Get the item */</span></div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>        ReinitItem = <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(<a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a>, <a class="code hl_struct" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">DRIVER_REINIT_ITEM</a>, ItemEntry);</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span> </div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>        <span class="comment">/* Increment reinitialization counter */</span></div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>        ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a>-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a7e5dc9baae90572acab2d120eb80777c">DriverExtension</a>-&gt;<a class="code hl_variable" href="../../d0/d9f/struct__DRIVER__EXTENSION.html#ad538c293521ec3d6b4fb739d271fde1d">Count</a>++;</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span> </div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>        <span class="comment">/* Remove the device object flag */</span></div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>        ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a>-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#aeeeeb24f7c061f50df72e6d527bd2480">Flags</a> &amp;= ~DRVO_REINIT_REGISTERED;</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span> </div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>        <span class="comment">/* Call the routine */</span></div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>        ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a43acd578b834eaf41bcb7f704b188c5b">ReinitRoutine</a>(ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a>,</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>                                  ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#ab33c8024bc28782758ec4d1c68528f5f">Context</a>,</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>                                  ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a>-&gt;</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>                                  <a class="code hl_variable" href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a>-&gt;Count);</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span> </div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>        <span class="comment">/* Free the entry */</span></div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(<a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a>);</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>        <span class="comment">/* Move to the next one */</span></div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>        <a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a> = <a class="code hl_function" href="../../da/dd8/interlocked_8c.html#af4c6d8697a92628801df34ab85a92a24">ExInterlockedRemoveHeadList</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a023fc8a7d57b06273584cc58d8825bab">DriverReinitListHead</a>,</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>                                            &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a89a6b27be872011e4186ca371e294cad">DriverReinitListLock</a>);</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span>    }</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>}</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span> </div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"><a class="line" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a0e5843cbc444a70cc5aac2359278023c"> 1518</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a0e5843cbc444a70cc5aac2359278023c">IopReinitializeBootDrivers</a>(<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a>)</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>{</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>    <a class="code hl_struct" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">PDRIVER_REINIT_ITEM</a> ReinitItem;</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>    <a class="code hl_struct" href="../../d9/da7/struct__LIST__ENTRY.html">PLIST_ENTRY</a> <a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a>;</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span> </div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>    <span class="comment">/* Get the first entry and start looping */</span></div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>    <a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a> = <a class="code hl_function" href="../../da/dd8/interlocked_8c.html#af4c6d8697a92628801df34ab85a92a24">ExInterlockedRemoveHeadList</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a877184253b37df8518f2c99eb916194f">DriverBootReinitListHead</a>,</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>                                        &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4e4e9004f1cf0ca3142470fbb15c408a">DriverBootReinitListLock</a>);</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>    <span class="keywordflow">while</span> (<a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a>)</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>    {</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>        <span class="comment">/* Get the item */</span></div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>        ReinitItem = <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a>(<a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a>, <a class="code hl_struct" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">DRIVER_REINIT_ITEM</a>, ItemEntry);</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span> </div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>        <span class="comment">/* Increment reinitialization counter */</span></div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>        ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a>-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a7e5dc9baae90572acab2d120eb80777c">DriverExtension</a>-&gt;<a class="code hl_variable" href="../../d0/d9f/struct__DRIVER__EXTENSION.html#ad538c293521ec3d6b4fb739d271fde1d">Count</a>++;</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span> </div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>        <span class="comment">/* Remove the device object flag */</span></div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>        ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a>-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#aeeeeb24f7c061f50df72e6d527bd2480">Flags</a> &amp;= ~DRVO_BOOTREINIT_REGISTERED;</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span> </div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>        <span class="comment">/* Call the routine */</span></div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>        ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a43acd578b834eaf41bcb7f704b188c5b">ReinitRoutine</a>(ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a>,</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>                                  ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#ab33c8024bc28782758ec4d1c68528f5f">Context</a>,</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>                                  ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a>-&gt;</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>                                  <a class="code hl_variable" href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a>-&gt;Count);</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span> </div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>        <span class="comment">/* Free the entry */</span></div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(<a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a>);</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span> </div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>        <span class="comment">/* Move to the next one */</span></div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>        <a class="code hl_struct" href="../../dc/d45/structEntry.html">Entry</a> = <a class="code hl_function" href="../../da/dd8/interlocked_8c.html#af4c6d8697a92628801df34ab85a92a24">ExInterlockedRemoveHeadList</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a877184253b37df8518f2c99eb916194f">DriverBootReinitListHead</a>,</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>                                            &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4e4e9004f1cf0ca3142470fbb15c408a">DriverBootReinitListLock</a>);</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>    }</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span> </div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>    <span class="comment">/* Wait for all device actions being finished*/</span></div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>    <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a5a6535a15dfcdbbeeba951aee7ec061f">KeWaitForSingleObject</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a235196d589c1bf0e2acdfd8c8ea1e9c9">PiEnumerationFinished</a>, <a class="code hl_enumvalue" href="../../d7/deb/xdk_2ketypes_8h.html#a32f8868bc010efa7da787526013b93fbaef4a94e9f8e774dbbdc34d5860262fae">Executive</a>, <a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>}</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span> </div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span><span class="comment">/* PUBLIC FUNCTIONS ***********************************************************/</span></div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span> </div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span><span class="comment">/*</span></div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span><span class="comment"> * @implemented</span></div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span><span class="comment"> */</span></div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a3b38bafeb96d588a0c1993af7c0e933b"> 1562</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a3b38bafeb96d588a0c1993af7c0e933b">IoCreateDriver</a>(</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> DriverName,</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> <a class="code hl_typedef" href="../../d4/d1b/xdk_2iotypes_8h.html#afd9a2a89638ac17d11c8ab2b1765cb07">PDRIVER_INITIALIZE</a> InitializationFunction)</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>{</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>    <a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a> NameBuffer[100];</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>    <a class="code hl_typedef" href="../../dd/d43/pedump_8c.html#acbe62d57a534c724ae14fcec5318b033">USHORT</a> NameLength;</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> LocalDriverName;</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>    <a class="code hl_struct" href="../../d6/d32/struct__OBJECT__ATTRIBUTES.html">OBJECT_ATTRIBUTES</a> <a class="code hl_variable" href="../../d6/d79/conport_8c.html#af2fb0d1dfbf6e598eed9e4633a0693a0">ObjectAttributes</a>;</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> ObjectSize;</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span>    <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>;</div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> ServiceKeyName;</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>    <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> <a class="code hl_typedef" href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a>;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>, RetryCount = 0;</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span> </div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>try_again:</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>    <span class="comment">/* First, create a unique name for the driver if we don&#39;t have one */</span></div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>    <span class="keywordflow">if</span> (!DriverName)</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>    {</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>        <span class="comment">/* Create a random name and set up the string */</span></div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>        NameLength = (<a class="code hl_typedef" href="../../dd/d43/pedump_8c.html#acbe62d57a534c724ae14fcec5318b033">USHORT</a>)<a class="code hl_define" href="../../d2/df1/dll_2win32_2wininet_2precomp_8h.html#ad87a7b915754dd9b23b4dee3787637e7">swprintf</a>(NameBuffer,</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>                                      <a class="code hl_define" href="../../df/def/ldr_8h.html#a964bc036dd01080400547c81b212f938">DRIVER_ROOT_NAME</a> <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;%08u&quot;</span>,</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>                                      <a class="code hl_variable" href="../../dd/dc9/ntoskrnl_2include_2internal_2amd64_2ke_8h.html#abef0d79fb75e1e90b50d8033abe0a27d">KeTickCount</a>.<a class="code hl_variable" href="../../d1/de3/struct__KSYSTEM__TIME.html#a7e5f6afc567e66eae778e8baca6cef41">LowPart</a>);</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>        LocalDriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = NameLength * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>);</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>        LocalDriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = LocalDriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> + <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>        LocalDriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = NameBuffer;</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>    }</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>    {</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>        <span class="comment">/* So we can avoid another code path, use a local var */</span></div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>        LocalDriverName = *DriverName;</div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>    }</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span> </div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>    <span class="comment">/* Initialize the Attributes */</span></div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>    ObjectSize = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d1b/xdk_2iotypes_8h.html#a4c50fee2eca9a0ea94b1098ee59a9137">DRIVER_OBJECT</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d7/d80/struct__EXTENDED__DRIVER__EXTENSION.html">EXTENDED_DRIVER_EXTENSION</a>);</div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>    <a class="code hl_define" href="../../de/d63/modules_2rostests_2winetests_2ntdll_2reg_8c.html#a327a7264f49955a340d1b07a90e1c62e">InitializeObjectAttributes</a>(&amp;<a class="code hl_variable" href="../../d6/d79/conport_8c.html#af2fb0d1dfbf6e598eed9e4633a0693a0">ObjectAttributes</a>,</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>                               &amp;LocalDriverName,</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>                               <a class="code hl_define" href="../../de/d7d/include_2psdk_2winternl_8h.html#ae65366b3f012988240f2ed8ad14e1356">OBJ_PERMANENT</a> | <a class="code hl_define" href="../../de/d7d/include_2psdk_2winternl_8h.html#a5fb824737b82a44c9dcf0f07316602c4">OBJ_CASE_INSENSITIVE</a> | <a class="code hl_define" href="../../de/d7d/include_2psdk_2winternl_8h.html#a29c69e248fc19f729a5ad8b57bdcf1cf">OBJ_KERNEL_HANDLE</a>,</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>                               <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>                               <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span> </div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>    <span class="comment">/* Create the Object */</span></div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d3/d29/oblife_8c.html#a4d6fd4313677c77f824e941b80cd65ca">ObCreateObject</a>(<a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>,</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>                            <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a089710c43d7e59e34be0f1781ffc8806">IoDriverObjectType</a>,</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>                            &amp;<a class="code hl_variable" href="../../d6/d79/conport_8c.html#af2fb0d1dfbf6e598eed9e4633a0693a0">ObjectAttributes</a>,</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>                            <a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>,</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>                            <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>                            ObjectSize,</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>                            0,</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>                            0,</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>                            (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>*)&amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>)) <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span> </div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;IopCreateDriver(): created DO %p\n&quot;</span>, <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span> </div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>    <span class="comment">/* Set up the Object */</span></div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>    <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#abd90afec09d7094004e811f9056461b3">RtlZeroMemory</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>, ObjectSize);</div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Type = <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#ade157ec6ad626917e601334a1432402d">IO_TYPE_DRIVER</a>;</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Size = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d1b/xdk_2iotypes_8h.html#a4c50fee2eca9a0ea94b1098ee59a9137">DRIVER_OBJECT</a>);</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Flags = <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#a35f11de228808af9f90c3b963cd458e0">DRVO_BUILTIN_DRIVER</a>;</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverExtension = (<a class="code hl_typedef" href="../../d4/d1b/xdk_2iotypes_8h.html#a56f801e9f957ddfea75f7306ab84b5f1">PDRIVER_EXTENSION</a>)(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a> + 1);</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverExtension-&gt;DriverObject = <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>;</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#a7a21171ec2be18dd1ec5b8c74fc0c425">DriverInit</a> = InitializationFunction;</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>    <span class="comment">/* Loop all Major Functions */</span></div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>    <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> = 0; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> &lt;= <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#afd014f12d0198da8a080c3b856803795">IRP_MJ_MAXIMUM_FUNCTION</a>; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>++)</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>    {</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>        <span class="comment">/* Invalidate each function */</span></div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>        <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;MajorFunction[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>] = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a6dd290dcc1d2874e4fa5734521428a41">IopInvalidDeviceRequest</a>;</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>    }</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span> </div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>    <span class="comment">/* Set up the service key name buffer */</span></div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>    ServiceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = LocalDriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> + <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>    ServiceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>, LocalDriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>    <span class="keywordflow">if</span> (!ServiceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>)</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>    {</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>        <span class="comment">/* Fail */</span></div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>        <a class="code hl_function" href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>    }</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span> </div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>    <span class="comment">/* For builtin drivers, the ServiceKeyName is equal to DriverName */</span></div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a0050303384bee38cd30898b2c12dae71">RtlCopyUnicodeString</a>(&amp;ServiceKeyName, &amp;LocalDriverName);</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>    ServiceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>[ServiceKeyName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>)] = <a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>;</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverExtension-&gt;ServiceKeyName = ServiceKeyName;</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span> </div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>    <span class="comment">/* Make a copy of the driver name to store in the driver object */</span></div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = LocalDriverName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a>;</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName.Buffer = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>,</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>                                                            <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName.MaximumLength,</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>                                                            <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>    <span class="keywordflow">if</span> (!<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName.Buffer)</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>    {</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>        <span class="comment">/* Fail */</span></div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>        <a class="code hl_function" href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>    }</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span> </div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#a0050303384bee38cd30898b2c12dae71">RtlCopyUnicodeString</a>(&amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName, &amp;LocalDriverName);</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span> </div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>    <span class="comment">/* Add the Object and get its handle */</span></div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d4/df6/obhandle_8c.html#a5a78c6116c097c9ee18cc64b7b512483">ObInsertObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>,</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>                            <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>                            <a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a2f899eca0dc42731afb043b6aacb0bd5">FILE_READ_DATA</a>,</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>                            0,</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>                            <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>,</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>                            &amp;<a class="code hl_typedef" href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a>);</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span> </div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>    <span class="comment">/* Eliminate small possibility when this function is called more than</span></div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span><span class="comment">       once in a row, and KeTickCount doesn&#39;t get enough time to change */</span></div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>    <span class="keywordflow">if</span> (!DriverName &amp;&amp; (<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> == <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#ab9f3c338390cb777c51ec83bdd8ee56b">STATUS_OBJECT_NAME_COLLISION</a>) &amp;&amp; (RetryCount &lt; 100))</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>    {</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>        RetryCount++;</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>        <span class="keywordflow">goto</span> try_again;</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>    }</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span> </div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>)) <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span> </div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>    <span class="comment">/* Now reference it */</span></div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../db/d18/obref_8c.html#ac203db242742089bdaa6846a09383053">ObReferenceObjectByHandle</a>(<a class="code hl_typedef" href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a>,</div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>                                       0,</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>                                       <a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a089710c43d7e59e34be0f1781ffc8806">IoDriverObjectType</a>,</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>                                       <a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>,</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>                                       (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>*)&amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>,</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>                                       <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span> </div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>    <span class="comment">/* Close the extra handle */</span></div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>    <a class="code hl_function" href="../../de/df6/ndk_2obfuncs_8h.html#a5e0a128a3b03af9e6deef339000e30e0">ZwClose</a>(<a class="code hl_typedef" href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a>);</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span> </div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>    {</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>        <span class="comment">/* Fail */</span></div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>        <a class="code hl_function" href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>    }</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span> </div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>    <span class="comment">/* Finally, call its init function */</span></div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;Calling driver entrypoint at %p\n&quot;</span>, InitializationFunction);</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = InitializationFunction(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>    {</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>        <span class="comment">/* If it didn&#39;t work, then kill the object */</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;&#39;%wZ&#39; initialization failed, status (0x%08lx)\n&quot;</span>, &amp;LocalDriverName, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>        <a class="code hl_function" href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>        <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>    }</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span> </div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>    <span class="comment">/* Windows does this fixup, keep it for compatibility */</span></div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>    <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> = 0; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a> &lt;= <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#afd014f12d0198da8a080c3b856803795">IRP_MJ_MAXIMUM_FUNCTION</a>; <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>++)</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>    {</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>        <span class="comment">/*</span></div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span><span class="comment">         * Make sure the driver didn&#39;t set any dispatch entry point to NULL!</span></div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span><span class="comment">         * Doing so is illegal; drivers shouldn&#39;t touch entry points they</span></div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span><span class="comment">         * do not implement.</span></div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span><span class="comment">         */</span></div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span> </div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>        <span class="comment">/* Check if it did so anyway */</span></div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>        <span class="keywordflow">if</span> (!<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;MajorFunction[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>])</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>        {</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>            <span class="comment">/* Print a warning in the debug log */</span></div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>            <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;Driver &lt;%wZ&gt; set DriverObject-&gt;MajorFunction[%lu] to NULL!\n&quot;</span>,</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>                    &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;DriverName, <a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>);</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span> </div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>            <span class="comment">/* Fix it up */</span></div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>            <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;MajorFunction[<a class="code hl_variable" href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a>] = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a6dd290dcc1d2874e4fa5734521428a41">IopInvalidDeviceRequest</a>;</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>        }</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>    }</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span> </div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>    <span class="comment">/* Return the Status */</span></div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>    <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>}</div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span> </div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span><span class="comment">/*</span></div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span><span class="comment"> * @implemented</span></div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span><span class="comment"> */</span></div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a5e8138869c13e27fabebc53b5825ae68"> 1742</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a5e8138869c13e27fabebc53b5825ae68">IoDeleteDriver</a>(</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>)</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>{</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span>    <span class="comment">/* Simply dereference the Object */</span></div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>    <a class="code hl_define" href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>}</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span> </div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span><span class="comment">/*</span></div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span><span class="comment"> * @implemented</span></div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span><span class="comment"> */</span></div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a776175cfd70f4b8048578e66a932330d"> 1754</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a776175cfd70f4b8048578e66a932330d">IoRegisterBootDriverReinitialization</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>,</div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>                                     <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_typedef" href="../../d4/d1b/xdk_2iotypes_8h.html#a53640a56e4b226b0ad626ddea0c9a151">PDRIVER_REINITIALIZE</a> ReinitRoutine,</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>                                     <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> <a class="code hl_struct" href="../../d6/d7a/structContext.html">Context</a>)</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>{</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>    <a class="code hl_struct" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">PDRIVER_REINIT_ITEM</a> ReinitItem;</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span> </div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>    <span class="comment">/* Allocate the entry */</span></div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>    ReinitItem = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>,</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>                                       <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">DRIVER_REINIT_ITEM</a>),</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>                                       <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a5cc8acd2cc8c25caced891be5a08f285">TAG_REINIT</a>);</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>    <span class="keywordflow">if</span> (!ReinitItem) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span> </div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span>    <span class="comment">/* Fill it out */</span></div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>    ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a> = <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>;</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>    ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a43acd578b834eaf41bcb7f704b188c5b">ReinitRoutine</a> = ReinitRoutine;</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>    ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#ab33c8024bc28782758ec4d1c68528f5f">Context</a> = <a class="code hl_struct" href="../../d6/d7a/structContext.html">Context</a>;</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span> </div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>    <span class="comment">/* Set the Driver Object flag and insert the entry into the list */</span></div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Flags |= <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#a7e46add1e9b7abf819993f491892bf10">DRVO_BOOTREINIT_REGISTERED</a>;</div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>    <a class="code hl_function" href="../../da/dd8/interlocked_8c.html#a6902ee6533d1070f2fa707e371a3bef3">ExInterlockedInsertTailList</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a877184253b37df8518f2c99eb916194f">DriverBootReinitListHead</a>,</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>                                &amp;ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a67ddc56fff3490a6987181b635bf5ca9">ItemEntry</a>,</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span>                                &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4e4e9004f1cf0ca3142470fbb15c408a">DriverBootReinitListLock</a>);</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>}</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span> </div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span><span class="comment">/*</span></div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span><span class="comment"> * @implemented</span></div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span><span class="comment"> */</span></div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a28fe5a6b2b3165714817e984035599b8"> 1783</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a28fe5a6b2b3165714817e984035599b8">IoRegisterDriverReinitialization</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>,</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>                                 <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_typedef" href="../../d4/d1b/xdk_2iotypes_8h.html#a53640a56e4b226b0ad626ddea0c9a151">PDRIVER_REINITIALIZE</a> ReinitRoutine,</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>                                 <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> <a class="code hl_struct" href="../../d6/d7a/structContext.html">Context</a>)</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>{</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>    <a class="code hl_struct" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">PDRIVER_REINIT_ITEM</a> ReinitItem;</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span> </div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>    <span class="comment">/* Allocate the entry */</span></div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>    ReinitItem = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>,</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>                                       <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">DRIVER_REINIT_ITEM</a>),</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>                                       <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a5cc8acd2cc8c25caced891be5a08f285">TAG_REINIT</a>);</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>    <span class="keywordflow">if</span> (!ReinitItem) <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span> </div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>    <span class="comment">/* Fill it out */</span></div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>    ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">DriverObject</a> = <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>;</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>    ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a43acd578b834eaf41bcb7f704b188c5b">ReinitRoutine</a> = ReinitRoutine;</div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>    ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#ab33c8024bc28782758ec4d1c68528f5f">Context</a> = <a class="code hl_struct" href="../../d6/d7a/structContext.html">Context</a>;</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span> </div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>    <span class="comment">/* Set the Driver Object flag and insert the entry into the list */</span></div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>-&gt;Flags |= <a class="code hl_define" href="../../d4/d1b/xdk_2iotypes_8h.html#adb67717b473e01dadf3754c5053ab13b">DRVO_REINIT_REGISTERED</a>;</div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>    <a class="code hl_function" href="../../da/dd8/interlocked_8c.html#a6902ee6533d1070f2fa707e371a3bef3">ExInterlockedInsertTailList</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a023fc8a7d57b06273584cc58d8825bab">DriverReinitListHead</a>,</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>                                &amp;ReinitItem-&gt;<a class="code hl_variable" href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a67ddc56fff3490a6987181b635bf5ca9">ItemEntry</a>,</div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>                                &amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a89a6b27be872011e4186ca371e294cad">DriverReinitListLock</a>);</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>}</div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span> </div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span><span class="comment">/*</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span><span class="comment"> * @implemented</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span><span class="comment"> */</span></div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a32ff938de6ca67d9593c5a52b234cdd5"> 1812</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a32ff938de6ca67d9593c5a52b234cdd5">IoAllocateDriverObjectExtension</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>,</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>                                <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> <a class="code hl_variable" href="../../d8/d5e/hidclass_8c.html#aa53148327f9f39530eb00e18f3d58141">ClientIdentificationAddress</a>,</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>                                <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> DriverObjectExtensionSize,</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>                                <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> *DriverObjectExtension)</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>{</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>    <a class="code hl_typedef" href="../../dd/df3/env__spec__w32_8h.html#a34649dd83e77771e19b14cefe45ee25d">KIRQL</a> <a class="code hl_variable" href="../../d0/df5/xdk_2kefuncs_8h.html#a2cc5c0a17902ef80dc0661ffc87634f7">OldIrql</a>;</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>    <a class="code hl_struct" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html">PIO_CLIENT_EXTENSION</a> DriverExtensions, NewDriverExtension;</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>    <a class="code hl_typedef" href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a> Inserted = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span> </div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>    <span class="comment">/* Assume failure */</span></div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>    *DriverObjectExtension = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>;</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span> </div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>    <span class="comment">/* Allocate the extension */</span></div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>    NewDriverExtension = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a>,</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>                                               <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html">IO_CLIENT_EXTENSION</a>) +</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>                                               DriverObjectExtensionSize,</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>                                               <a class="code hl_define" href="../../d2/dcd/tag_8h.html#aa721980a71e3fbd417666df64ce05e04">TAG_DRIVER_EXTENSION</a>);</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>    <span class="keywordflow">if</span> (!NewDriverExtension) <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span> </div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>    <span class="comment">/* Clear the extension for teh caller */</span></div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>    <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#abd90afec09d7094004e811f9056461b3">RtlZeroMemory</a>(NewDriverExtension,</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>                  <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html">IO_CLIENT_EXTENSION</a>) + DriverObjectExtensionSize);</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span> </div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>    <span class="comment">/* Acqure lock */</span></div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>    <a class="code hl_variable" href="../../d0/df5/xdk_2kefuncs_8h.html#a2cc5c0a17902ef80dc0661ffc87634f7">OldIrql</a> = <a class="code hl_variable" href="../../d9/dfa/filesystems_2udfs_2Include_2CrossNt_2CrNtStubs_8h.html#a710a7cb48e2286133155069fcb7d1ba6">KeRaiseIrqlToDpcLevel</a>();</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span> </div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>    <span class="comment">/* Fill out the extension */</span></div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>    NewDriverExtension-&gt;<a class="code hl_variable" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html#a3a29cb0edd5eb30a5acf908aafbe77ea">ClientIdentificationAddress</a> = <a class="code hl_variable" href="../../d8/d5e/hidclass_8c.html#aa53148327f9f39530eb00e18f3d58141">ClientIdentificationAddress</a>;</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span> </div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>    <span class="comment">/* Loop the current extensions */</span></div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>    DriverExtensions = <a class="code hl_define" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81f61f779d7dd41614cd190dc653c44b">IoGetDrvObjExtension</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>)-&gt;</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>                       ClientDriverExtension;</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>    <span class="keywordflow">while</span> (DriverExtensions)</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>    {</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span>        <span class="comment">/* Check if the identifier matches */</span></div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>        <span class="keywordflow">if</span> (DriverExtensions-&gt;<a class="code hl_variable" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html#a3a29cb0edd5eb30a5acf908aafbe77ea">ClientIdentificationAddress</a> ==</div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>            <a class="code hl_variable" href="../../d8/d5e/hidclass_8c.html#aa53148327f9f39530eb00e18f3d58141">ClientIdentificationAddress</a>)</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>        {</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>            <span class="comment">/* We have a collision, break out */</span></div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>        }</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span> </div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>        <span class="comment">/* Go to the next one */</span></div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>        DriverExtensions = DriverExtensions-&gt;<a class="code hl_variable" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html#a4b4c96c8a54b91c818d12d37ed14a2a1">NextExtension</a>;</div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>    }</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span> </div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>    <span class="comment">/* Check if we didn&#39;t collide */</span></div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>    <span class="keywordflow">if</span> (!DriverExtensions)</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>    {</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>        <span class="comment">/* Link this one in */</span></div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>        NewDriverExtension-&gt;<a class="code hl_variable" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html#a4b4c96c8a54b91c818d12d37ed14a2a1">NextExtension</a> =</div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>            <a class="code hl_define" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81f61f779d7dd41614cd190dc653c44b">IoGetDrvObjExtension</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>)-&gt;ClientDriverExtension;</div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>        <a class="code hl_define" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81f61f779d7dd41614cd190dc653c44b">IoGetDrvObjExtension</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>)-&gt;ClientDriverExtension =</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>            NewDriverExtension;</div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>        Inserted = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a>;</div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>    }</div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span> </div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span>    <span class="comment">/* Release the lock */</span></div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>    <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a815006d5e3f6071e04e34d01419ffe9e">KeLowerIrql</a>(<a class="code hl_variable" href="../../d0/df5/xdk_2kefuncs_8h.html#a2cc5c0a17902ef80dc0661ffc87634f7">OldIrql</a>);</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span> </div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>    <span class="comment">/* Check if insertion failed */</span></div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>    <span class="keywordflow">if</span> (!Inserted)</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>    {</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>        <span class="comment">/* Free the entry and fail */</span></div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>        <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(NewDriverExtension, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#aa721980a71e3fbd417666df64ce05e04">TAG_DRIVER_EXTENSION</a>);</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#ab9f3c338390cb777c51ec83bdd8ee56b">STATUS_OBJECT_NAME_COLLISION</a>;</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>    }</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span> </div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>    <span class="comment">/* Otherwise, return the pointer */</span></div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>    *DriverObjectExtension = NewDriverExtension + 1;</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a>;</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span>}</div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span> </div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span><span class="comment">/*</span></div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span><span class="comment"> * @implemented</span></div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span><span class="comment"> */</span></div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a></div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a1f6108a72b327451dff3d76e01c61015"> 1890</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a1f6108a72b327451dff3d76e01c61015">IoGetDriverObjectExtension</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>,</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>                           <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> <a class="code hl_variable" href="../../d8/d5e/hidclass_8c.html#aa53148327f9f39530eb00e18f3d58141">ClientIdentificationAddress</a>)</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>{</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span>    <a class="code hl_typedef" href="../../dd/df3/env__spec__w32_8h.html#a34649dd83e77771e19b14cefe45ee25d">KIRQL</a> <a class="code hl_variable" href="../../d0/df5/xdk_2kefuncs_8h.html#a2cc5c0a17902ef80dc0661ffc87634f7">OldIrql</a>;</div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>    <a class="code hl_struct" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html">PIO_CLIENT_EXTENSION</a> DriverExtensions;</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span> </div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>    <span class="comment">/* Acquire lock */</span></div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>    <a class="code hl_variable" href="../../d0/df5/xdk_2kefuncs_8h.html#a2cc5c0a17902ef80dc0661ffc87634f7">OldIrql</a> = <a class="code hl_variable" href="../../d9/dfa/filesystems_2udfs_2Include_2CrossNt_2CrNtStubs_8h.html#a710a7cb48e2286133155069fcb7d1ba6">KeRaiseIrqlToDpcLevel</a>();</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span> </div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>    <span class="comment">/* Loop the list until we find the right one */</span></div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>    DriverExtensions = <a class="code hl_define" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81f61f779d7dd41614cd190dc653c44b">IoGetDrvObjExtension</a>(<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>)-&gt;ClientDriverExtension;</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>    <span class="keywordflow">while</span> (DriverExtensions)</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span>    {</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>        <span class="comment">/* Check for a match */</span></div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>        <span class="keywordflow">if</span> (DriverExtensions-&gt;<a class="code hl_variable" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html#a3a29cb0edd5eb30a5acf908aafbe77ea">ClientIdentificationAddress</a> ==</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>            <a class="code hl_variable" href="../../d8/d5e/hidclass_8c.html#aa53148327f9f39530eb00e18f3d58141">ClientIdentificationAddress</a>)</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>        {</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>            <span class="comment">/* Break out */</span></div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>        }</div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span> </div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>        <span class="comment">/* Keep looping */</span></div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>        DriverExtensions = DriverExtensions-&gt;<a class="code hl_variable" href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html#a4b4c96c8a54b91c818d12d37ed14a2a1">NextExtension</a>;</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>    }</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span> </div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>    <span class="comment">/* Release lock */</span></div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span>    <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a815006d5e3f6071e04e34d01419ffe9e">KeLowerIrql</a>(<a class="code hl_variable" href="../../d0/df5/xdk_2kefuncs_8h.html#a2cc5c0a17902ef80dc0661ffc87634f7">OldIrql</a>);</div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span> </div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>    <span class="comment">/* Return nothing or the extension */</span></div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>    <span class="keywordflow">if</span> (!DriverExtensions) <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>;</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>    <span class="keywordflow">return</span> DriverExtensions + 1;</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>}</div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span> </div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"><a class="line" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a1b5a2c0ea74ed8b816eef35731cb268e"> 1924</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a1b5a2c0ea74ed8b816eef35731cb268e">IopLoadDriver</a>(</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> ServiceHandle,</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> *<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>)</div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>{</div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> ImagePath;</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>    <a class="code hl_struct" href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">PLDR_DATA_TABLE_ENTRY</a> ModuleObject;</div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>    <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> <a class="code hl_variable" href="../../d8/d6b/ndk_2mmfuncs_8h.html#a931581205a5330fc8f83c9e7124e06f6">BaseAddress</a>;</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span> </div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>    <a class="code hl_struct" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html">PKEY_VALUE_FULL_INFORMATION</a> kvInfo;</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81d50dfa1cd5946c225a6db89dc11df4">IopGetRegistryValue</a>(ServiceHandle, <a class="code hl_define" href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a><span class="stringliteral">&quot;ImagePath&quot;</span>, &amp;kvInfo);</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>    {</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>        <span class="keywordflow">if</span> ((kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a2d830e8dad303c46a6b9d5f159e59994">Type</a> != <a class="code hl_define" href="../../db/dc9/nt__native_8h.html#ae7d8a09478b0795189f15f9b2686a431">REG_EXPAND_SZ</a> &amp;&amp; kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a2d830e8dad303c46a6b9d5f159e59994">Type</a> != <a class="code hl_define" href="../../dd/dad/layer_8c.html#ae7c552d6e252741d01dbb89c2ac7e69d">REG_SZ</a>) || kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a> == 0)</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span>        {</div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>            <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/d93/ntstatus_8h.html#a5eb20a2ed21575310c474c1241656b1a">STATUS_ILL_FORMED_SERVICE_ENTRY</a>;</div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>        }</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span> </div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>        ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> = kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a> - <span class="keyword">sizeof</span>(<a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>);</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>        ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a> = kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">DataLength</a>;</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>        ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>, ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">MaximumLength</a>, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a6f0ee2ea2d6b53a2e0584162ca106677">TAG_RTLREGISTRY</a>);</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>        <span class="keywordflow">if</span> (!ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>)</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>        {</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>            <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a>;</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>        }</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span> </div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>        <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#adb696f4512c9ed33dd7d571f296b7ebb">RtlMoveMemory</a>(ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>,</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>                      (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>)((<a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ac078b01ba50a19d9467601bd01f70131">ULONG_PTR</a>)kvInfo + kvInfo-&gt;<a class="code hl_variable" href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a513fbe4d9ba9d970466025722570355a">DataOffset</a>),</div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>                      ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a>);</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>        ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a>[ImagePath.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a>)] = <a class="code hl_define" href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a>;</div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a>(kvInfo);</div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>    }</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>    {</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>    }</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span> </div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span><span class="comment">     * Normalize the image path for all later processing.</span></div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span><span class="comment">     */</span></div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aea42c837ff323fc083e3cff1f8a92cc2">IopNormalizeImagePath</a>(&amp;ImagePath, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>    {</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>        <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;IopNormalizeImagePath() failed (Status %x)\n&quot;</span>, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>    }</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span> </div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;FullImagePath: &#39;%wZ&#39;\n&quot;</span>, &amp;ImagePath);</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span> </div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>    <a class="code hl_define" href="../../de/d90/ke__x_8h.html#abc110da33e985432712b6f113a9958a5">KeEnterCriticalRegion</a>();</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>    <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#abecf5c99139a6fd599cfa8801ff772d8">ExAcquireResourceExclusiveLite</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a2a33c1cd002e9d995c25647d13ece5b9">IopDriverLoadResource</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a>);</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span> </div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span><span class="comment">     * Load the driver module</span></div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span><span class="comment">     */</span></div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;Loading module from %wZ\n&quot;</span>, &amp;ImagePath);</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a21f6d9eda6b929c322a7f1800eed3b1f">MmLoadSystemImage</a>(&amp;ImagePath, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, 0, (<a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a>)&amp;ModuleObject, &amp;<a class="code hl_variable" href="../../d8/d6b/ndk_2mmfuncs_8h.html#a931581205a5330fc8f83c9e7124e06f6">BaseAddress</a>);</div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>    <a class="code hl_function" href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a>(&amp;ImagePath);</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span> </div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>    {</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>        <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;MmLoadSystemImage() failed (Status %lx)\n&quot;</span>, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>        <a class="code hl_function" href="../../de/dbf/ntoskrnl_2ex_2resource_8c.html#a61a69c738c2d9730a6a91a58b358cf3b">ExReleaseResourceLite</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a2a33c1cd002e9d995c25647d13ece5b9">IopDriverLoadResource</a>);</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span>        <a class="code hl_define" href="../../de/d90/ke__x_8h.html#a7329c257124ce1b4506e5fa6fbd58866">KeLeaveCriticalRegion</a>();</div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>    }</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span> </div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span>    <span class="comment">// Display the loading message</span></div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>    <a class="code hl_typedef" href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a> infoLength;</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = ZwQueryKey(ServiceHandle, <a class="code hl_enumvalue" href="../../db/dc9/nt__native_8h.html#a253bba9c575cd482f9b16ba67fd6cac7aa95e628590fe86fd05c0da2be52c9535">KeyBasicInformation</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, 0, &amp;infoLength);</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span>    <span class="keywordflow">if</span> (<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> == <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#ac978cc4096a590979ae52c9fd4f62ee0">STATUS_BUFFER_TOO_SMALL</a>)</div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>    {</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>        <a class="code hl_struct" href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html">PKEY_BASIC_INFORMATION</a> servName = <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a>(<a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a>, infoLength, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span>        <span class="keywordflow">if</span> (servName)</div>
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"> 2000</span>        {</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>            <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = ZwQueryKey(ServiceHandle,</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>                                <a class="code hl_enumvalue" href="../../db/dc9/nt__native_8h.html#a253bba9c575cd482f9b16ba67fd6cac7aa95e628590fe86fd05c0da2be52c9535">KeyBasicInformation</a>,</div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>                                servName,</div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>                                infoLength,</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>                                &amp;infoLength);</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>            {</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>                <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> <a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a> = {</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>                    .Length = servName-&gt;<a class="code hl_variable" href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html#afae31f01287262679ac988e567e0b774">NameLength</a>,</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span>                    .MaximumLength = servName-&gt;<a class="code hl_variable" href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html#afae31f01287262679ac988e567e0b774">NameLength</a>,</div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>                    .Buffer = servName-&gt;<a class="code hl_variable" href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html#a59beb4a726fd868b08ec17af9e7c86f5">Name</a></div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>                };</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span> </div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>                <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af6c7e94cbee2947162fdbb446b2fb7d7">IopDisplayLoadingMessage</a>(&amp;<a class="code hl_variable" href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a>);</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span>            }</div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>            <a class="code hl_define" href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a>(servName, <a class="code hl_define" href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a>);</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>        }</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span>    }</div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span> </div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> driverEntryStatus;</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a7ff70ce4037c9632cb68f1e3d3db77bd">IopInitializeDriverModule</a>(ModuleObject,</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>                                       ServiceHandle,</div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>                                       <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>,</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>                                       &amp;driverEntryStatus);</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>    {</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;IopInitializeDriverModule() failed (Status %lx)\n&quot;</span>, <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>);</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span>    }</div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span> </div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>    <a class="code hl_function" href="../../de/dbf/ntoskrnl_2ex_2resource_8c.html#a61a69c738c2d9730a6a91a58b358cf3b">ExReleaseResourceLite</a>(&amp;<a class="code hl_variable" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a2a33c1cd002e9d995c25647d13ece5b9">IopDriverLoadResource</a>);</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>    <a class="code hl_define" href="../../de/d90/ke__x_8h.html#a7329c257124ce1b4506e5fa6fbd58866">KeLeaveCriticalRegion</a>();</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span> </div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>    <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>}</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span> </div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span><span class="keyword">static</span></div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span><a class="code hl_interface" href="../../d6/d37/interfacevoid.html">VOID</a></div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span><a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ae3d61b4a88677a99c84cbbf2bd9c2872"> 2039</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ae3d61b4a88677a99c84cbbf2bd9c2872">IopLoadUnloadDriverWorker</a>(</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">PVOID</a> <a class="code hl_typedef" href="../../d1/d97/ldrtypes_8h.html#a0876c70189a079288c4b8161e681afaf">Parameter</a>)</div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>{</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>    <a class="code hl_struct" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html">PLOAD_UNLOAD_PARAMS</a> LoadParams = <a class="code hl_typedef" href="../../d1/d97/ldrtypes_8h.html#a0876c70189a079288c4b8161e681afaf">Parameter</a>;</div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span> </div>
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"> 2044</span>    <a class="code hl_define" href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a>(<a class="code hl_define" href="../../d7/dc1/xdk_2psfuncs_8h.html#a5fe197230e9c4bda040a839cf3286eae">PsGetCurrentProcess</a>() == <a class="code hl_variable" href="../../df/d84/psmgr_8c.html#a667297bfaa35579136c2da9440081452">PsInitialSystemProcess</a>);</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span> </div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>    <span class="keywordflow">if</span> (LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#aec96717639a93639a7a3635397420557">DriverObject</a>)</div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>    {</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>        <span class="comment">// unload request</span></div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>        LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#aec96717639a93639a7a3635397420557">DriverObject</a>-&gt;<a class="code hl_variable" href="../../d6/d72/struct__DRIVER__OBJECT.html#ac8240be40fd14318840f1c519c7ad7a2">DriverUnload</a>(LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#aec96717639a93639a7a3635397420557">DriverObject</a>);</div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>        LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0873879312b77cb4345ce0f7b6c3dd24">Status</a> = <a class="code hl_define" href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a>;</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span>    }</div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span>    {</div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>        <span class="comment">// load request</span></div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>        <a class="code hl_interface" href="../../d6/d37/interfacevoid.html">HANDLE</a> serviceHandle;</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>        <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>;</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>        <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a> = <a class="code hl_function" href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a01f4b50eabb9378327c4e6893b8b4300">IopOpenRegistryKeyEx</a>(&amp;serviceHandle, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>, LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#ae7565826a8d199333d11158f12b51124">RegistryPath</a>, <a class="code hl_define" href="../../db/dc9/nt__native_8h.html#a4ba1e0505cff2982015419c9004954d4">KEY_READ</a>);</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span>        <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>))</div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>        {</div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>            LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0873879312b77cb4345ce0f7b6c3dd24">Status</a> = <a class="code hl_struct" href="../../d9/d66/structstatus.html">status</a>;</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span>        }</div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span>        {</div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span>            LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0873879312b77cb4345ce0f7b6c3dd24">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a1b5a2c0ea74ed8b816eef35731cb268e">IopLoadDriver</a>(serviceHandle, &amp;LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#aec96717639a93639a7a3635397420557">DriverObject</a>);</div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>            <a class="code hl_function" href="../../de/df6/ndk_2obfuncs_8h.html#a5e0a128a3b03af9e6deef339000e30e0">ZwClose</a>(serviceHandle);</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>        }</div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>    }</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span> </div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>    <span class="keywordflow">if</span> (LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a2d73c8dfafd1fd005cbbe9953d41ced6">SetEvent</a>)</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>    {</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a860273a9f821b815b23d0d1ef49dce69">KeSetEvent</a>(&amp;LoadParams-&gt;<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a8b6d5f4a9a64eacc7e2b61082374b139">Event</a>, 0, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>    }</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>}</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span> </div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#acee5e07a3e07721bb0b8f6b5f9ed27ca"> 2085</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#acee5e07a3e07721bb0b8f6b5f9ed27ca">IopDoLoadUnloadDriver</a>(</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>,</div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>    <a class="code hl_define" href="../../de/d8c/ms__sal_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a> <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> *<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>)</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>{</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>    <a class="code hl_struct" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html">LOAD_UNLOAD_PARAMS</a> LoadParams;</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span> </div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>    <span class="comment">/* Prepare parameters block */</span></div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>    LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#ae7565826a8d199333d11158f12b51124">RegistryPath</a> = <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a>;</div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span>    LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#aec96717639a93639a7a3635397420557">DriverObject</a> = *<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>;</div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span> </div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d7/dc1/xdk_2psfuncs_8h.html#a5fe197230e9c4bda040a839cf3286eae">PsGetCurrentProcess</a>() != <a class="code hl_variable" href="../../df/d84/psmgr_8c.html#a667297bfaa35579136c2da9440081452">PsInitialSystemProcess</a>)</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>    {</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>        LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a2d73c8dfafd1fd005cbbe9953d41ced6">SetEvent</a> = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a>;</div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a6a4d5c4f7bc48f54c81ec3fe1c03976b">KeInitializeEvent</a>(&amp;LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a8b6d5f4a9a64eacc7e2b61082374b139">Event</a>, <a class="code hl_enumvalue" href="../../db/dd9/ntdef_8template_8h.html#a4fd8d54f196d53e4f9494e1874200d9ca0f0a3001be54605ffe444d2c19466d81">NotificationEvent</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span> </div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>        <span class="comment">/* Initialize and queue a work item */</span></div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>        <a class="code hl_define" href="../../dd/dba/xdk_2exfuncs_8h.html#a32e635370272925052821e9a4a773d63">ExInitializeWorkItem</a>(&amp;LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0395027b9f688a70c102e7cb01696203">WorkItem</a>, <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ae3d61b4a88677a99c84cbbf2bd9c2872">IopLoadUnloadDriverWorker</a>, &amp;LoadParams);</div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>        <a class="code hl_function" href="../../de/d56/work_8c.html#a8c10f13de7bb2f47358b32a157b9ed87">ExQueueWorkItem</a>(&amp;LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0395027b9f688a70c102e7cb01696203">WorkItem</a>, <a class="code hl_enumvalue" href="../../db/d49/xdk_2extypes_8h.html#a9526fdfbf669a4f1ded757685b0be448a0582af2b39cb941dbea5fe0e6b3fa741">DelayedWorkQueue</a>);</div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span> </div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>        <span class="comment">/* And wait till it completes */</span></div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>        <a class="code hl_define" href="../../dd/df3/env__spec__w32_8h.html#a5a6535a15dfcdbbeeba951aee7ec061f">KeWaitForSingleObject</a>(&amp;LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a8b6d5f4a9a64eacc7e2b61082374b139">Event</a>, <a class="code hl_enumvalue" href="../../d7/deb/xdk_2ketypes_8h.html#a32f8868bc010efa7da787526013b93fba52c5e5ff72e961e2e009b1259be78c14">UserRequest</a>, <a class="code hl_define" href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>);</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>    }</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>    {</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span>        <span class="comment">/* If we&#39;re already in a system process, call it right here */</span></div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>        LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a2d73c8dfafd1fd005cbbe9953d41ced6">SetEvent</a> = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>        <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ae3d61b4a88677a99c84cbbf2bd9c2872">IopLoadUnloadDriverWorker</a>(&amp;LoadParams);</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>    }</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span> </div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>    <span class="keywordflow">return</span> LoadParams.<a class="code hl_variable" href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0873879312b77cb4345ce0f7b6c3dd24">Status</a>;</div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>}</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span> </div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span><span class="comment">/*</span></div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span><span class="comment"> * NtLoadDriver</span></div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span><span class="comment"> *</span></div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span><span class="comment"> * Loads a device driver.</span></div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span><span class="comment"> *</span></div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span><span class="comment"> * Parameters</span></div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span><span class="comment"> *    DriverServiceName</span></div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span><span class="comment"> *       Name of the service to load (registry key).</span></div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span><span class="comment"> *</span></div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span><span class="comment"> * Return Value</span></div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span><span class="comment"> *    Status</span></div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span><span class="comment"> *</span></div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span><span class="comment"> * Status</span></div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span><span class="comment"> *    implemented</span></div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span><span class="comment"> */</span></div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"><a class="line" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ad08c0cab132fc9b2290745af9b353115"> 2133</a></span><a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ad08c0cab132fc9b2290745af9b353115">NtLoadDriver</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> DriverServiceName)</div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>{</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>    <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">UNICODE_STRING</a> CapturedServiceName = { 0, 0, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a> };</div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>    <a class="code hl_typedef" href="../../d7/deb/xdk_2ketypes_8h.html#a425eea3f57239dc3a8b77669eba3ca97">KPROCESSOR_MODE</a> <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>;</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>    <a class="code hl_struct" href="../../d6/d72/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>;</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>    <a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span> </div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span>    <a class="code hl_define" href="../../dc/d2f/Bus__PDO__QueryResourceRequirements_8c.html#a6bd166eae176f14d4174ba4931d5b80c">PAGED_CODE</a>();</div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span> </div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>    <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a> = <a class="code hl_define" href="../../d4/d3e/ndk_2arm_2ketypes_8h.html#a59359495801dfca8e1fbc3196348a0db">KeGetPreviousMode</a>();</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span> </div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>    <span class="comment">/* Need the appropriate priviliege */</span></div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../da/d6e/ntoskrnl_2se_2priv_8c.html#ab4a255ad2a1c77fa035c8f42ef4fcc5d">SeSinglePrivilegeCheck</a>(<a class="code hl_variable" href="../../d4/d92/ntoskrnl_2include_2internal_2se_8h.html#a88234f816d0abbbf629186b4041fbd2f">SeLoadDriverPrivilege</a>, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>))</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span>    {</div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>        <a class="code hl_define" href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a>(<span class="stringliteral">&quot;No load privilege!\n&quot;</span>);</div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../de/d19/DriverTester_8h.html#a62f33d4e46ad5b4ca3e889ded4c0f7a1">STATUS_PRIVILEGE_NOT_HELD</a>;</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>    }</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span> </div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>    <span class="comment">/* Capture the service name */</span></div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a354b39ea4abc3b4d09b2744b11ed9ac4">ProbeAndCaptureUnicodeString</a>(&amp;CapturedServiceName,</div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>                                          <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>,</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>                                          DriverServiceName);</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a>(<a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>))</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>    {</div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>        <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>    }</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span> </div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>    <a class="code hl_define" href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a>(<span class="stringliteral">&quot;NtLoadDriver(&#39;%wZ&#39;)\n&quot;</span>, &amp;CapturedServiceName);</div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span> </div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>    <span class="comment">/* We need a service name */</span></div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>    <span class="keywordflow">if</span> (CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">Length</a> == 0 || CapturedServiceName.<a class="code hl_variable" href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">Buffer</a> == <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>)</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span>    {</div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>        <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a>(&amp;CapturedServiceName, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>);</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="../../df/db3/udferr__usr_8h.html#a52c9a508482278e5a91348ba542df15f">STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span>    }</div>
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"> 2168</span> </div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>    <span class="comment">/* Load driver and call its entry point */</span></div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span>    <a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a> = <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a>;</div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span>    <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a> = <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#acee5e07a3e07721bb0b8f6b5f9ed27ca">IopDoLoadUnloadDriver</a>(&amp;CapturedServiceName, &amp;<a class="code hl_typedef" href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a>);</div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span> </div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>    <a class="code hl_function" href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a>(&amp;CapturedServiceName, <a class="code hl_variable" href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a>);</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>    <span class="keywordflow">return</span> <a class="code hl_enumeration" href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a>;</div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>}</div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span> </div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span><span class="comment">/*</span></div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span><span class="comment"> * NtUnloadDriver</span></div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span><span class="comment"> *</span></div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span><span class="comment"> * Unloads a legacy device driver.</span></div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span><span class="comment"> *</span></div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span><span class="comment"> * Parameters</span></div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span><span class="comment"> *    DriverServiceName</span></div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span><span class="comment"> *       Name of the service to unload (registry key).</span></div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span><span class="comment"> *</span></div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span><span class="comment"> * Return Value</span></div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span><span class="comment"> *    Status</span></div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span><span class="comment"> *</span></div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span><span class="comment"> * Status</span></div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span><span class="comment"> *    implemented</span></div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span><span class="comment"> */</span></div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span> </div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span><a class="code hl_typedef" href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a> <a class="code hl_define" href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"><a class="line" href="../../de/d19/DriverTester_8h.html#a2640bba768e6f99bdbea181a6b32b99f"> 2194</a></span><a class="code hl_function" href="../../de/d19/DriverTester_8h.html#a2640bba768e6f99bdbea181a6b32b99f">NtUnloadDriver</a>(<a class="code hl_define" href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code hl_struct" href="../../d9/d76/struct__UNICODE__STRING.html">PUNICODE_STRING</a> DriverServiceName)</div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span>{</div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4f9928a6c28075abfa3d31f2d3e65a59">IopUnloadDriver</a>(DriverServiceName, <a class="code hl_define" href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span>}</div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span> </div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span><span class="comment">/* EOF */</span></div>
<div class="ttc" id="aBus__PDO__QueryResourceRequirements_8c_html_a6bd166eae176f14d4174ba4931d5b80c"><div class="ttname"><a href="../../dc/d2f/Bus__PDO__QueryResourceRequirements_8c.html#a6bd166eae176f14d4174ba4931d5b80c">PAGED_CODE</a></div><div class="ttdeci">#define PAGED_CODE()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2f/Bus__PDO__QueryResourceRequirements_8c_source.html#l00089">Bus_PDO_QueryResourceRequirements.c:89</a></div></div>
<div class="ttc" id="aDriverTester_8h_html_a2640bba768e6f99bdbea181a6b32b99f"><div class="ttname"><a href="../../de/d19/DriverTester_8h.html#a2640bba768e6f99bdbea181a6b32b99f">NtUnloadDriver</a></div><div class="ttdeci">NTSTATUS NtUnloadDriver(IN PUNICODE_STRING DriverServiceName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l02194">driver.c:2194</a></div></div>
<div class="ttc" id="aDriverTester_8h_html_a62f33d4e46ad5b4ca3e889ded4c0f7a1"><div class="ttname"><a href="../../de/d19/DriverTester_8h.html#a62f33d4e46ad5b4ca3e889ded4c0f7a1">STATUS_PRIVILEGE_NOT_HELD</a></div><div class="ttdeci">#define STATUS_PRIVILEGE_NOT_HELD</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d19/DriverTester_8h_source.html#l00009">DriverTester.h:9</a></div></div>
<div class="ttc" id="aProcessorBind_8h_html_a241cb7969626e26a0961a75645528770"><div class="ttname"><a href="../../d0/d78/ProcessorBind_8h.html#a241cb7969626e26a0961a75645528770">BOOLEAN</a></div><div class="ttdeci">unsigned char BOOLEAN</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d78/ProcessorBind_8h_source.html#l00185">ProcessorBind.h:185</a></div></div>
<div class="ttc" id="aacpixf_8h_html_a5c2b3c3ddc922235571884771cdb0eac"><div class="ttname"><a href="../../d5/da8/acpixf_8h.html#a5c2b3c3ddc922235571884771cdb0eac">ModuleName</a></div><div class="ttdeci">ACPI_BUFFER *RetBuffer ACPI_BUFFER *RetBuffer char ACPI_WALK_RESOURCE_CALLBACK void *Context ACPI_BUFFER *RetBuffer UINT16 ACPI_RESOURCE **ResourcePtr ACPI_GENERIC_ADDRESS *Reg UINT32 *ReturnValue UINT8 UINT8 *Slp_TypB ACPI_PHYSICAL_ADDRESS PhysicalAddress64 UINT32 UINT32 *TimeElapsed UINT32 ACPI_STATUS const char UINT32 ACPI_STATUS const char UINT32 const char const char * ModuleName</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da8/acpixf_8h_source.html#l01280">acpixf.h:1280</a></div></div>
<div class="ttc" id="aarcname__tests_8c_html_a7820a5513c1236a41b6e2bd94d073868"><div class="ttname"><a href="../../d4/d42/arcname__tests_8c.html#a7820a5513c1236a41b6e2bd94d073868">OBJ_NAME_PATH_SEPARATOR</a></div><div class="ttdeci">#define OBJ_NAME_PATH_SEPARATOR</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d42/arcname__tests_8c_source.html#l00025">arcname_tests.c:25</a></div></div>
<div class="ttc" id="abase_2applications_2drwtsn32_2precomp_8h_html_a1b7a3ae6a8dcfbde0f16bfaffa13b024"><div class="ttname"><a href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h.html#a1b7a3ae6a8dcfbde0f16bfaffa13b024">NTSTATUS</a></div><div class="ttdeci">LONG NTSTATUS</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d6f/base_2applications_2drwtsn32_2precomp_8h_source.html#l00026">precomp.h:26</a></div></div>
<div class="ttc" id="abase_2applications_2regedit_2clb_2precomp_8h_html_ad68f9985d0ab1470c9738219d86e7d3d"><div class="ttname"><a href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h.html#ad68f9985d0ab1470c9738219d86e7d3d">DPRINT1</a></div><div class="ttdeci">#define DPRINT1</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d27/base_2applications_2regedit_2clb_2precomp_8h_source.html#l00008">precomp.h:8</a></div></div>
<div class="ttc" id="abase_2services_2browser_2browser_8c_html_a0559da1de5b25f2c6d9c658947692a92"><div class="ttname"><a href="../../dd/db0/base_2services_2browser_2browser_8c.html#a0559da1de5b25f2c6d9c658947692a92">ServiceName</a></div><div class="ttdeci">static WCHAR ServiceName[]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/db0/base_2services_2browser_2browser_8c_source.html#l00019">browser.c:19</a></div></div>
<div class="ttc" id="aclassBuffer_html"><div class="ttname"><a href="../../d0/d11/classBuffer.html">Buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d18/bufpool_8h_source.html#l00045">bufpool.h:45</a></div></div>
<div class="ttc" id="acmsysini_8c_html_ae5165e6c3f5650676e67ba301c1a90d8"><div class="ttname"><a href="../../df/d04/cmsysini_8c.html#ae5165e6c3f5650676e67ba301c1a90d8">CmGetSystemDriverList</a></div><div class="ttdeci">PUNICODE_STRING *NTAPI CmGetSystemDriverList(VOID)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d04/cmsysini_8c_source.html#l01721">cmsysini.c:1721</a></div></div>
<div class="ttc" id="acombotst_8c_html_a4a632a1997904dd335dc21a97d09101d"><div class="ttname"><a href="../../d6/d03/combotst_8c.html#a4a632a1997904dd335dc21a97d09101d">TextBuffer</a></div><div class="ttdeci">char TextBuffer[BUFFERLEN]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d03/combotst_8c_source.html#l00045">combotst.c:45</a></div></div>
<div class="ttc" id="aconnection_8cpp_html_ac5a73e4ec00f3dd0cfcac413fbdb0247"><div class="ttname"><a href="../../df/db6/connection_8cpp.html#ac5a73e4ec00f3dd0cfcac413fbdb0247">RtlCreateUnicodeString</a></div><div class="ttdeci">NTSYSAPI BOOLEAN NTAPI RtlCreateUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString)</div></div>
<div class="ttc" id="aconport_8c_html_af2fb0d1dfbf6e598eed9e4633a0693a0"><div class="ttname"><a href="../../d6/d79/conport_8c.html#af2fb0d1dfbf6e598eed9e4633a0693a0">ObjectAttributes</a></div><div class="ttdeci">IN PUNICODE_STRING IN POBJECT_ATTRIBUTES ObjectAttributes</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d79/conport_8c_source.html#l00036">conport.c:36</a></div></div>
<div class="ttc" id="acsq_8h_html_a28644ba4160d7ddafde9f17e91b75b1a"><div class="ttname"><a href="../../d1/dc0/csq_8h.html#a28644ba4160d7ddafde9f17e91b75b1a">Irp</a></div><div class="ttdeci">_In_ PIRP Irp</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dc0/csq_8h_source.html#l00116">csq.h:116</a></div></div>
<div class="ttc" id="adll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h_html_a1a05ede2ad100bf5de5dfa7ccdfa4397"><div class="ttname"><a href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a1a05ede2ad100bf5de5dfa7ccdfa4397">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h_source.html#l00112">types.h:112</a></div></div>
<div class="ttc" id="adll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h_html_a834713a9a17ec303f21e3dc4ecbe9161"><div class="ttname"><a href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#a834713a9a17ec303f21e3dc4ecbe9161">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h_source.html#l00120">types.h:120</a></div></div>
<div class="ttc" id="adll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/de8/dll_23rdparty_2libtirpc_2tirpc_2rpc_2types_8h_source.html#l00117">types.h:117</a></div></div>
<div class="ttc" id="adll_2appcompat_2apphelp_2apphelp_8c_html_a609000057869b9aca7fa3de296164bef"><div class="ttname"><a href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c.html#a609000057869b9aca7fa3de296164bef">NT_SUCCESS</a></div><div class="ttdeci">#define NT_SUCCESS(StatCode)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d25/dll_2appcompat_2apphelp_2apphelp_8c_source.html#l00032">apphelp.c:32</a></div></div>
<div class="ttc" id="adll_2win32_2dbghelp_2compat_8h_html_a4b00ec817c92b8d31e51af992a9fd5f1"><div class="ttname"><a href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h.html#a4b00ec817c92b8d31e51af992a9fd5f1">wcsrchr</a></div><div class="ttdeci">#define wcsrchr</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h_source.html#l00016">compat.h:16</a></div></div>
<div class="ttc" id="adll_2win32_2dbghelp_2compat_8h_html_a4f2397ef2cae63421c68e281d78a5089"><div class="ttname"><a href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h.html#a4f2397ef2cae63421c68e281d78a5089">RVA</a></div><div class="ttdeci">DWORD RVA</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h_source.html#l01262">compat.h:1262</a></div></div>
<div class="ttc" id="adll_2win32_2dbghelp_2compat_8h_html_ab7d451b8a146c9f5e65d15587a9d2c2a"><div class="ttname"><a href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h.html#ab7d451b8a146c9f5e65d15587a9d2c2a">RtlImageNtHeader</a></div><div class="ttdeci">#define RtlImageNtHeader</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db1/dll_2win32_2dbghelp_2compat_8h_source.html#l00806">compat.h:806</a></div></div>
<div class="ttc" id="adll_2win32_2rsaenh_2des_8c_html_a5e7a131b68a2b70172ead7110bc7eb37"><div class="ttname"><a href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#a5e7a131b68a2b70172ead7110bc7eb37">pc1</a></div><div class="ttdeci">static const unsigned char pc1[56]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dee/dll_2win32_2rsaenh_2des_8c_source.html#l00054">des.c:54</a></div></div>
<div class="ttc" id="adll_2win32_2rsaenh_2des_8c_html_acd3c1acca7ec1543e6244cf7d8fcc669"><div class="ttname"><a href="../../de/dee/dll_2win32_2rsaenh_2des_8c.html#acd3c1acca7ec1543e6244cf7d8fcc669">pc2</a></div><div class="ttdeci">static const unsigned char pc2[48]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dee/dll_2win32_2rsaenh_2des_8c_source.html#l00068">des.c:68</a></div></div>
<div class="ttc" id="adll_2win32_2setupapi_2interface_8c_html_ad67bebb4417022298668247311d200a0"><div class="ttname"><a href="../../d5/d94/dll_2win32_2setupapi_2interface_8c.html#ad67bebb4417022298668247311d200a0">DeviceInstance</a></div><div class="ttdeci">static const WCHAR DeviceInstance[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d94/dll_2win32_2setupapi_2interface_8c_source.html#l00028">interface.c:28</a></div></div>
<div class="ttc" id="adll_2win32_2wininet_2precomp_8h_html_ad87a7b915754dd9b23b4dee3787637e7"><div class="ttname"><a href="../../d2/df1/dll_2win32_2wininet_2precomp_8h.html#ad87a7b915754dd9b23b4dee3787637e7">swprintf</a></div><div class="ttdeci">#define swprintf</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/df1/dll_2win32_2wininet_2precomp_8h_source.html#l00040">precomp.h:40</a></div></div>
<div class="ttc" id="adll_2win32_2wintrust_2register_8c_html_a4085552a7101fb8810853766f8611544"><div class="ttname"><a href="../../da/d94/dll_2win32_2wintrust_2register_8c.html#a4085552a7101fb8810853766f8611544">Cleanup</a></div><div class="ttdeci">static const WCHAR Cleanup[]</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d94/dll_2win32_2wintrust_2register_8c_source.html#l00080">register.c:80</a></div></div>
<div class="ttc" id="adrivers_2network_2dd_2e1000_2debug_8h_html_a24bae9bc8db795c75682c03f038cf092"><div class="ttname"><a href="../../dc/d22/drivers_2network_2dd_2e1000_2debug_8h.html#a24bae9bc8db795c75682c03f038cf092">UNIMPLEMENTED_DBGBREAK</a></div><div class="ttdeci">#define UNIMPLEMENTED_DBGBREAK(...)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d22/drivers_2network_2dd_2e1000_2debug_8h_source.html#l00057">debug.h:57</a></div></div>
<div class="ttc" id="adriverspecs_8h_html_a7855d0a8318de9cfdfc99e7902e8e81e"><div class="ttname"><a href="../../d5/db6/driverspecs_8h.html#a7855d0a8318de9cfdfc99e7902e8e81e">__drv_allocatesMem</a></div><div class="ttdeci">#define __drv_allocatesMem(kind)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/db6/driverspecs_8h_source.html#l00257">driverspecs.h:257</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a14f3c1fe642e4927959b4beed2852e2a"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a14f3c1fe642e4927959b4beed2852e2a">InsertHeadList</a></div><div class="ttdeci">#define InsertHeadList(ListHead, Entry)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l01022">env_spec_w32.h:1022</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a1c7b1dae8a7686657a6bb974e61fb61e"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a1c7b1dae8a7686657a6bb974e61fb61e">ExAllocatePoolWithTag</a></div><div class="ttdeci">#define ExAllocatePoolWithTag(hernya, size, tag)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00350">env_spec_w32.h:350</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a34649dd83e77771e19b14cefe45ee25d"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a34649dd83e77771e19b14cefe45ee25d">KIRQL</a></div><div class="ttdeci">UCHAR KIRQL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00591">env_spec_w32.h:591</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a3b1cccdc66d3d057df043a9bed972270"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a3b1cccdc66d3d057df043a9bed972270">KSPIN_LOCK</a></div><div class="ttdeci">ULONG KSPIN_LOCK</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00072">env_spec_w32.h:72</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a4fc6529ce775df5fb3ceff4e7674db71"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a4fc6529ce775df5fb3ceff4e7674db71">MAXIMUM_FILENAME_LENGTH</a></div><div class="ttdeci">#define MAXIMUM_FILENAME_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00041">env_spec_w32.h:41</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a5a6535a15dfcdbbeeba951aee7ec061f"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a5a6535a15dfcdbbeeba951aee7ec061f">KeWaitForSingleObject</a></div><div class="ttdeci">#define KeWaitForSingleObject(pEvt, foo, a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00478">env_spec_w32.h:478</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a6a4d5c4f7bc48f54c81ec3fe1c03976b"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a6a4d5c4f7bc48f54c81ec3fe1c03976b">KeInitializeEvent</a></div><div class="ttdeci">#define KeInitializeEvent(pEvt, foo, foo2)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00477">env_spec_w32.h:477</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a7cdc4345afd9ecf2fa718b4c762bbf74"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a7cdc4345afd9ecf2fa718b4c762bbf74">RtlUpcaseUnicodeString</a></div><div class="ttdeci">NTSTATUS RtlUpcaseUnicodeString(PUNICODE_STRING dst, PUNICODE_STRING src, BOOLEAN Alloc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/string__lib_8cpp_source.html#l00046">string_lib.cpp:46</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a815006d5e3f6071e04e34d01419ffe9e"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a815006d5e3f6071e04e34d01419ffe9e">KeLowerIrql</a></div><div class="ttdeci">#define KeLowerIrql(oldIrql)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00602">env_spec_w32.h:602</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a832b89e2aa20339385183cfeb9cf9d9b"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a832b89e2aa20339385183cfeb9cf9d9b">RtlAppendUnicodeToString</a></div><div class="ttdeci">NTSTATUS RtlAppendUnicodeToString(IN PUNICODE_STRING Str1, IN PWSTR Str2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d51/string__lib_8cpp_source.html#l00062">string_lib.cpp:62</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_a860273a9f821b815b23d0d1ef49dce69"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#a860273a9f821b815b23d0d1ef49dce69">KeSetEvent</a></div><div class="ttdeci">#define KeSetEvent(pEvt, foo, foo2)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00476">env_spec_w32.h:476</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_aa58e2feeac77e25cc377dafd83c8d31d"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#aa58e2feeac77e25cc377dafd83c8d31d">ExFreePool</a></div><div class="ttdeci">#define ExFreePool(addr)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00352">env_spec_w32.h:352</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_abecf5c99139a6fd599cfa8801ff772d8"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#abecf5c99139a6fd599cfa8801ff772d8">ExAcquireResourceExclusiveLite</a></div><div class="ttdeci">#define ExAcquireResourceExclusiveLite(res, wait)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00615">env_spec_w32.h:615</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_acd82e852141613b1e5ef65cbe3add337"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#acd82e852141613b1e5ef65cbe3add337">NonPagedPool</a></div><div class="ttdeci">#define NonPagedPool</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00307">env_spec_w32.h:307</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_ace3f02f841a8f943fa9499f9f0e72d56"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#ace3f02f841a8f943fa9499f9f0e72d56">ERESOURCE</a></div><div class="ttdeci">ULONG ERESOURCE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00594">env_spec_w32.h:594</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_acec93a755836f578590339c921773e21"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#acec93a755836f578590339c921773e21">InitializeListHead</a></div><div class="ttdeci">#define InitializeListHead(ListHead)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00944">env_spec_w32.h:944</a></div></div>
<div class="ttc" id="aenv__spec__w32_8h_html_afbcdee3fcfe8ab23841832bb42a7f515"><div class="ttname"><a href="../../dd/df3/env__spec__w32_8h.html#afbcdee3fcfe8ab23841832bb42a7f515">PagedPool</a></div><div class="ttdeci">#define PagedPool</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00308">env_spec_w32.h:308</a></div></div>
<div class="ttc" id="aeventcreate_8c_html_a2a84ee9db787ac089de35348b3e1e3b4afdfbdf3247bd36a1f17270d5cec74c9c"><div class="ttname"><a href="../../d9/de6/eventcreate_8c.html#a2a84ee9db787ac089de35348b3e1e3b4afdfbdf3247bd36a1f17270d5cec74c9c">Success</a></div><div class="ttdeci">@ Success</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/de6/eventcreate_8c_source.html#l00712">eventcreate.c:712</a></div></div>
<div class="ttc" id="aex_8h_html_a3ff9102189bcbf0a250156b3c66a9f61"><div class="ttname"><a href="../../d0/d72/ex_8h.html#a3ff9102189bcbf0a250156b3c66a9f61">ExGetPreviousMode</a></div><div class="ttdeci">#define ExGetPreviousMode</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ex_8h_source.html#l00140">ex.h:140</a></div></div>
<div class="ttc" id="afilecomp_8c_html_ae4a7372767a090a7f593944a057378a3"><div class="ttname"><a href="../../d3/d3c/filecomp_8c.html#ae4a7372767a090a7f593944a057378a3">FileName</a></div><div class="ttdeci">struct _FileName FileName</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d51/fatprocs_8h_source.html#l00896">fatprocs.h:896</a></div></div>
<div class="ttc" id="afilesystems_2udfs_2Include_2CrossNt_2CrNtStubs_8h_html_a710a7cb48e2286133155069fcb7d1ba6"><div class="ttname"><a href="../../d9/dfa/filesystems_2udfs_2Include_2CrossNt_2CrNtStubs_8h.html#a710a7cb48e2286133155069fcb7d1ba6">KeRaiseIrqlToDpcLevel</a></div><div class="ttdeci">IN OUT PLONG IN OUT PLONG Addend IN OUT PLONG IN LONG IN OUT PLONG IN LONG Increment KeRaiseIrqlToDpcLevel</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/dfa/filesystems_2udfs_2Include_2CrossNt_2CrNtStubs_8h_source.html#l00068">CrNtStubs.h:68</a></div></div>
<div class="ttc" id="agdiplustypes_8h_html_aa3b0b4a677b164bc648aa5efaeb8639f"><div class="ttname"><a href="../../d5/def/gdiplustypes_8h.html#aa3b0b4a677b164bc648aa5efaeb8639f">Status</a></div><div class="ttdeci">Status</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/def/gdiplustypes_8h_source.html#l00024">gdiplustypes.h:25</a></div></div>
<div class="ttc" id="aglext_8h_html_a7efe1049f91e2c78098872da38facd4b"><div class="ttname"><a href="../../dc/dd2/glext_8h.html#a7efe1049f91e2c78098872da38facd4b">buf</a></div><div class="ttdeci">GLenum GLuint GLenum GLsizei const GLchar * buf</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/glext_8h_source.html#l07751">glext.h:7751</a></div></div>
<div class="ttc" id="aglext_8h_html_aa5367c14d90f462230c2611b81b41d23"><div class="ttname"><a href="../../dc/dd2/glext_8h.html#aa5367c14d90f462230c2611b81b41d23">p</a></div><div class="ttdeci">GLfloat GLfloat p</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/glext_8h_source.html#l08902">glext.h:8902</a></div></div>
<div class="ttc" id="aglext_8h_html_ab63d454b0ac4842ab53ff3ca9926436c"><div class="ttname"><a href="../../dc/dd2/glext_8h.html#ab63d454b0ac4842ab53ff3ca9926436c">num</a></div><div class="ttdeci">GLuint GLuint num</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dd2/glext_8h_source.html#l09618">glext.h:9618</a></div></div>
<div class="ttc" id="aglfuncs_8h_html_a123688ae4f304d38a0bedbf5439ebbae"><div class="ttname"><a href="../../d4/dd3/glfuncs_8h.html#a123688ae4f304d38a0bedbf5439ebbae">i</a></div><div class="ttdeci">GLsizei GLenum const GLvoid GLsizei GLenum GLbyte GLbyte GLbyte GLdouble GLdouble GLdouble GLfloat GLfloat GLfloat GLint GLint GLint GLshort GLshort GLshort GLubyte GLubyte GLubyte GLuint GLuint GLuint GLushort GLushort GLushort GLbyte GLbyte GLbyte GLbyte GLdouble GLdouble GLdouble GLdouble GLfloat GLfloat GLfloat GLfloat GLint GLint GLint GLint GLshort GLshort GLshort GLshort GLubyte GLubyte GLubyte GLubyte GLuint GLuint GLuint GLuint GLushort GLushort GLushort GLushort GLboolean const GLdouble const GLfloat const GLint const GLshort const GLbyte const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLdouble const GLfloat const GLfloat const GLint const GLint const GLshort const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort const GLdouble const GLfloat const GLint const GLshort GLenum GLenum GLenum GLfloat GLenum GLint GLenum GLenum GLenum GLfloat GLenum GLenum GLint GLenum GLfloat GLenum GLint GLint GLushort GLenum GLenum GLfloat GLenum GLenum GLint GLfloat const GLubyte GLenum GLenum GLenum const GLfloat GLenum GLenum const GLint GLenum GLint GLint GLsizei GLsizei GLint GLenum GLenum const GLvoid GLenum GLenum const GLfloat GLenum GLenum const GLint GLenum GLenum const GLdouble GLenum GLenum const GLfloat GLenum GLenum const GLint GLsizei GLuint GLfloat GLuint GLbitfield GLfloat GLint GLuint GLboolean GLenum GLfloat GLenum GLbitfield GLenum GLfloat GLfloat GLint GLint const GLfloat GLenum GLfloat GLfloat GLint GLint GLfloat GLfloat GLint GLint const GLfloat GLint GLfloat GLfloat GLint GLfloat GLfloat GLint GLfloat GLfloat const GLdouble const GLfloat const GLdouble const GLfloat GLint i</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dd3/glfuncs_8h_source.html#l00248">glfuncs.h:248</a></div></div>
<div class="ttc" id="ahal_2halarm_2include_2hal_8h_html_a9d1c3f4a4128b2f289d2b7e83a5da33b"><div class="ttname"><a href="../../d6/dda/hal_2halarm_2include_2hal_8h.html#a9d1c3f4a4128b2f289d2b7e83a5da33b">DbgPrint</a></div><div class="ttdeci">#define DbgPrint</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dda/hal_2halarm_2include_2hal_8h_source.html#l00012">hal.h:12</a></div></div>
<div class="ttc" id="ahidclass_8c_html_aa53148327f9f39530eb00e18f3d58141"><div class="ttname"><a href="../../d8/d5e/hidclass_8c.html#aa53148327f9f39530eb00e18f3d58141">ClientIdentificationAddress</a></div><div class="ttdeci">static LPWSTR ClientIdentificationAddress</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5e/hidclass_8c_source.html#l00016">hidclass.c:16</a></div></div>
<div class="ttc" id="aid__ata_8cpp_html_a07b40eba20737f52617534874c638bd1"><div class="ttname"><a href="../../d4/d40/id__ata_8cpp.html#a07b40eba20737f52617534874c638bd1">HalDisplayString</a></div><div class="ttdeci">NTHALAPI VOID NTAPI HalDisplayString(PUCHAR String)</div></div>
<div class="ttc" id="ainbv_8c_html_a568119eba8ef3c8bf7da01b11218176c"><div class="ttname"><a href="../../da/dac/inbv_8c.html#a568119eba8ef3c8bf7da01b11218176c">InbvIndicateProgress</a></div><div class="ttdeci">VOID NTAPI InbvIndicateProgress(VOID)</div><div class="ttdoc">Gives some progress feedback, without specifying any explicit number of progress steps or percentage....</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dac/inbv_8c_source.html#l00625">inbv.c:625</a></div></div>
<div class="ttc" id="ainclude_2crt_2wchar_8h_html_a8f651a8b8fa7440574ba4de80addcad6"><div class="ttname"><a href="../../d9/d58/include_2crt_2wchar_8h.html#a8f651a8b8fa7440574ba4de80addcad6">wcslen</a></div><div class="ttdeci">_CRTIMP size_t __cdecl wcslen(_In_z_ const wchar_t *_Str)</div></div>
<div class="ttc" id="ainclude_2psdk_2winternl_8h_html_a29c69e248fc19f729a5ad8b57bdcf1cf"><div class="ttname"><a href="../../de/d7d/include_2psdk_2winternl_8h.html#a29c69e248fc19f729a5ad8b57bdcf1cf">OBJ_KERNEL_HANDLE</a></div><div class="ttdeci">#define OBJ_KERNEL_HANDLE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/include_2psdk_2winternl_8h_source.html#l00231">winternl.h:231</a></div></div>
<div class="ttc" id="ainclude_2psdk_2winternl_8h_html_a5fb824737b82a44c9dcf0f07316602c4"><div class="ttname"><a href="../../de/d7d/include_2psdk_2winternl_8h.html#a5fb824737b82a44c9dcf0f07316602c4">OBJ_CASE_INSENSITIVE</a></div><div class="ttdeci">#define OBJ_CASE_INSENSITIVE</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/include_2psdk_2winternl_8h_source.html#l00228">winternl.h:228</a></div></div>
<div class="ttc" id="ainclude_2psdk_2winternl_8h_html_ae65366b3f012988240f2ed8ad14e1356"><div class="ttname"><a href="../../de/d7d/include_2psdk_2winternl_8h.html#ae65366b3f012988240f2ed8ad14e1356">OBJ_PERMANENT</a></div><div class="ttdeci">#define OBJ_PERMANENT</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d7d/include_2psdk_2winternl_8h_source.html#l00226">winternl.h:226</a></div></div>
<div class="ttc" id="ainclude_2reactos_2wine_2winternl_8h_html_a253bba9c575cd482f9b16ba67fd6cac7a6acd39f49a00a4f2150cfc1b4ccce33d"><div class="ttname"><a href="../../d6/d9e/include_2reactos_2wine_2winternl_8h.html#a253bba9c575cd482f9b16ba67fd6cac7a6acd39f49a00a4f2150cfc1b4ccce33d">KeyNameInformation</a></div><div class="ttdeci">@ KeyNameInformation</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d9e/include_2reactos_2wine_2winternl_8h_source.html#l00831">winternl.h:831</a></div></div>
<div class="ttc" id="ainclude_2reactos_2wine_2winternl_8h_html_a904c1e40a6ca2ce657f7c9286f435db4"><div class="ttname"><a href="../../d6/d9e/include_2reactos_2wine_2winternl_8h.html#a904c1e40a6ca2ce657f7c9286f435db4">RtlQueryRegistryValues</a></div><div class="ttdeci">NTSYSAPI NTSTATUS WINAPI RtlQueryRegistryValues(ULONG, PCWSTR, PRTL_QUERY_REGISTRY_TABLE, PVOID, PVOID)</div></div>
<div class="ttc" id="ainterfacevoid_html"><div class="ttname"><a href="../../d6/d37/interfacevoid.html">void</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d5b/nsiface_8idl_source.html#l02306">nsiface.idl:2307</a></div></div>
<div class="ttc" id="ainterlocked_8c_html_a6902ee6533d1070f2fa707e371a3bef3"><div class="ttname"><a href="../../da/dd8/interlocked_8c.html#a6902ee6533d1070f2fa707e371a3bef3">ExInterlockedInsertTailList</a></div><div class="ttdeci">PLIST_ENTRY NTAPI ExInterlockedInsertTailList(IN OUT PLIST_ENTRY ListHead, IN OUT PLIST_ENTRY ListEntry, IN OUT PKSPIN_LOCK Lock)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd8/interlocked_8c_source.html#l00140">interlocked.c:140</a></div></div>
<div class="ttc" id="ainterlocked_8c_html_af4c6d8697a92628801df34ab85a92a24"><div class="ttname"><a href="../../da/dd8/interlocked_8c.html#af4c6d8697a92628801df34ab85a92a24">ExInterlockedRemoveHeadList</a></div><div class="ttdeci">PLIST_ENTRY NTAPI ExInterlockedRemoveHeadList(IN OUT PLIST_ENTRY ListHead, IN OUT PKSPIN_LOCK Lock)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd8/interlocked_8c_source.html#l00166">interlocked.c:166</a></div></div>
<div class="ttc" id="aisapnp_8c_html_a3026b3abb11e0b864e969889a78ed1d4"><div class="ttname"><a href="../../d7/d23/isapnp_8c.html#a3026b3abb11e0b864e969889a78ed1d4">CODE_SEG</a></div><div class="ttdeci">static CODE_SEG(&quot;PAGE&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d23/isapnp_8c_source.html#l01482">isapnp.c:1482</a></div></div>
<div class="ttc" id="ake__x_8h_html_a7329c257124ce1b4506e5fa6fbd58866"><div class="ttname"><a href="../../de/d90/ke__x_8h.html#a7329c257124ce1b4506e5fa6fbd58866">KeLeaveCriticalRegion</a></div><div class="ttdeci">#define KeLeaveCriticalRegion()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d90/ke__x_8h_source.html#l00119">ke_x.h:119</a></div></div>
<div class="ttc" id="ake__x_8h_html_abc110da33e985432712b6f113a9958a5"><div class="ttname"><a href="../../de/d90/ke__x_8h.html#abc110da33e985432712b6f113a9958a5">KeEnterCriticalRegion</a></div><div class="ttdeci">#define KeEnterCriticalRegion()</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d90/ke__x_8h_source.html#l00088">ke_x.h:88</a></div></div>
<div class="ttc" id="akrnlinit_8c_html_a560229594ee147b02b22e331c3f9ad03"><div class="ttname"><a href="../../d3/df7/krnlinit_8c.html#a560229594ee147b02b22e331c3f9ad03">KeLoaderBlock</a></div><div class="ttdeci">PLOADER_PARAMETER_BLOCK KeLoaderBlock</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/df7/krnlinit_8c_source.html#l00029">krnlinit.c:29</a></div></div>
<div class="ttc" id="alayer_8c_html_ae7c552d6e252741d01dbb89c2ac7e69d"><div class="ttname"><a href="../../dd/dad/layer_8c.html#ae7c552d6e252741d01dbb89c2ac7e69d">REG_SZ</a></div><div class="ttdeci">#define REG_SZ</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dad/layer_8c_source.html#l00022">layer.c:22</a></div></div>
<div class="ttc" id="aldr_8h_html_a964bc036dd01080400547c81b212f938"><div class="ttname"><a href="../../df/def/ldr_8h.html#a964bc036dd01080400547c81b212f938">DRIVER_ROOT_NAME</a></div><div class="ttdeci">#define DRIVER_ROOT_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../df/def/ldr_8h_source.html#l00005">ldr.h:5</a></div></div>
<div class="ttc" id="aldr_8h_html_ab519b402883bc7aec80dffde6b67cbf7"><div class="ttname"><a href="../../df/def/ldr_8h.html#ab519b402883bc7aec80dffde6b67cbf7">FILESYSTEM_ROOT_NAME</a></div><div class="ttdeci">#define FILESYSTEM_ROOT_NAME</div><div class="ttdef"><b>Definition:</b> <a href="../../df/def/ldr_8h_source.html#l00006">ldr.h:6</a></div></div>
<div class="ttc" id="aldrtypes_8h_html_a0876c70189a079288c4b8161e681afaf"><div class="ttname"><a href="../../d1/d97/ldrtypes_8h.html#a0876c70189a079288c4b8161e681afaf">Parameter</a></div><div class="ttdeci">_In_ PVOID Parameter</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/ldrtypes_8h_source.html#l00241">ldrtypes.h:241</a></div></div>
<div class="ttc" id="aldrtypes_8h_html_a2d6daf18dd920c9fafef774705002749"><div class="ttname"><a href="../../d1/d97/ldrtypes_8h.html#a2d6daf18dd920c9fafef774705002749">LDRP_DRIVER_DEPENDENT_DLL</a></div><div class="ttdeci">#define LDRP_DRIVER_DEPENDENT_DLL</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/ldrtypes_8h_source.html#l00056">ldrtypes.h:56</a></div></div>
<div class="ttc" id="amiarm_8h_html"><div class="ttname"><a href="../../d5/da2/miarm_8h.html">miarm.h</a></div></div>
<div class="ttc" id="amiarm_8h_html_a97dfb9cc4a34821e2abe23084fa1a13e"><div class="ttname"><a href="../../d5/da2/miarm_8h.html#a97dfb9cc4a34821e2abe23084fa1a13e">MM_SYSLDR_NO_IMPORTS</a></div><div class="ttdeci">#define MM_SYSLDR_NO_IMPORTS</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/da2/miarm_8h_source.html#l00200">miarm.h:200</a></div></div>
<div class="ttc" id="amode_8c_html_a5d5f62b566bd3a77d449fccb7b1a9656"><div class="ttname"><a href="../../d9/d01/mode_8c.html#a5d5f62b566bd3a77d449fccb7b1a9656">ASSERT</a></div><div class="ttdeci">#define ASSERT(a)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d01/mode_8c_source.html#l00044">mode.c:44</a></div></div>
<div class="ttc" id="amodule_8h_html_ae2a7a6bef05b2285ad62ed3a61c14f6e"><div class="ttname"><a href="../../d5/d16/module_8h.html#ae2a7a6bef05b2285ad62ed3a61c14f6e">ExFreePoolWithTag</a></div><div class="ttdeci">#define ExFreePoolWithTag(_P, _T)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d16/module_8h_source.html#l01109">module.h:1109</a></div></div>
<div class="ttc" id="amodules_2rostests_2winetests_2ntdll_2reg_8c_html_a327a7264f49955a340d1b07a90e1c62e"><div class="ttname"><a href="../../de/d63/modules_2rostests_2winetests_2ntdll_2reg_8c.html#a327a7264f49955a340d1b07a90e1c62e">InitializeObjectAttributes</a></div><div class="ttdeci">#define InitializeObjectAttributes(p, n, a, r, s)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d63/modules_2rostests_2winetests_2ntdll_2reg_8c_source.html#l00106">reg.c:106</a></div></div>
<div class="ttc" id="ams__sal_8h_html_a0cee083d022d10fcad4840d6debdedb8"><div class="ttname"><a href="../../de/d8c/ms__sal_8h.html#a0cee083d022d10fcad4840d6debdedb8">_Out_opt_</a></div><div class="ttdeci">#define _Out_opt_</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d8c/ms__sal_8h_source.html#l00346">ms_sal.h:346</a></div></div>
<div class="ttc" id="ams__sal_8h_html_a198d136b8176ee5824b09c7bd8b7beb0"><div class="ttname"><a href="../../de/d8c/ms__sal_8h.html#a198d136b8176ee5824b09c7bd8b7beb0">_Inout_</a></div><div class="ttdeci">#define _Inout_</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d8c/ms__sal_8h_source.html#l00378">ms_sal.h:378</a></div></div>
<div class="ttc" id="ams__sal_8h_html_a1a312a888a8d2b90592cc619a0571d92"><div class="ttname"><a href="../../de/d8c/ms__sal_8h.html#a1a312a888a8d2b90592cc619a0571d92">_Post_notnull_</a></div><div class="ttdeci">#define _Post_notnull_</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d8c/ms__sal_8h_source.html#l00701">ms_sal.h:701</a></div></div>
<div class="ttc" id="ams__sal_8h_html_a96941fe6cafa15069eddc5dccce6b320"><div class="ttname"><a href="../../de/d8c/ms__sal_8h.html#a96941fe6cafa15069eddc5dccce6b320">_At_</a></div><div class="ttdeci">#define _At_(target, annos)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d8c/ms__sal_8h_source.html#l00244">ms_sal.h:244</a></div></div>
<div class="ttc" id="ams__sal_8h_html_a9c50bd6a6ca6e0be76a0f3a79379b90e"><div class="ttname"><a href="../../de/d8c/ms__sal_8h.html#a9c50bd6a6ca6e0be76a0f3a79379b90e">_Out_</a></div><div class="ttdeci">#define _Out_</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d8c/ms__sal_8h_source.html#l00345">ms_sal.h:345</a></div></div>
<div class="ttc" id="ams__sal_8h_html_a9fb26ab9367e31c510733b0958e5b073"><div class="ttname"><a href="../../de/d8c/ms__sal_8h.html#a9fb26ab9367e31c510733b0958e5b073">_When_</a></div><div class="ttdeci">#define _When_(expr, annos)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d8c/ms__sal_8h_source.html#l00254">ms_sal.h:254</a></div></div>
<div class="ttc" id="ams__sal_8h_html_aa74f89aa7d942f4a79ea12d7c9b763ef"><div class="ttname"><a href="../../de/d8c/ms__sal_8h.html#aa74f89aa7d942f4a79ea12d7c9b763ef">_In_</a></div><div class="ttdeci">#define _In_</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d8c/ms__sal_8h_source.html#l00308">ms_sal.h:308</a></div></div>
<div class="ttc" id="ams__sal_8h_html_ab1211e050847ff847e95d7a9e20d9654"><div class="ttname"><a href="../../de/d8c/ms__sal_8h.html#ab1211e050847ff847e95d7a9e20d9654">_In_opt_</a></div><div class="ttdeci">#define _In_opt_</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d8c/ms__sal_8h_source.html#l00309">ms_sal.h:309</a></div></div>
<div class="ttc" id="andis_8h_html_ae58477bab924c4413afd3a1405993ee5"><div class="ttname"><a href="../../d9/d16/ndis_8h.html#ae58477bab924c4413afd3a1405993ee5">KeyHandle</a></div><div class="ttdeci">_Must_inspect_result_ _Out_ PNDIS_STATUS _In_ NDIS_HANDLE _In_ ULONG _Out_ PNDIS_STRING _Out_ PNDIS_HANDLE KeyHandle</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d16/ndis_8h_source.html#l04715">ndis.h:4715</a></div></div>
<div class="ttc" id="andk_2amd64_2asm_8h_html_a0fd3e87d5eca834eebbaaf126895ec50"><div class="ttname"><a href="../../da/dd4/ndk_2amd64_2asm_8h.html#a0fd3e87d5eca834eebbaaf126895ec50">KernelMode</a></div><div class="ttdeci">#define KernelMode</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dd4/ndk_2amd64_2asm_8h_source.html#l00034">asm.h:34</a></div></div>
<div class="ttc" id="andk_2arm_2ketypes_8h_html_a59359495801dfca8e1fbc3196348a0db"><div class="ttname"><a href="../../d4/d3e/ndk_2arm_2ketypes_8h.html#a59359495801dfca8e1fbc3196348a0db">KeGetPreviousMode</a></div><div class="ttdeci">#define KeGetPreviousMode()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d3e/ndk_2arm_2ketypes_8h_source.html#l01110">ketypes.h:1110</a></div></div>
<div class="ttc" id="andk_2iotypes_8h_html_ad4bbef1db9f40e2e3b69d610203d89a6"><div class="ttname"><a href="../../d6/d0e/ndk_2iotypes_8h.html#ad4bbef1db9f40e2e3b69d610203d89a6">DOE_UNLOAD_PENDING</a></div><div class="ttdeci">#define DOE_UNLOAD_PENDING</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0e/ndk_2iotypes_8h_source.html#l00149">iotypes.h:149</a></div></div>
<div class="ttc" id="andk_2mmfuncs_8h_html_a931581205a5330fc8f83c9e7124e06f6"><div class="ttname"><a href="../../d8/d6b/ndk_2mmfuncs_8h.html#a931581205a5330fc8f83c9e7124e06f6">BaseAddress</a></div><div class="ttdeci">_In_ HANDLE _Outptr_result_bytebuffer_ ViewSize PVOID * BaseAddress</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d6b/ndk_2mmfuncs_8h_source.html#l00404">mmfuncs.h:404</a></div></div>
<div class="ttc" id="andk_2obfuncs_8h_html_a5e0a128a3b03af9e6deef339000e30e0"><div class="ttname"><a href="../../de/df6/ndk_2obfuncs_8h.html#a5e0a128a3b03af9e6deef339000e30e0">ZwClose</a></div><div class="ttdeci">NTSYSAPI NTSTATUS NTAPI ZwClose(_In_ HANDLE Handle)</div></div>
<div class="ttc" id="andk_2rtlfuncs_8h_html_a0e6448edc6c4fd133baecebd58966664"><div class="ttname"><a href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a0e6448edc6c4fd133baecebd58966664">String2</a></div><div class="ttdeci">_In_ const STRING * String2</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd5/ndk_2rtlfuncs_8h_source.html#l02357">rtlfuncs.h:2357</a></div></div>
<div class="ttc" id="andk_2rtlfuncs_8h_html_a408fd7b7ff70f01bc61a6e9a47bb7f51"><div class="ttname"><a href="../../d8/dd5/ndk_2rtlfuncs_8h.html#a408fd7b7ff70f01bc61a6e9a47bb7f51">QueryTable</a></div><div class="ttdeci">_In_ PCWSTR _Inout_ _At_ QueryTable _Pre_unknown_ PRTL_QUERY_REGISTRY_TABLE QueryTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dd5/ndk_2rtlfuncs_8h_source.html#l04209">rtlfuncs.h:4209</a></div></div>
<div class="ttc" id="ane2000_8h_html_abd3e3ec64bcbfe51338191056e0e7924"><div class="ttname"><a href="../../d5/d0a/ne2000_8h.html#abd3e3ec64bcbfe51338191056e0e7924">DriverInfo</a></div><div class="ttdeci">DRIVER_INFORMATION DriverInfo</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/ddc/drivers_2network_2dd_2ne2000_2ne2000_2main_8c_source.html#l00059">main.c:59</a></div></div>
<div class="ttc" id="ant__native_8h_html_a0050303384bee38cd30898b2c12dae71"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a0050303384bee38cd30898b2c12dae71">RtlCopyUnicodeString</a></div><div class="ttdeci">NTSYSAPI VOID NTAPI RtlCopyUnicodeString(PUNICODE_STRING DestinationString, PUNICODE_STRING SourceString)</div></div>
<div class="ttc" id="ant__native_8h_html_a253bba9c575cd482f9b16ba67fd6cac7aa95e628590fe86fd05c0da2be52c9535"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a253bba9c575cd482f9b16ba67fd6cac7aa95e628590fe86fd05c0da2be52c9535">KeyBasicInformation</a></div><div class="ttdeci">@ KeyBasicInformation</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01131">nt_native.h:1131</a></div></div>
<div class="ttc" id="ant__native_8h_html_a2f899eca0dc42731afb043b6aacb0bd5"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a2f899eca0dc42731afb043b6aacb0bd5">FILE_READ_DATA</a></div><div class="ttdeci">#define FILE_READ_DATA</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l00628">nt_native.h:628</a></div></div>
<div class="ttc" id="ant__native_8h_html_a39e62609550e6c4ab06fb4968d08efef"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a39e62609550e6c4ab06fb4968d08efef">RtlAppendUnicodeStringToString</a></div><div class="ttdeci">NTSYSAPI NTSTATUS NTAPI RtlAppendUnicodeStringToString(PUNICODE_STRING Destination, PUNICODE_STRING Source)</div></div>
<div class="ttc" id="ant__native_8h_html_a4ba1e0505cff2982015419c9004954d4"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a4ba1e0505cff2982015419c9004954d4">KEY_READ</a></div><div class="ttdeci">#define KEY_READ</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01023">nt_native.h:1023</a></div></div>
<div class="ttc" id="ant__native_8h_html_a5e6d7af51cb6d106401f3967b6b44b12"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a5e6d7af51cb6d106401f3967b6b44b12">RtlInitUnicodeString</a></div><div class="ttdeci">NTSYSAPI VOID NTAPI RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString)</div></div>
<div class="ttc" id="ant__native_8h_html_a651271c57d5fbbba1df1936b1e0a2a66"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a651271c57d5fbbba1df1936b1e0a2a66">RtlEqualUnicodeString</a></div><div class="ttdeci">NTSYSAPI BOOLEAN NTAPI RtlEqualUnicodeString(PUNICODE_STRING String1, PUNICODE_STRING String2, BOOLEAN CaseInSensitive)</div></div>
<div class="ttc" id="ant__native_8h_html_a6604a8babb329baba07e91693c3335f1"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a6604a8babb329baba07e91693c3335f1">RTL_REGISTRY_ABSOLUTE</a></div><div class="ttdeci">#define RTL_REGISTRY_ABSOLUTE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l00161">nt_native.h:161</a></div></div>
<div class="ttc" id="ant__native_8h_html_a6f671bc94a3e87fcef3b36ec87d34bff"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a6f671bc94a3e87fcef3b36ec87d34bff">FASTCALL</a></div><div class="ttdeci">#define FASTCALL</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l00050">nt_native.h:50</a></div></div>
<div class="ttc" id="ant__native_8h_html_a988a60bc626d7b297d869d8c9b03ab41"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#a988a60bc626d7b297d869d8c9b03ab41">RTL_QUERY_REGISTRY_DIRECT</a></div><div class="ttdeci">#define RTL_QUERY_REGISTRY_DIRECT</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l00144">nt_native.h:144</a></div></div>
<div class="ttc" id="ant__native_8h_html_abe972030403da31994eecb16d6f7d1b9"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#abe972030403da31994eecb16d6f7d1b9">RtlFreeUnicodeString</a></div><div class="ttdeci">NTSYSAPI VOID NTAPI RtlFreeUnicodeString(PUNICODE_STRING UnicodeString)</div></div>
<div class="ttc" id="ant__native_8h_html_ae7d8a09478b0795189f15f9b2686a431"><div class="ttname"><a href="../../db/dc9/nt__native_8h.html#ae7d8a09478b0795189f15f9b2686a431">REG_EXPAND_SZ</a></div><div class="ttdeci">#define REG_EXPAND_SZ</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01494">nt_native.h:1494</a></div></div>
<div class="ttc" id="antbasedef_8h_html_a86ba064762d3800e79a3f1304bbb5eef"><div class="ttname"><a href="../../d6/d6e/ntbasedef_8h.html#a86ba064762d3800e79a3f1304bbb5eef">UNICODE_NULL</a></div><div class="ttdeci">#define UNICODE_NULL</div></div>
<div class="ttc" id="antddpcm_8h_html_a82f4bcb08cf0e8b5f5226d189208a696"><div class="ttname"><a href="../../d3/d2b/ntddpcm_8h.html#a82f4bcb08cf0e8b5f5226d189208a696">Length</a></div><div class="ttdeci">_In_ ULONG _In_ ULONG _In_ ULONG Length</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2b/ntddpcm_8h_source.html#l00102">ntddpcm.h:102</a></div></div>
<div class="ttc" id="antdef_8template_8h_html_a4fd8d54f196d53e4f9494e1874200d9ca0f0a3001be54605ffe444d2c19466d81"><div class="ttname"><a href="../../db/dd9/ntdef_8template_8h.html#a4fd8d54f196d53e4f9494e1874200d9ca0f0a3001be54605ffe444d2c19466d81">NotificationEvent</a></div><div class="ttdeci">@ NotificationEvent</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd9/ntdef_8template_8h_source.html#l00356">ntdef.template.h:356</a></div></div>
<div class="ttc" id="antimage_8h_html_a38fb8f1d8f545c0f2880a49cd1b2caf5"><div class="ttname"><a href="../../d5/d44/ntimage_8h.html#a38fb8f1d8f545c0f2880a49cd1b2caf5">IMAGE_DLLCHARACTERISTICS_WDM_DRIVER</a></div><div class="ttdeci">#define IMAGE_DLLCHARACTERISTICS_WDM_DRIVER</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d44/ntimage_8h_source.html#l00462">ntimage.h:462</a></div></div>
<div class="ttc" id="antoskrnl_2ex_2resource_8c_html_a61a69c738c2d9730a6a91a58b358cf3b"><div class="ttname"><a href="../../de/dbf/ntoskrnl_2ex_2resource_8c.html#a61a69c738c2d9730a6a91a58b358cf3b">ExReleaseResourceLite</a></div><div class="ttdeci">VOID FASTCALL ExReleaseResourceLite(IN PERESOURCE Resource)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dbf/ntoskrnl_2ex_2resource_8c_source.html#l01822">resource.c:1822</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2amd64_2ke_8h_html_abef0d79fb75e1e90b50d8033abe0a27d"><div class="ttname"><a href="../../dd/dc9/ntoskrnl_2include_2internal_2amd64_2ke_8h.html#abef0d79fb75e1e90b50d8033abe0a27d">KeTickCount</a></div><div class="ttdeci">NTKERNELAPI volatile KSYSTEM_TIME KeTickCount</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/db9/ntoskrnl_2ke_2clock_8c_source.html#l00019">clock.c:19</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a01f4b50eabb9378327c4e6893b8b4300"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a01f4b50eabb9378327c4e6893b8b4300">IopOpenRegistryKeyEx</a></div><div class="ttdeci">NTSTATUS NTAPI IopOpenRegistryKeyEx(PHANDLE KeyHandle, HANDLE ParentKey, PUNICODE_STRING Name, ACCESS_MASK DesiredAccess)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d12/pnpmgr_8c_source.html#l00885">pnpmgr.c:885</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a0dd8d2221f01bb5553522914091e7522"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a0dd8d2221f01bb5553522914091e7522">RawFsDriverEntry</a></div><div class="ttdeci">NTSTATUS NTAPI RawFsDriverEntry(IN PDRIVER_OBJECT DriverObject, IN PUNICODE_STRING RegistryPath)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/ddd/rawfs_8c_source.html#l01193">rawfs.c:1193</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a11ed42bf95c6c3488946cdd008d1bb5da47eeb1850d5bab45c1099d673e78a082"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a11ed42bf95c6c3488946cdd008d1bb5da47eeb1850d5bab45c1099d673e78a082">PiActionAddBootDevices</a></div><div class="ttdeci">@ PiActionAddBootDevices</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00529">io.h:529</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a11ed42bf95c6c3488946cdd008d1bb5da85400f67cedf1285b9b68d9190fbb231"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a11ed42bf95c6c3488946cdd008d1bb5da85400f67cedf1285b9b68d9190fbb231">PiActionEnumRootDevices</a></div><div class="ttdeci">@ PiActionEnumRootDevices</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00527">io.h:527</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a11ed42bf95c6c3488946cdd008d1bb5dac3099ebd61d3f888786371a76c3effbf"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a11ed42bf95c6c3488946cdd008d1bb5dac3099ebd61d3f888786371a76c3effbf">PiActionEnumDeviceTree</a></div><div class="ttdeci">@ PiActionEnumDeviceTree</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00526">io.h:526</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a2df29150566a07af377b4e725e55af02"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a2df29150566a07af377b4e725e55af02">PpInitGetGroupOrderIndex</a></div><div class="ttdeci">USHORT NTAPI PpInitGetGroupOrderIndex(IN HANDLE ServiceHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc1/pnpinit_8c_source.html#l00149">pnpinit.c:149</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a6a0a117e522e4be01bfc2ce04688b463"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a6a0a117e522e4be01bfc2ce04688b463">PipGetDriverTagPriority</a></div><div class="ttdeci">USHORT NTAPI PipGetDriverTagPriority(IN HANDLE ServiceHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc1/pnpinit_8c_source.html#l00192">pnpinit.c:192</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a81d50dfa1cd5946c225a6db89dc11df4"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81d50dfa1cd5946c225a6db89dc11df4">IopGetRegistryValue</a></div><div class="ttdeci">NTSTATUS NTAPI IopGetRegistryValue(IN HANDLE Handle, IN PWSTR ValueName, OUT PKEY_VALUE_FULL_INFORMATION *Information)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d12/pnpmgr_8c_source.html#l01036">pnpmgr.c:1036</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_a81f61f779d7dd41614cd190dc653c44b"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#a81f61f779d7dd41614cd190dc653c44b">IoGetDrvObjExtension</a></div><div class="ttdeci">#define IoGetDrvObjExtension(DriverObject)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00136">io.h:136</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_adc16be901fc9fe68da1f7ddf30e7c2d7"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#adc16be901fc9fe68da1f7ddf30e7c2d7">PiQueueDeviceAction</a></div><div class="ttdeci">VOID PiQueueDeviceAction(_In_ PDEVICE_OBJECT DeviceObject, _In_ DEVICE_ACTION Action, _In_opt_ PKEVENT CompletionEvent, _Out_opt_ NTSTATUS *CompletionStatus)</div><div class="ttdoc">Queue a device operation to a worker thread.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d01/devaction_8c_source.html#l02655">devaction.c:2655</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_ae37eeb0422b9790743c16ac4d1f11aef"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#ae37eeb0422b9790743c16ac4d1f11aef">IopRootDeviceNode</a></div><div class="ttdeci">PDEVICE_NODE IopRootDeviceNode</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d14/devnode_8c_source.html#l00018">devnode.c:18</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_aef12f707ee359865fc99d25c7b3b3f97"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#aef12f707ee359865fc99d25c7b3b3f97">PiPerformSyncDeviceAction</a></div><div class="ttdeci">NTSTATUS PiPerformSyncDeviceAction(_In_ PDEVICE_OBJECT DeviceObject, _In_ DEVICE_ACTION Action)</div><div class="ttdoc">Perfom a device operation synchronously via PiQueueDeviceAction.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d01/devaction_8c_source.html#l02714">devaction.c:2714</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_af2bbe27f75828905de206d5205684eb8"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#af2bbe27f75828905de206d5205684eb8">IopReadyDeviceObjects</a></div><div class="ttdeci">VOID NTAPI IopReadyDeviceObjects(IN PDRIVER_OBJECT Driver)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d5b/ntoskrnl_2io_2iomgr_2device_8c_source.html#l00034">device.c:34</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2io_8h_html_afd969d4fefb00d6a25e6f453e27ca3f1"><div class="ttname"><a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h.html#afd969d4fefb00d6a25e6f453e27ca3f1">IoGetDevObjExtension</a></div><div class="ttdeci">#define IoGetDevObjExtension(DeviceObject)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00129">io.h:129</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2mm_8h_html_a21f6d9eda6b929c322a7f1800eed3b1f"><div class="ttname"><a href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a21f6d9eda6b929c322a7f1800eed3b1f">MmLoadSystemImage</a></div><div class="ttdeci">NTSTATUS NTAPI MmLoadSystemImage(IN PUNICODE_STRING FileName, IN PUNICODE_STRING NamePrefix OPTIONAL, IN PUNICODE_STRING LoadedName OPTIONAL, IN ULONG Flags, OUT PVOID *ModuleObject, OUT PVOID *ImageBaseAddress)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d67/sysldr_8c_source.html#l02935">sysldr.c:2935</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2mm_8h_html_a564ac4ba44b4604485870689db6bb725"><div class="ttname"><a href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a564ac4ba44b4604485870689db6bb725">MmFreeDriverInitialization</a></div><div class="ttdeci">VOID NTAPI MmFreeDriverInitialization(IN PLDR_DATA_TABLE_ENTRY LdrEntry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d67/sysldr_8c_source.html#l01672">sysldr.c:1672</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2mm_8h_html_a7fba743375036dac487f7ea2086903f3"><div class="ttname"><a href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a7fba743375036dac487f7ea2086903f3">MmCallDllInitialize</a></div><div class="ttdeci">NTSTATUS NTAPI MmCallDllInitialize(_In_ PLDR_DATA_TABLE_ENTRY LdrEntry, _In_ PLIST_ENTRY ModuleListHead)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d67/sysldr_8c_source.html#l00432">sysldr.c:432</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2mm_8h_html_a8a7939b3703b2a698eb129a2d7aa6b81"><div class="ttname"><a href="../../db/de3/ntoskrnl_2include_2internal_2mm_8h.html#a8a7939b3703b2a698eb129a2d7aa6b81">MmUnloadSystemImage</a></div><div class="ttdeci">NTSTATUS NTAPI MmUnloadSystemImage(IN PVOID ImageHandle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d67/sysldr_8c_source.html#l00944">sysldr.c:944</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2rtl_8h_html_a1821685c69fd3c9881bd4258a135ec59"><div class="ttname"><a href="../../df/d26/ntoskrnl_2include_2internal_2rtl_8h.html#a1821685c69fd3c9881bd4258a135ec59">RTL_FIND_CHAR_IN_UNICODE_STRING_START_AT_END</a></div><div class="ttdeci">#define RTL_FIND_CHAR_IN_UNICODE_STRING_START_AT_END</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d26/ntoskrnl_2include_2internal_2rtl_8h_source.html#l00025">rtl.h:25</a></div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2rtl_8h_html_a78b7b2b4d693be0ce2aa0b208aca4dc4"><div class="ttname"><a href="../../df/d26/ntoskrnl_2include_2internal_2rtl_8h.html#a78b7b2b4d693be0ce2aa0b208aca4dc4">RtlFindCharInUnicodeString</a></div><div class="ttdeci">NTSTATUS NTAPI RtlFindCharInUnicodeString(_In_ ULONG Flags, _In_ PCUNICODE_STRING SearchString, _In_ PCUNICODE_STRING MatchString, _Out_ PUSHORT Position)</div></div>
<div class="ttc" id="antoskrnl_2include_2internal_2se_8h_html_a88234f816d0abbbf629186b4041fbd2f"><div class="ttname"><a href="../../d4/d92/ntoskrnl_2include_2internal_2se_8h.html#a88234f816d0abbbf629186b4041fbd2f">SeLoadDriverPrivilege</a></div><div class="ttdeci">const LUID SeLoadDriverPrivilege</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d6e/ntoskrnl_2se_2priv_8c_source.html#l00029">priv.c:29</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a023fc8a7d57b06273584cc58d8825bab"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a023fc8a7d57b06273584cc58d8825bab">DriverReinitListHead</a></div><div class="ttdeci">LIST_ENTRY DriverReinitListHead</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00022">driver.c:22</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a07d4f3f30eddaf5464462159ffb30e2a"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a07d4f3f30eddaf5464462159ffb30e2a">LOAD_UNLOAD_PARAMS</a></div><div class="ttdeci">struct _LOAD_UNLOAD_PARAMS LOAD_UNLOAD_PARAMS</div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a089710c43d7e59e34be0f1781ffc8806"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a089710c43d7e59e34be0f1781ffc8806">IoDriverObjectType</a></div><div class="ttdeci">POBJECT_TYPE IoDriverObjectType</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00034">driver.c:34</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a0e5843cbc444a70cc5aac2359278023c"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a0e5843cbc444a70cc5aac2359278023c">IopReinitializeBootDrivers</a></div><div class="ttdeci">VOID NTAPI IopReinitializeBootDrivers(VOID)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01518">driver.c:1518</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a16bb1bd87bf3b75b1c7d117258e8cc4b"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a16bb1bd87bf3b75b1c7d117258e8cc4b">IopGetDeviceObjectFromDeviceInstance</a></div><div class="ttdeci">PDEVICE_OBJECT IopGetDeviceObjectFromDeviceInstance(PUNICODE_STRING DeviceInstance)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d89/plugplay_8c_source.html#l00121">plugplay.c:121</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a1b5a2c0ea74ed8b816eef35731cb268e"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a1b5a2c0ea74ed8b816eef35731cb268e">IopLoadDriver</a></div><div class="ttdeci">NTSTATUS IopLoadDriver(_In_ HANDLE ServiceHandle, _Out_ PDRIVER_OBJECT *DriverObject)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01924">driver.c:1924</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a1f6108a72b327451dff3d76e01c61015"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a1f6108a72b327451dff3d76e01c61015">IoGetDriverObjectExtension</a></div><div class="ttdeci">PVOID NTAPI IoGetDriverObjectExtension(IN PDRIVER_OBJECT DriverObject, IN PVOID ClientIdentificationAddress)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01890">driver.c:1890</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a20d0829ad7bb53dbcb79aa85a924d511"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a20d0829ad7bb53dbcb79aa85a924d511">IopInitializeBuiltinDriver</a></div><div class="ttdeci">static BOOLEAN IopInitializeBuiltinDriver(IN PLDR_DATA_TABLE_ENTRY BootLdrEntry)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00793">driver.c:793</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a235196d589c1bf0e2acdfd8c8ea1e9c9"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a235196d589c1bf0e2acdfd8c8ea1e9c9">PiEnumerationFinished</a></div><div class="ttdeci">KEVENT PiEnumerationFinished</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d01/devaction_8c_source.html#l00050">devaction.c:50</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a28fe5a6b2b3165714817e984035599b8"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a28fe5a6b2b3165714817e984035599b8">IoRegisterDriverReinitialization</a></div><div class="ttdeci">VOID NTAPI IoRegisterDriverReinitialization(IN PDRIVER_OBJECT DriverObject, IN PDRIVER_REINITIALIZE ReinitRoutine, IN PVOID Context)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01783">driver.c:1783</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a2a33c1cd002e9d995c25647d13ece5b9"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a2a33c1cd002e9d995c25647d13ece5b9">IopDriverLoadResource</a></div><div class="ttdeci">ERESOURCE IopDriverLoadResource</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00020">driver.c:20</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a2beb144d9ffa796f3c6480cb03ec83b1"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a2beb144d9ffa796f3c6480cb03ec83b1">PLOAD_UNLOAD_PARAMS</a></div><div class="ttdeci">struct _LOAD_UNLOAD_PARAMS * PLOAD_UNLOAD_PARAMS</div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a32ff938de6ca67d9593c5a52b234cdd5"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a32ff938de6ca67d9593c5a52b234cdd5">IoAllocateDriverObjectExtension</a></div><div class="ttdeci">NTSTATUS NTAPI IoAllocateDriverObjectExtension(IN PDRIVER_OBJECT DriverObject, IN PVOID ClientIdentificationAddress, IN ULONG DriverObjectExtensionSize, OUT PVOID *DriverObjectExtension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01812">driver.c:1812</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a35bd509e60d7df316691497f034341ff"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a35bd509e60d7df316691497f034341ff">ServicesKeyName</a></div><div class="ttdeci">static const WCHAR ServicesKeyName[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00032">driver.c:32</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a3b38bafeb96d588a0c1993af7c0e933b"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a3b38bafeb96d588a0c1993af7c0e933b">IoCreateDriver</a></div><div class="ttdeci">NTSTATUS NTAPI IoCreateDriver(_In_opt_ PUNICODE_STRING DriverName, _In_ PDRIVER_INITIALIZE InitializationFunction)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01562">driver.c:1562</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a40e488e1c78783004c68c56f0eefb252"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a40e488e1c78783004c68c56f0eefb252">PnpSystemInit</a></div><div class="ttdeci">BOOLEAN PnpSystemInit</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d7d/iomgr_8c_source.html#l00017">iomgr.c:17</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a4393bd21f047135c71d08a82be27837d"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4393bd21f047135c71d08a82be27837d">IopInitializeSystemDrivers</a></div><div class="ttdeci">VOID FASTCALL IopInitializeSystemDrivers(VOID)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01196">driver.c:1196</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a453f786bc98f6f97e2e260b959250180"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a453f786bc98f6f97e2e260b959250180">IopGroupTable</a></div><div class="ttdeci">PLIST_ENTRY IopGroupTable</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00042">driver.c:42</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a480c985e73b8981c367efb9005641f95"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a480c985e73b8981c367efb9005641f95">DriverBootReinitTailEntry</a></div><div class="ttdeci">PLIST_ENTRY DriverBootReinitTailEntry</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00026">driver.c:26</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a4e4e9004f1cf0ca3142470fbb15c408a"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4e4e9004f1cf0ca3142470fbb15c408a">DriverBootReinitListLock</a></div><div class="ttdeci">KSPIN_LOCK DriverBootReinitListLock</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00028">driver.c:28</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a4f9928a6c28075abfa3d31f2d3e65a59"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a4f9928a6c28075abfa3d31f2d3e65a59">IopUnloadDriver</a></div><div class="ttdeci">NTSTATUS NTAPI IopUnloadDriver(PUNICODE_STRING DriverServiceName, BOOLEAN UnloadPnpDrivers)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01255">driver.c:1255</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a50e26ae27a3979781e5e1907e1ae8509"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a50e26ae27a3979781e5e1907e1ae8509">MiResolveImageReferences</a></div><div class="ttdeci">NTSTATUS NTAPI MiResolveImageReferences(IN PVOID ImageBase, IN PUNICODE_STRING ImageFileDirectory, IN PUNICODE_STRING NamePrefix OPTIONAL, OUT PCHAR *MissingApi, OUT PWCHAR *MissingDriver, OUT PLOAD_IMPORTS *LoadImports)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d67/sysldr_8c_source.html#l01033">sysldr.c:1033</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a5e8138869c13e27fabebc53b5825ae68"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a5e8138869c13e27fabebc53b5825ae68">IoDeleteDriver</a></div><div class="ttdeci">VOID NTAPI IoDeleteDriver(_In_ PDRIVER_OBJECT DriverObject)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01742">driver.c:1742</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a6dd290dcc1d2874e4fa5734521428a41"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a6dd290dcc1d2874e4fa5734521428a41">IopInvalidDeviceRequest</a></div><div class="ttdeci">NTSTATUS NTAPI IopInvalidDeviceRequest(PDEVICE_OBJECT DeviceObject, PIRP Irp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00066">driver.c:66</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a776175cfd70f4b8048578e66a932330d"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a776175cfd70f4b8048578e66a932330d">IoRegisterBootDriverReinitialization</a></div><div class="ttdeci">VOID NTAPI IoRegisterBootDriverReinitialization(IN PDRIVER_OBJECT DriverObject, IN PDRIVER_REINITIALIZE ReinitRoutine, IN PVOID Context)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01754">driver.c:1754</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a7ff70ce4037c9632cb68f1e3d3db77bd"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a7ff70ce4037c9632cb68f1e3d3db77bd">IopInitializeDriverModule</a></div><div class="ttdeci">NTSTATUS IopInitializeDriverModule(_In_ PLDR_DATA_TABLE_ENTRY ModuleObject, _In_ HANDLE ServiceHandle, _Out_ PDRIVER_OBJECT *OutDriverObject, _Out_ NTSTATUS *DriverEntryStatus)</div><div class="ttdoc">Initialize a loaded driver.</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00429">driver.c:429</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a877184253b37df8518f2c99eb916194f"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a877184253b37df8518f2c99eb916194f">DriverBootReinitListHead</a></div><div class="ttdeci">LIST_ENTRY DriverBootReinitListHead</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00027">driver.c:27</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a89a6b27be872011e4186ca371e294cad"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a89a6b27be872011e4186ca371e294cad">DriverReinitListLock</a></div><div class="ttdeci">KSPIN_LOCK DriverReinitListLock</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00023">driver.c:23</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_a8f586067dc8ee6d715e85041c811fa54"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#a8f586067dc8ee6d715e85041c811fa54">IopSuffixUnicodeString</a></div><div class="ttdeci">BOOLEAN NTAPI IopSuffixUnicodeString(IN PCUNICODE_STRING String1, IN PCUNICODE_STRING String2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00282">driver.c:282</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_aa4961bc581c67a08388252576ac0618d"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa4961bc581c67a08388252576ac0618d">IopDeleteDriver</a></div><div class="ttdeci">VOID NTAPI IopDeleteDriver(IN PVOID ObjectBody)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00078">driver.c:78</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_aa65653309b9be07552286681e498bc62"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa65653309b9be07552286681e498bc62">IopGetDriverNames</a></div><div class="ttdeci">NTSTATUS IopGetDriverNames(_In_ HANDLE ServiceHandle, _Out_ PUNICODE_STRING DriverName, _Out_opt_ PUNICODE_STRING ServiceName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00124">driver.c:124</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_aa6ddc4736018d8d024c1f277a8fbb504"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa6ddc4736018d8d024c1f277a8fbb504">IopInitializeBootDrivers</a></div><div class="ttdeci">VOID FASTCALL IopInitializeBootDrivers(VOID)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01009">driver.c:1009</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_aa77c8746a18e5f8fb2ad540457d2d157"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aa77c8746a18e5f8fb2ad540457d2d157">IopGroupIndex</a></div><div class="ttdeci">USHORT IopGroupIndex</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00041">driver.c:41</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_ab31507f021fd38901f993086f281ff67"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ab31507f021fd38901f993086f281ff67">ExpInTextModeSetup</a></div><div class="ttdeci">BOOLEAN ExpInTextModeSetup</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/de9/ntoskrnl_2ex_2init_8c_source.html#l00069">init.c:69</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_ac3a7a1a03e84c61dc478fc7fa4279467"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ac3a7a1a03e84c61dc478fc7fa4279467">IopReinitializeDrivers</a></div><div class="ttdeci">VOID NTAPI IopReinitializeDrivers(VOID)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l01482">driver.c:1482</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_acee5e07a3e07721bb0b8f6b5f9ed27ca"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#acee5e07a3e07721bb0b8f6b5f9ed27ca">IopDoLoadUnloadDriver</a></div><div class="ttdeci">NTSTATUS IopDoLoadUnloadDriver(_In_opt_ PUNICODE_STRING RegistryPath, _Inout_ PDRIVER_OBJECT *DriverObject)</div><div class="ttdoc">Process load and unload driver operations. This is mostly for NtLoadDriver and NtUnloadDriver,...</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l02085">driver.c:2085</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_ad08c0cab132fc9b2290745af9b353115"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ad08c0cab132fc9b2290745af9b353115">NtLoadDriver</a></div><div class="ttdeci">NTSTATUS NTAPI NtLoadDriver(IN PUNICODE_STRING DriverServiceName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l02133">driver.c:2133</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_ae3d61b4a88677a99c84cbbf2bd9c2872"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ae3d61b4a88677a99c84cbbf2bd9c2872">IopLoadUnloadDriverWorker</a></div><div class="ttdeci">static VOID NTAPI IopLoadUnloadDriverWorker(_Inout_ PVOID Parameter)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l02039">driver.c:2039</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_ae6f7198a8f7a7acdc84f912419bfebc6"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#ae6f7198a8f7a7acdc84f912419bfebc6">LdrProcessDriverModule</a></div><div class="ttdeci">NTSTATUS NTAPI LdrProcessDriverModule(PLDR_DATA_TABLE_ENTRY LdrEntry, PUNICODE_STRING FileName, PLDR_DATA_TABLE_ENTRY *ModuleObject)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00708">driver.c:708</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_aea42c837ff323fc083e3cff1f8a92cc2"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#aea42c837ff323fc083e3cff1f8a92cc2">IopNormalizeImagePath</a></div><div class="ttdeci">NTSTATUS FASTCALL IopNormalizeImagePath(_Inout_ _When_(return &gt;=0, _At_(ImagePath-&gt;Buffer, _Post_notnull_ __drv_allocatesMem(Mem))) PUNICODE_STRING ImagePath, _In_ PUNICODE_STRING ServiceName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00355">driver.c:355</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_af04fbbfa46bf88ceb926349a5b378a18"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af04fbbfa46bf88ceb926349a5b378a18">DriverReinitTailEntry</a></div><div class="ttdeci">PLIST_ENTRY DriverReinitTailEntry</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00024">driver.c:24</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_af5f9fd11ddb2267584071ff7ff1281d5"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af5f9fd11ddb2267584071ff7ff1281d5">IopHardwareDatabaseKey</a></div><div class="ttdeci">UNICODE_STRING IopHardwareDatabaseKey</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00030">driver.c:30</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_af6c7e94cbee2947162fdbb446b2fb7d7"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af6c7e94cbee2947162fdbb446b2fb7d7">IopDisplayLoadingMessage</a></div><div class="ttdeci">VOID FASTCALL IopDisplayLoadingMessage(PUNICODE_STRING ServiceName)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00316">driver.c:316</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2driver_8c_html_af6db1729b6878ac9e25cb0e6b23e6326"><div class="ttname"><a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html#af6db1729b6878ac9e25cb0e6b23e6326">PnPBootDriversLoaded</a></div><div class="ttdeci">BOOLEAN PnPBootDriversLoaded</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc1/pnpinit_8c_source.html#l00020">pnpinit.c:20</a></div></div>
<div class="ttc" id="antoskrnl_2io_2iomgr_2irp_8c_html_a2c1eb93fe2e6a647e9848c37c94e61f1"><div class="ttname"><a href="../../d6/dfc/ntoskrnl_2io_2iomgr_2irp_8c.html#a2c1eb93fe2e6a647e9848c37c94e61f1">IoCompleteRequest</a></div><div class="ttdeci">#define IoCompleteRequest</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dfc/ntoskrnl_2io_2iomgr_2irp_8c_source.html#l01240">irp.c:1240</a></div></div>
<div class="ttc" id="antoskrnl_2se_2priv_8c_html_ab4a255ad2a1c77fa035c8f42ef4fcc5d"><div class="ttname"><a href="../../da/d6e/ntoskrnl_2se_2priv_8c.html#ab4a255ad2a1c77fa035c8f42ef4fcc5d">SeSinglePrivilegeCheck</a></div><div class="ttdeci">BOOLEAN NTAPI SeSinglePrivilegeCheck(_In_ LUID PrivilegeValue, _In_ KPROCESSOR_MODE PreviousMode)</div><div class="ttdoc">Checks if a single privilege is present in the context of the calling thread.</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d6e/ntoskrnl_2se_2priv_8c_source.html#l00744">priv.c:744</a></div></div>
<div class="ttc" id="antstatus_8h_html_a25c21b1ffe961a8e2e58e24695250927"><div class="ttname"><a href="../../d3/d93/ntstatus_8h.html#a25c21b1ffe961a8e2e58e24695250927">STATUS_DELETE_PENDING</a></div><div class="ttdeci">#define STATUS_DELETE_PENDING</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/ntstatus_8h_source.html#l00322">ntstatus.h:322</a></div></div>
<div class="ttc" id="antstatus_8h_html_a5225ba01a4be529cef218cb8d783a35b"><div class="ttname"><a href="../../d3/d93/ntstatus_8h.html#a5225ba01a4be529cef218cb8d783a35b">STATUS_FAILED_DRIVER_ENTRY</a></div><div class="ttdeci">#define STATUS_FAILED_DRIVER_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/ntstatus_8h_source.html#l00911">ntstatus.h:911</a></div></div>
<div class="ttc" id="antstatus_8h_html_a5eb20a2ed21575310c474c1241656b1a"><div class="ttname"><a href="../../d3/d93/ntstatus_8h.html#a5eb20a2ed21575310c474c1241656b1a">STATUS_ILL_FORMED_SERVICE_ENTRY</a></div><div class="ttdeci">#define STATUS_ILL_FORMED_SERVICE_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/ntstatus_8h_source.html#l00588">ntstatus.h:588</a></div></div>
<div class="ttc" id="antstatus_8h_html_a821aeaec567da53a136174d941ca2e7d"><div class="ttname"><a href="../../d3/d93/ntstatus_8h.html#a821aeaec567da53a136174d941ca2e7d">STATUS_NO_MEMORY</a></div><div class="ttdeci">#define STATUS_NO_MEMORY</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d93/ntstatus_8h_source.html#l00260">ntstatus.h:260</a></div></div>
<div class="ttc" id="antstrsafe_8h_html_aa0d2d62f8917579f4406a58eb6351932"><div class="ttname"><a href="../../d5/d69/ntstrsafe_8h.html#aa0d2d62f8917579f4406a58eb6351932">RtlStringCchPrintfW</a></div><div class="ttdeci">NTSTRSAFEVAPI RtlStringCchPrintfW(_Out_writes_(cchDest) _Always_(_Post_z_) NTSTRSAFE_PWSTR pszDest, _In_ size_t cchDest, _In_ _Printf_format_string_ NTSTRSAFE_PCWSTR pszFormat,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d69/ntstrsafe_8h_source.html#l01110">ntstrsafe.h:1110</a></div></div>
<div class="ttc" id="antvdm_8h_html_a7577d49f3bfffb1cf048eef843177784"><div class="ttname"><a href="../../d0/d72/ntvdm_8h.html#a7577d49f3bfffb1cf048eef843177784">L</a></div><div class="ttdeci">#define L(x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d72/ntvdm_8h_source.html#l00050">ntvdm.h:50</a></div></div>
<div class="ttc" id="aobhandle_8c_html_a5a78c6116c097c9ee18cc64b7b512483"><div class="ttname"><a href="../../d4/df6/obhandle_8c.html#a5a78c6116c097c9ee18cc64b7b512483">ObInsertObject</a></div><div class="ttdeci">NTSTATUS NTAPI ObInsertObject(IN PVOID Object, IN PACCESS_STATE AccessState OPTIONAL, IN ACCESS_MASK DesiredAccess, IN ULONG ObjectPointerBias, OUT PVOID *NewObject OPTIONAL, OUT PHANDLE Handle)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/df6/obhandle_8c_source.html#l02935">obhandle.c:2935</a></div></div>
<div class="ttc" id="aoblife_8c_html_a4d6fd4313677c77f824e941b80cd65ca"><div class="ttname"><a href="../../d3/d29/oblife_8c.html#a4d6fd4313677c77f824e941b80cd65ca">ObCreateObject</a></div><div class="ttdeci">NTSTATUS NTAPI ObCreateObject(IN KPROCESSOR_MODE ProbeMode OPTIONAL, IN POBJECT_TYPE Type, IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL, IN KPROCESSOR_MODE AccessMode, IN OUT PVOID ParseContext OPTIONAL, IN ULONG ObjectSize, IN ULONG PagedPoolCharge OPTIONAL, IN ULONG NonPagedPoolCharge OPTIONAL, OUT PVOID *Object)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d29/oblife_8c_source.html#l01039">oblife.c:1039</a></div></div>
<div class="ttc" id="aoblife_8c_html_ab4cc47c9c7ba25d6b21d12699e1b64cc"><div class="ttname"><a href="../../d3/d29/oblife_8c.html#ab4cc47c9c7ba25d6b21d12699e1b64cc">ObMakeTemporaryObject</a></div><div class="ttdeci">VOID NTAPI ObMakeTemporaryObject(IN PVOID ObjectBody)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d29/oblife_8c_source.html#l01449">oblife.c:1449</a></div></div>
<div class="ttc" id="aobref_8c_html_a727c1f0726c97a4d0f526d541cee1f6a"><div class="ttname"><a href="../../db/d18/obref_8c.html#a727c1f0726c97a4d0f526d541cee1f6a">ObReferenceObjectByName</a></div><div class="ttdeci">NTSTATUS NTAPI ObReferenceObjectByName(IN PUNICODE_STRING ObjectPath, IN ULONG Attributes, IN PACCESS_STATE PassedAccessState, IN ACCESS_MASK DesiredAccess, IN POBJECT_TYPE ObjectType, IN KPROCESSOR_MODE AccessMode, IN OUT PVOID ParseContext, OUT PVOID *ObjectPtr)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d18/obref_8c_source.html#l00409">obref.c:409</a></div></div>
<div class="ttc" id="aobref_8c_html_ac203db242742089bdaa6846a09383053"><div class="ttname"><a href="../../db/d18/obref_8c.html#ac203db242742089bdaa6846a09383053">ObReferenceObjectByHandle</a></div><div class="ttdeci">NTSTATUS NTAPI ObReferenceObjectByHandle(IN HANDLE Handle, IN ACCESS_MASK DesiredAccess, IN POBJECT_TYPE ObjectType, IN KPROCESSOR_MODE AccessMode, OUT PVOID *Object, OUT POBJECT_HANDLE_INFORMATION HandleInformation OPTIONAL)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d18/obref_8c_source.html#l00494">obref.c:494</a></div></div>
<div class="ttc" id="apci_8c_html_ad1edec8453b14bacf37b25a1bf69ec5e"><div class="ttname"><a href="../../d1/de8/pci_8c.html#ad1edec8453b14bacf37b25a1bf69ec5e">DriverExtension</a></div><div class="ttdeci">PPCI_DRIVER_EXTENSION DriverExtension</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/de8/pci_8c_source.html#l00031">pci.c:31</a></div></div>
<div class="ttc" id="apedump_8c_html_acbe62d57a534c724ae14fcec5318b033"><div class="ttname"><a href="../../dd/d43/pedump_8c.html#acbe62d57a534c724ae14fcec5318b033">USHORT</a></div><div class="ttdeci">unsigned short USHORT</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d43/pedump_8c_source.html#l00061">pedump.c:61</a></div></div>
<div class="ttc" id="aps_8h_html_a29704f42e7d2a3b9ffd710572179418b"><div class="ttname"><a href="../../d0/d31/ps_8h.html#a29704f42e7d2a3b9ffd710572179418b">PsLoadedModuleList</a></div><div class="ttdeci">LIST_ENTRY PsLoadedModuleList</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d67/sysldr_8c_source.html#l00021">sysldr.c:21</a></div></div>
<div class="ttc" id="apsmgr_8c_html_a667297bfaa35579136c2da9440081452"><div class="ttname"><a href="../../df/d84/psmgr_8c.html#a667297bfaa35579136c2da9440081452">PsInitialSystemProcess</a></div><div class="ttdeci">PEPROCESS PsInitialSystemProcess</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d84/psmgr_8c_source.html#l00050">psmgr.c:50</a></div></div>
<div class="ttc" id="asdbapi_8c_html_ae75057ff9465c28e9c7822c7e89e1c21"><div class="ttname"><a href="../../d2/d33/sdbapi_8c.html#ae75057ff9465c28e9c7822c7e89e1c21">REG_DWORD</a></div><div class="ttdeci">#define REG_DWORD</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d33/sdbapi_8c_source.html#l00596">sdbapi.c:596</a></div></div>
<div class="ttc" id="asdk_2include_2reactos_2probe_8h_html_a354b39ea4abc3b4d09b2744b11ed9ac4"><div class="ttname"><a href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a354b39ea4abc3b4d09b2744b11ed9ac4">ProbeAndCaptureUnicodeString</a></div><div class="ttdeci">static __inline NTSTATUS ProbeAndCaptureUnicodeString(OUT PUNICODE_STRING Dest, IN KPROCESSOR_MODE CurrentMode, IN const UNICODE_STRING *UnsafeSrc)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7f/sdk_2include_2reactos_2probe_8h_source.html#l00142">probe.h:142</a></div></div>
<div class="ttc" id="asdk_2include_2reactos_2probe_8h_html_a6486ed0f447c395fd48a6114db9c7cb1"><div class="ttname"><a href="../../d9/d7f/sdk_2include_2reactos_2probe_8h.html#a6486ed0f447c395fd48a6114db9c7cb1">ReleaseCapturedUnicodeString</a></div><div class="ttdeci">static __inline VOID ReleaseCapturedUnicodeString(IN PUNICODE_STRING CapturedString, IN KPROCESSOR_MODE CurrentMode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d7f/sdk_2include_2reactos_2probe_8h_source.html#l00239">probe.h:239</a></div></div>
<div class="ttc" id="ashellext_8h_html_a77b4762318f24dff847f94f382cfeea6"><div class="ttname"><a href="../../d7/d5c/shellext_8h.html#a77b4762318f24dff847f94f382cfeea6">STATUS_SUCCESS</a></div><div class="ttdeci">#define STATUS_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/shellext_8h_source.html#l00065">shellext.h:65</a></div></div>
<div class="ttc" id="ashellext_8h_html_ac978cc4096a590979ae52c9fd4f62ee0"><div class="ttname"><a href="../../d7/d5c/shellext_8h.html#ac978cc4096a590979ae52c9fd4f62ee0">STATUS_BUFFER_TOO_SMALL</a></div><div class="ttdeci">#define STATUS_BUFFER_TOO_SMALL</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5c/shellext_8h_source.html#l00069">shellext.h:69</a></div></div>
<div class="ttc" id="asndvol32_8h_html_a2971480882c2c8dd774bd1c375c5c73d"><div class="ttname"><a href="../../da/d93/sndvol32_8h.html#a2971480882c2c8dd774bd1c375c5c73d">DPRINT</a></div><div class="ttdeci">#define DPRINT</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d93/sndvol32_8h_source.html#l00071">sndvol32.h:71</a></div></div>
<div class="ttc" id="astorage_2ide_2uniata_2inc_2CrossNt_8h_html_a2289c48e2d17972915192c184ea46d11"><div class="ttname"><a href="../../d7/d5a/storage_2ide_2uniata_2inc_2CrossNt_8h.html#a2289c48e2d17972915192c184ea46d11">OPTIONAL</a></div><div class="ttdeci">PULONG MinorVersion OPTIONAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d5a/storage_2ide_2uniata_2inc_2CrossNt_8h_source.html#l00068">CrossNt.h:68</a></div></div>
<div class="ttc" id="astructContext_html"><div class="ttname"><a href="../../d6/d7a/structContext.html">Context</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dcb/dll_2win32_2ole32_2compobj_8c_source.html#l04794">compobj.c:4795</a></div></div>
<div class="ttc" id="astructEntry_html"><div class="ttname"><a href="../../dc/d45/structEntry.html">Entry</a></div><div class="ttdoc">base of all file and directory entries</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/dbe/entries_8h_source.html#l00082">entries.h:83</a></div></div>
<div class="ttc" id="astruct__BOOT__DRIVER__LIST__ENTRY_html"><div class="ttname"><a href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html">_BOOT_DRIVER_LIST_ENTRY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d04/sdk_2include_2reactos_2arc_2arc_8h_source.html#l00245">arc.h:246</a></div></div>
<div class="ttc" id="astruct__BOOT__DRIVER__LIST__ENTRY_html_a8890ceae0b70258491fcbebf83e0fbba"><div class="ttname"><a href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html#a8890ceae0b70258491fcbebf83e0fbba">_BOOT_DRIVER_LIST_ENTRY::RegistryPath</a></div><div class="ttdeci">UNICODE_STRING RegistryPath</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d04/sdk_2include_2reactos_2arc_2arc_8h_source.html#l00249">arc.h:249</a></div></div>
<div class="ttc" id="astruct__BOOT__DRIVER__LIST__ENTRY_html_ac990accd79f4676331b1aa34538d5ba2"><div class="ttname"><a href="../../d2/d92/struct__BOOT__DRIVER__LIST__ENTRY.html#ac990accd79f4676331b1aa34538d5ba2">_BOOT_DRIVER_LIST_ENTRY::LdrEntry</a></div><div class="ttdeci">struct _LDR_DATA_TABLE_ENTRY * LdrEntry</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d04/sdk_2include_2reactos_2arc_2arc_8h_source.html#l00250">arc.h:250</a></div></div>
<div class="ttc" id="astruct__DEVICE__NODE_html_a500b45022d89f965df144b9851b2f789"><div class="ttname"><a href="../../d1/d86/struct__DEVICE__NODE.html#a500b45022d89f965df144b9851b2f789">_DEVICE_NODE::PhysicalDeviceObject</a></div><div class="ttdeci">PDEVICE_OBJECT PhysicalDeviceObject</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0e/ndk_2iotypes_8h_source.html#l00855">iotypes.h:855</a></div></div>
<div class="ttc" id="astruct__DEVICE__OBJECT_html"><div class="ttname"><a href="../../d3/d53/struct__DEVICE__OBJECT.html">_DEVICE_OBJECT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00413">env_spec_w32.h:413</a></div></div>
<div class="ttc" id="astruct__DRIVER__EXTENSION_html"><div class="ttname"><a href="../../d0/d9f/struct__DRIVER__EXTENSION.html">_DRIVER_EXTENSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02218">iotypes.h:2218</a></div></div>
<div class="ttc" id="astruct__DRIVER__EXTENSION_html_a65f6fe4eb8f99cb9c26c9fc38ad71d03"><div class="ttname"><a href="../../d0/d9f/struct__DRIVER__EXTENSION.html#a65f6fe4eb8f99cb9c26c9fc38ad71d03">_DRIVER_EXTENSION::DriverObject</a></div><div class="ttdeci">struct _DRIVER_OBJECT * DriverObject</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02219">iotypes.h:2219</a></div></div>
<div class="ttc" id="astruct__DRIVER__EXTENSION_html_aa3a6f76b67b89a18d60f16a980b1515f"><div class="ttname"><a href="../../d0/d9f/struct__DRIVER__EXTENSION.html#aa3a6f76b67b89a18d60f16a980b1515f">_DRIVER_EXTENSION::ServiceKeyName</a></div><div class="ttdeci">UNICODE_STRING ServiceKeyName</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02222">iotypes.h:2222</a></div></div>
<div class="ttc" id="astruct__DRIVER__EXTENSION_html_ad538c293521ec3d6b4fb739d271fde1d"><div class="ttname"><a href="../../d0/d9f/struct__DRIVER__EXTENSION.html#ad538c293521ec3d6b4fb739d271fde1d">_DRIVER_EXTENSION::Count</a></div><div class="ttdeci">ULONG Count</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02221">iotypes.h:2221</a></div></div>
<div class="ttc" id="astruct__DRIVER__INFORMATION_html"><div class="ttname"><a href="../../d0/dd0/struct__DRIVER__INFORMATION.html">_DRIVER_INFORMATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d0a/ne2000_8h_source.html#l00185">ne2000.h:186</a></div></div>
<div class="ttc" id="astruct__DRIVER__INFORMATION_html_a355018a71ce64e9a0e25877663be3c21"><div class="ttname"><a href="../../d0/dd0/struct__DRIVER__INFORMATION.html#a355018a71ce64e9a0e25877663be3c21">_DRIVER_INFORMATION::ServiceHandle</a></div><div class="ttdeci">HANDLE ServiceHandle</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00406">io.h:406</a></div></div>
<div class="ttc" id="astruct__DRIVER__INFORMATION_html_a52cdbb2321c92acc8c088feba060a956"><div class="ttname"><a href="../../d0/dd0/struct__DRIVER__INFORMATION.html#a52cdbb2321c92acc8c088feba060a956">_DRIVER_INFORMATION::DataTableEntry</a></div><div class="ttdeci">PBOOT_DRIVER_LIST_ENTRY DataTableEntry</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00405">io.h:405</a></div></div>
<div class="ttc" id="astruct__DRIVER__INFORMATION_html_a8ea0daa8424484defd29e52fb1dadd39"><div class="ttname"><a href="../../d0/dd0/struct__DRIVER__INFORMATION.html#a8ea0daa8424484defd29e52fb1dadd39">_DRIVER_INFORMATION::Link</a></div><div class="ttdeci">LIST_ENTRY Link</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00403">io.h:403</a></div></div>
<div class="ttc" id="astruct__DRIVER__INFORMATION_html_ac62e548f292261c31ea52f5295d61c87"><div class="ttname"><a href="../../d0/dd0/struct__DRIVER__INFORMATION.html#ac62e548f292261c31ea52f5295d61c87">_DRIVER_INFORMATION::TagPosition</a></div><div class="ttdeci">USHORT TagPosition</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00407">io.h:407</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html">_DRIVER_OBJECT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02274">iotypes.h:2274</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a112fcbcac6369066a448fd7622670535"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a112fcbcac6369066a448fd7622670535">_DRIVER_OBJECT::HardwareDatabase</a></div><div class="ttdeci">PUNICODE_STRING HardwareDatabase</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02284">iotypes.h:2284</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a15dd1ea21612b2d23087a7791794734a"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a15dd1ea21612b2d23087a7791794734a">_DRIVER_OBJECT::DriverStart</a></div><div class="ttdeci">PVOID DriverStart</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02279">iotypes.h:2279</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a177654e7cb46dd09a0c481f1d1188203"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a177654e7cb46dd09a0c481f1d1188203">_DRIVER_OBJECT::MajorFunction</a></div><div class="ttdeci">PDRIVER_DISPATCH MajorFunction[IRP_MJ_MAXIMUM_FUNCTION+1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02289">iotypes.h:2289</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a3a9528958da88c3aface7225fef57201"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a3a9528958da88c3aface7225fef57201">_DRIVER_OBJECT::DriverSection</a></div><div class="ttdeci">PVOID DriverSection</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02281">iotypes.h:2281</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a6ce206fa4c79e6f591d07d269956e7b7"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a6ce206fa4c79e6f591d07d269956e7b7">_DRIVER_OBJECT::Size</a></div><div class="ttdeci">CSHORT Size</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02276">iotypes.h:2276</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a794427f841f09f738f8b7d3cdc482b50"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a794427f841f09f738f8b7d3cdc482b50">_DRIVER_OBJECT::DriverSize</a></div><div class="ttdeci">ULONG DriverSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02280">iotypes.h:2280</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a7a21171ec2be18dd1ec5b8c74fc0c425"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a7a21171ec2be18dd1ec5b8c74fc0c425">_DRIVER_OBJECT::DriverInit</a></div><div class="ttdeci">PDRIVER_INITIALIZE DriverInit</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02286">iotypes.h:2286</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a7e5dc9baae90572acab2d120eb80777c"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a7e5dc9baae90572acab2d120eb80777c">_DRIVER_OBJECT::DriverExtension</a></div><div class="ttdeci">PDRIVER_EXTENSION DriverExtension</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02282">iotypes.h:2282</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_a80102a79b46d8ae8c097b5070ee6654a"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#a80102a79b46d8ae8c097b5070ee6654a">_DRIVER_OBJECT::Type</a></div><div class="ttdeci">CSHORT Type</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02275">iotypes.h:2275</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_aa53b7e6c1566d9260b3d83a77b486af6"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#aa53b7e6c1566d9260b3d83a77b486af6">_DRIVER_OBJECT::DeviceObject</a></div><div class="ttdeci">PDEVICE_OBJECT DeviceObject</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02277">iotypes.h:2277</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_ac8240be40fd14318840f1c519c7ad7a2"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#ac8240be40fd14318840f1c519c7ad7a2">_DRIVER_OBJECT::DriverUnload</a></div><div class="ttdeci">PDRIVER_UNLOAD DriverUnload</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02288">iotypes.h:2288</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_ad9f9e0f5c2b147cc664df4116a13c877"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#ad9f9e0f5c2b147cc664df4116a13c877">_DRIVER_OBJECT::DriverName</a></div><div class="ttdeci">UNICODE_STRING DriverName</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02283">iotypes.h:2283</a></div></div>
<div class="ttc" id="astruct__DRIVER__OBJECT_html_aeeeeb24f7c061f50df72e6d527bd2480"><div class="ttname"><a href="../../d6/d72/struct__DRIVER__OBJECT.html#aeeeeb24f7c061f50df72e6d527bd2480">_DRIVER_OBJECT::Flags</a></div><div class="ttdeci">ULONG Flags</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02278">iotypes.h:2278</a></div></div>
<div class="ttc" id="astruct__DRIVER__REINIT__ITEM_html"><div class="ttname"><a href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html">_DRIVER_REINIT_ITEM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00446">io.h:447</a></div></div>
<div class="ttc" id="astruct__DRIVER__REINIT__ITEM_html_a3a91cc6dbed6f261df13451a2adab515"><div class="ttname"><a href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a3a91cc6dbed6f261df13451a2adab515">_DRIVER_REINIT_ITEM::DriverObject</a></div><div class="ttdeci">PDRIVER_OBJECT DriverObject</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00449">io.h:449</a></div></div>
<div class="ttc" id="astruct__DRIVER__REINIT__ITEM_html_a43acd578b834eaf41bcb7f704b188c5b"><div class="ttname"><a href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a43acd578b834eaf41bcb7f704b188c5b">_DRIVER_REINIT_ITEM::ReinitRoutine</a></div><div class="ttdeci">PDRIVER_REINITIALIZE ReinitRoutine</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00450">io.h:450</a></div></div>
<div class="ttc" id="astruct__DRIVER__REINIT__ITEM_html_a67ddc56fff3490a6987181b635bf5ca9"><div class="ttname"><a href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#a67ddc56fff3490a6987181b635bf5ca9">_DRIVER_REINIT_ITEM::ItemEntry</a></div><div class="ttdeci">LIST_ENTRY ItemEntry</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00448">io.h:448</a></div></div>
<div class="ttc" id="astruct__DRIVER__REINIT__ITEM_html_ab33c8024bc28782758ec4d1c68528f5f"><div class="ttname"><a href="../../d6/dee/struct__DRIVER__REINIT__ITEM.html#ab33c8024bc28782758ec4d1c68528f5f">_DRIVER_REINIT_ITEM::Context</a></div><div class="ttdeci">PVOID Context</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd6/ntoskrnl_2include_2internal_2io_8h_source.html#l00451">io.h:451</a></div></div>
<div class="ttc" id="astruct__EXTENDED__DEVOBJ__EXTENSION_html"><div class="ttname"><a href="../../d0/dc5/struct__EXTENDED__DEVOBJ__EXTENSION.html">_EXTENDED_DEVOBJ_EXTENSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0e/ndk_2iotypes_8h_source.html#l00927">iotypes.h:928</a></div></div>
<div class="ttc" id="astruct__EXTENDED__DEVOBJ__EXTENSION_html_acdada0c7292023e165436029909c3d16"><div class="ttname"><a href="../../d0/dc5/struct__EXTENDED__DEVOBJ__EXTENSION.html#acdada0c7292023e165436029909c3d16">_EXTENDED_DEVOBJ_EXTENSION::ExtensionFlags</a></div><div class="ttdeci">ULONG ExtensionFlags</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0e/ndk_2iotypes_8h_source.html#l00934">iotypes.h:934</a></div></div>
<div class="ttc" id="astruct__EXTENDED__DRIVER__EXTENSION_html"><div class="ttname"><a href="../../d7/d80/struct__EXTENDED__DRIVER__EXTENSION.html">_EXTENDED_DRIVER_EXTENSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0e/ndk_2iotypes_8h_source.html#l00946">iotypes.h:947</a></div></div>
<div class="ttc" id="astruct__FileName_html"><div class="ttname"><a href="../../d4/dff/struct__FileName.html">_FileName</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3c/filecomp_8c_source.html#l00347">filecomp.c:348</a></div></div>
<div class="ttc" id="astruct__IMAGE__NT__HEADERS_html"><div class="ttname"><a href="../../dc/de5/struct__IMAGE__NT__HEADERS.html">_IMAGE_NT_HEADERS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dda/filesystems_2udfs_2Include_2ntddk__ex_8h_source.html#l00181">ntddk_ex.h:181</a></div></div>
<div class="ttc" id="astruct__IMAGE__NT__HEADERS_html_a71de2ed0819a8fac537db2e9daedfe05"><div class="ttname"><a href="../../dc/de5/struct__IMAGE__NT__HEADERS.html#a71de2ed0819a8fac537db2e9daedfe05">_IMAGE_NT_HEADERS::OptionalHeader</a></div><div class="ttdeci">IMAGE_OPTIONAL_HEADER32 OptionalHeader</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dda/filesystems_2udfs_2Include_2ntddk__ex_8h_source.html#l00184">ntddk_ex.h:184</a></div></div>
<div class="ttc" id="astruct__IMAGE__OPTIONAL__HEADER_html_a1f2b84cc41930af41550fee60bb72381"><div class="ttname"><a href="../../d8/dec/struct__IMAGE__OPTIONAL__HEADER.html#a1f2b84cc41930af41550fee60bb72381">_IMAGE_OPTIONAL_HEADER::SizeOfImage</a></div><div class="ttdeci">DWORD SizeOfImage</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dda/filesystems_2udfs_2Include_2ntddk__ex_8h_source.html#l00167">ntddk_ex.h:167</a></div></div>
<div class="ttc" id="astruct__IMAGE__OPTIONAL__HEADER_html_a27fb50e564e65b74a1142bd6d750aa21"><div class="ttname"><a href="../../d8/dec/struct__IMAGE__OPTIONAL__HEADER.html#a27fb50e564e65b74a1142bd6d750aa21">_IMAGE_OPTIONAL_HEADER::DllCharacteristics</a></div><div class="ttdeci">WORD DllCharacteristics</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dda/filesystems_2udfs_2Include_2ntddk__ex_8h_source.html#l00171">ntddk_ex.h:171</a></div></div>
<div class="ttc" id="astruct__IMAGE__OPTIONAL__HEADER_html_a68d3ff18e90131fbe88111dfee17b1f1"><div class="ttname"><a href="../../d8/dec/struct__IMAGE__OPTIONAL__HEADER.html#a68d3ff18e90131fbe88111dfee17b1f1">_IMAGE_OPTIONAL_HEADER::AddressOfEntryPoint</a></div><div class="ttdeci">DWORD AddressOfEntryPoint</div><div class="ttdef"><b>Definition:</b> <a href="../../da/dda/filesystems_2udfs_2Include_2ntddk__ex_8h_source.html#l00149">ntddk_ex.h:149</a></div></div>
<div class="ttc" id="astruct__IO__CLIENT__EXTENSION_html"><div class="ttname"><a href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html">_IO_CLIENT_EXTENSION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0e/ndk_2iotypes_8h_source.html#l00826">iotypes.h:827</a></div></div>
<div class="ttc" id="astruct__IO__CLIENT__EXTENSION_html_a3a29cb0edd5eb30a5acf908aafbe77ea"><div class="ttname"><a href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html#a3a29cb0edd5eb30a5acf908aafbe77ea">_IO_CLIENT_EXTENSION::ClientIdentificationAddress</a></div><div class="ttdeci">PVOID ClientIdentificationAddress</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0e/ndk_2iotypes_8h_source.html#l00829">iotypes.h:829</a></div></div>
<div class="ttc" id="astruct__IO__CLIENT__EXTENSION_html_a4b4c96c8a54b91c818d12d37ed14a2a1"><div class="ttname"><a href="../../d3/d86/struct__IO__CLIENT__EXTENSION.html#a4b4c96c8a54b91c818d12d37ed14a2a1">_IO_CLIENT_EXTENSION::NextExtension</a></div><div class="ttdeci">struct _IO_CLIENT_EXTENSION * NextExtension</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d0e/ndk_2iotypes_8h_source.html#l00828">iotypes.h:828</a></div></div>
<div class="ttc" id="astruct__IRP_html"><div class="ttname"><a href="../../d2/d97/struct__IRP.html">_IRP</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2f/Bus__PDO__QueryResourceRequirements_8c_source.html#l00092">Bus_PDO_QueryResourceRequirements.c:93</a></div></div>
<div class="ttc" id="astruct__KEVENT_html"><div class="ttname"><a href="../../df/d92/struct__KEVENT.html">_KEVENT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/xdk_2ketypes_8h_source.html#l00799">ketypes.h:799</a></div></div>
<div class="ttc" id="astruct__KEY__BASIC__INFORMATION_html"><div class="ttname"><a href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html">_KEY_BASIC_INFORMATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01099">nt_native.h:1099</a></div></div>
<div class="ttc" id="astruct__KEY__BASIC__INFORMATION_html_a59beb4a726fd868b08ec17af9e7c86f5"><div class="ttname"><a href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html#a59beb4a726fd868b08ec17af9e7c86f5">_KEY_BASIC_INFORMATION::Name</a></div><div class="ttdeci">WCHAR Name[1]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01103">nt_native.h:1103</a></div></div>
<div class="ttc" id="astruct__KEY__BASIC__INFORMATION_html_afae31f01287262679ac988e567e0b774"><div class="ttname"><a href="../../d0/de9/struct__KEY__BASIC__INFORMATION.html#afae31f01287262679ac988e567e0b774">_KEY_BASIC_INFORMATION::NameLength</a></div><div class="ttdeci">ULONG NameLength</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01102">nt_native.h:1102</a></div></div>
<div class="ttc" id="astruct__KEY__NAME__INFORMATION_html"><div class="ttname"><a href="../../d4/dc5/struct__KEY__NAME__INFORMATION.html">_KEY_NAME_INFORMATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d9e/include_2reactos_2wine_2winternl_8h_source.html#l01184">winternl.h:1184</a></div></div>
<div class="ttc" id="astruct__KEY__NAME__INFORMATION_html_a0a366430dcfefdb0512fe5b83e615e56"><div class="ttname"><a href="../../d4/dc5/struct__KEY__NAME__INFORMATION.html#a0a366430dcfefdb0512fe5b83e615e56">_KEY_NAME_INFORMATION::NameLength</a></div><div class="ttdeci">ULONG NameLength</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d9e/include_2reactos_2wine_2winternl_8h_source.html#l01185">winternl.h:1185</a></div></div>
<div class="ttc" id="astruct__KEY__NAME__INFORMATION_html_a9db5186cd2e80e3dd2026d5cd1a09def"><div class="ttname"><a href="../../d4/dc5/struct__KEY__NAME__INFORMATION.html#a9db5186cd2e80e3dd2026d5cd1a09def">_KEY_NAME_INFORMATION::Name</a></div><div class="ttdeci">WCHAR Name[1]</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d9e/include_2reactos_2wine_2winternl_8h_source.html#l01186">winternl.h:1186</a></div></div>
<div class="ttc" id="astruct__KEY__VALUE__FULL__INFORMATION_html"><div class="ttname"><a href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html">_KEY_VALUE_FULL_INFORMATION</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01155">nt_native.h:1155</a></div></div>
<div class="ttc" id="astruct__KEY__VALUE__FULL__INFORMATION_html_a2d830e8dad303c46a6b9d5f159e59994"><div class="ttname"><a href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a2d830e8dad303c46a6b9d5f159e59994">_KEY_VALUE_FULL_INFORMATION::Type</a></div><div class="ttdeci">ULONG Type</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01157">nt_native.h:1157</a></div></div>
<div class="ttc" id="astruct__KEY__VALUE__FULL__INFORMATION_html_a3e34c3d675c4b63a21771d4327866e36"><div class="ttname"><a href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a3e34c3d675c4b63a21771d4327866e36">_KEY_VALUE_FULL_INFORMATION::DataLength</a></div><div class="ttdeci">ULONG DataLength</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01159">nt_native.h:1159</a></div></div>
<div class="ttc" id="astruct__KEY__VALUE__FULL__INFORMATION_html_a513fbe4d9ba9d970466025722570355a"><div class="ttname"><a href="../../d7/d67/struct__KEY__VALUE__FULL__INFORMATION.html#a513fbe4d9ba9d970466025722570355a">_KEY_VALUE_FULL_INFORMATION::DataOffset</a></div><div class="ttdeci">ULONG DataOffset</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l01158">nt_native.h:1158</a></div></div>
<div class="ttc" id="astruct__KSYSTEM__TIME_html_a7e5f6afc567e66eae778e8baca6cef41"><div class="ttname"><a href="../../d1/de3/struct__KSYSTEM__TIME.html#a7e5f6afc567e66eae778e8baca6cef41">_KSYSTEM_TIME::LowPart</a></div><div class="ttdeci">ULONG LowPart</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/xdk_2ketypes_8h_source.html#l00917">ketypes.h:917</a></div></div>
<div class="ttc" id="astruct__LDR__DATA__TABLE__ENTRY_html"><div class="ttname"><a href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html">_LDR_DATA_TABLE_ENTRY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/de7/btrfs__drv_8h_source.html#l01876">btrfs_drv.h:1876</a></div></div>
<div class="ttc" id="astruct__LDR__DATA__TABLE__ENTRY_html_a5e68353a301bbe93b0ae307c8865a2f6"><div class="ttname"><a href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html#a5e68353a301bbe93b0ae307c8865a2f6">_LDR_DATA_TABLE_ENTRY::Flags</a></div><div class="ttdeci">ULONG Flags</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d40/storage_2ide_2uniata_2ntddk__ex_8h_source.html#l00207">ntddk_ex.h:207</a></div></div>
<div class="ttc" id="astruct__LDR__DATA__TABLE__ENTRY_html_ae862e70d4b69c8de9547400c9f615cb6"><div class="ttname"><a href="../../d4/daf/struct__LDR__DATA__TABLE__ENTRY.html#ae862e70d4b69c8de9547400c9f615cb6">_LDR_DATA_TABLE_ENTRY::BaseDllName</a></div><div class="ttdeci">UNICODE_STRING BaseDllName</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/ldrtypes_8h_source.html#l00145">ldrtypes.h:145</a></div></div>
<div class="ttc" id="astruct__LIST__ENTRY_html"><div class="ttname"><a href="../../d9/da7/struct__LIST__ENTRY.html">_LIST_ENTRY</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00119">typedefs.h:120</a></div></div>
<div class="ttc" id="astruct__LIST__ENTRY_html_a3a60644cad17d7dd53f6b7b378b191f3"><div class="ttname"><a href="../../d9/da7/struct__LIST__ENTRY.html#a3a60644cad17d7dd53f6b7b378b191f3">_LIST_ENTRY::Blink</a></div><div class="ttdeci">struct _LIST_ENTRY * Blink</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00122">typedefs.h:122</a></div></div>
<div class="ttc" id="astruct__LIST__ENTRY_html_a4d67c5f973e82b7aa25c74f3a3ca4e30"><div class="ttname"><a href="../../d9/da7/struct__LIST__ENTRY.html#a4d67c5f973e82b7aa25c74f3a3ca4e30">_LIST_ENTRY::Flink</a></div><div class="ttdeci">struct _LIST_ENTRY * Flink</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00121">typedefs.h:121</a></div></div>
<div class="ttc" id="astruct__LOADER__PARAMETER__BLOCK_html_a07be85fd15367882127cbde3d560b6f6"><div class="ttname"><a href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#a07be85fd15367882127cbde3d560b6f6">_LOADER_PARAMETER_BLOCK::BootDriverListHead</a></div><div class="ttdeci">LIST_ENTRY BootDriverListHead</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d04/sdk_2include_2reactos_2arc_2arc_8h_source.html#l00542">arc.h:542</a></div></div>
<div class="ttc" id="astruct__LOADER__PARAMETER__BLOCK_html_a623b26c4210067111bd27f552243adba"><div class="ttname"><a href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#a623b26c4210067111bd27f552243adba">_LOADER_PARAMETER_BLOCK::LoadOrderListHead</a></div><div class="ttdeci">LIST_ENTRY LoadOrderListHead</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d04/sdk_2include_2reactos_2arc_2arc_8h_source.html#l00540">arc.h:540</a></div></div>
<div class="ttc" id="astruct__LOADER__PARAMETER__BLOCK_html_abd3d1861bc76b2a95e8ce5ca481b0b51"><div class="ttname"><a href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#abd3d1861bc76b2a95e8ce5ca481b0b51">_LOADER_PARAMETER_BLOCK::ArcBootDeviceName</a></div><div class="ttdeci">PSTR ArcBootDeviceName</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d04/sdk_2include_2reactos_2arc_2arc_8h_source.html#l00550">arc.h:550</a></div></div>
<div class="ttc" id="astruct__LOADER__PARAMETER__BLOCK_html_ac83315556babec8d9a3fa1023e112209"><div class="ttname"><a href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#ac83315556babec8d9a3fa1023e112209">_LOADER_PARAMETER_BLOCK::NtBootPathName</a></div><div class="ttdeci">PSTR NtBootPathName</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d04/sdk_2include_2reactos_2arc_2arc_8h_source.html#l00552">arc.h:552</a></div></div>
<div class="ttc" id="astruct__LOADER__PARAMETER__BLOCK_html_afcde932ba7c29c5e6650e780561d9bcf"><div class="ttname"><a href="../../d3/dfe/struct__LOADER__PARAMETER__BLOCK.html#afcde932ba7c29c5e6650e780561d9bcf">_LOADER_PARAMETER_BLOCK::SetupLdrBlock</a></div><div class="ttdeci">struct _SETUP_LOADER_BLOCK * SetupLdrBlock</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d04/sdk_2include_2reactos_2arc_2arc_8h_source.html#l00558">arc.h:558</a></div></div>
<div class="ttc" id="astruct__LOAD__IMPORTS_html"><div class="ttname"><a href="../../d2/dfd/struct__LOAD__IMPORTS.html">_LOAD_IMPORTS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d97/ldrtypes_8h_source.html#l00170">ldrtypes.h:171</a></div></div>
<div class="ttc" id="astruct__LOAD__UNLOAD__PARAMS_html"><div class="ttname"><a href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html">_LOAD_UNLOAD_PARAMS</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00047">driver.c:48</a></div></div>
<div class="ttc" id="astruct__LOAD__UNLOAD__PARAMS_html_a0395027b9f688a70c102e7cb01696203"><div class="ttname"><a href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0395027b9f688a70c102e7cb01696203">_LOAD_UNLOAD_PARAMS::WorkItem</a></div><div class="ttdeci">WORK_QUEUE_ITEM WorkItem</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00051">driver.c:51</a></div></div>
<div class="ttc" id="astruct__LOAD__UNLOAD__PARAMS_html_a0873879312b77cb4345ce0f7b6c3dd24"><div class="ttname"><a href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a0873879312b77cb4345ce0f7b6c3dd24">_LOAD_UNLOAD_PARAMS::Status</a></div><div class="ttdeci">NTSTATUS Status</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00049">driver.c:49</a></div></div>
<div class="ttc" id="astruct__LOAD__UNLOAD__PARAMS_html_a2d73c8dfafd1fd005cbbe9953d41ced6"><div class="ttname"><a href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a2d73c8dfafd1fd005cbbe9953d41ced6">_LOAD_UNLOAD_PARAMS::SetEvent</a></div><div class="ttdeci">BOOLEAN SetEvent</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00054">driver.c:54</a></div></div>
<div class="ttc" id="astruct__LOAD__UNLOAD__PARAMS_html_a8b6d5f4a9a64eacc7e2b61082374b139"><div class="ttname"><a href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#a8b6d5f4a9a64eacc7e2b61082374b139">_LOAD_UNLOAD_PARAMS::Event</a></div><div class="ttdeci">KEVENT Event</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00052">driver.c:52</a></div></div>
<div class="ttc" id="astruct__LOAD__UNLOAD__PARAMS_html_ae7565826a8d199333d11158f12b51124"><div class="ttname"><a href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#ae7565826a8d199333d11158f12b51124">_LOAD_UNLOAD_PARAMS::RegistryPath</a></div><div class="ttdeci">PUNICODE_STRING RegistryPath</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00050">driver.c:50</a></div></div>
<div class="ttc" id="astruct__LOAD__UNLOAD__PARAMS_html_aec96717639a93639a7a3635397420557"><div class="ttname"><a href="../../d3/dff/struct__LOAD__UNLOAD__PARAMS.html#aec96717639a93639a7a3635397420557">_LOAD_UNLOAD_PARAMS::DriverObject</a></div><div class="ttdeci">PDRIVER_OBJECT DriverObject</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c_source.html#l00053">driver.c:53</a></div></div>
<div class="ttc" id="astruct__OBJECT__ATTRIBUTES_html"><div class="ttname"><a href="../../d6/d32/struct__OBJECT__ATTRIBUTES.html">_OBJECT_ATTRIBUTES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dc1/umtypes_8h_source.html#l00181">umtypes.h:182</a></div></div>
<div class="ttc" id="astruct__OBJECT__TYPE_html"><div class="ttname"><a href="../../de/ddc/struct__OBJECT__TYPE.html">_OBJECT_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dca/ndk_2obtypes_8h_source.html#l00379">obtypes.h:380</a></div></div>
<div class="ttc" id="astruct__RTL__QUERY__REGISTRY__TABLE_html"><div class="ttname"><a href="../../d1/d10/struct__RTL__QUERY__REGISTRY__TABLE.html">_RTL_QUERY_REGISTRY_TABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l00108">nt_native.h:108</a></div></div>
<div class="ttc" id="astruct__RTL__QUERY__REGISTRY__TABLE_html_a02bb1408f29dbed00cb59d2a5730b696"><div class="ttname"><a href="../../d1/d10/struct__RTL__QUERY__REGISTRY__TABLE.html#a02bb1408f29dbed00cb59d2a5730b696">_RTL_QUERY_REGISTRY_TABLE::Name</a></div><div class="ttdeci">PWSTR Name</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l00111">nt_native.h:111</a></div></div>
<div class="ttc" id="astruct__RTL__QUERY__REGISTRY__TABLE_html_a7300ff2835155bd276fa8b24d246539c"><div class="ttname"><a href="../../d1/d10/struct__RTL__QUERY__REGISTRY__TABLE.html#a7300ff2835155bd276fa8b24d246539c">_RTL_QUERY_REGISTRY_TABLE::Flags</a></div><div class="ttdeci">ULONG Flags</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l00110">nt_native.h:110</a></div></div>
<div class="ttc" id="astruct__RTL__QUERY__REGISTRY__TABLE_html_a8814fdfb9d1b14abbc619167b0bad4a5"><div class="ttname"><a href="../../d1/d10/struct__RTL__QUERY__REGISTRY__TABLE.html#a8814fdfb9d1b14abbc619167b0bad4a5">_RTL_QUERY_REGISTRY_TABLE::EntryContext</a></div><div class="ttdeci">PVOID EntryContext</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc9/nt__native_8h_source.html#l00112">nt_native.h:112</a></div></div>
<div class="ttc" id="astruct__UNICODE__STRING_html"><div class="ttname"><a href="../../d9/d76/struct__UNICODE__STRING.html">_UNICODE_STRING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00368">env_spec_w32.h:368</a></div></div>
<div class="ttc" id="astruct__UNICODE__STRING_html_a3ebb6a85103954fd7fc325ba30c54008"><div class="ttname"><a href="../../d9/d76/struct__UNICODE__STRING.html#a3ebb6a85103954fd7fc325ba30c54008">_UNICODE_STRING::Length</a></div><div class="ttdeci">USHORT Length</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00369">env_spec_w32.h:369</a></div></div>
<div class="ttc" id="astruct__UNICODE__STRING_html_ae0487ecc173e55918bcee834bd3d107b"><div class="ttname"><a href="../../d9/d76/struct__UNICODE__STRING.html#ae0487ecc173e55918bcee834bd3d107b">_UNICODE_STRING::MaximumLength</a></div><div class="ttdeci">USHORT MaximumLength</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00370">env_spec_w32.h:370</a></div></div>
<div class="ttc" id="astruct__UNICODE__STRING_html_afbc2ba2b7be88d0118e683a2eb289795"><div class="ttname"><a href="../../d9/d76/struct__UNICODE__STRING.html#afbc2ba2b7be88d0118e683a2eb289795">_UNICODE_STRING::Buffer</a></div><div class="ttdeci">PWSTR Buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/df3/env__spec__w32_8h_source.html#l00371">env_spec_w32.h:371</a></div></div>
<div class="ttc" id="astruct__WORK__QUEUE__ITEM_html"><div class="ttname"><a href="../../d3/d7f/struct__WORK__QUEUE__ITEM.html">_WORK_QUEUE_ITEM</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d49/xdk_2extypes_8h_source.html#l00202">extypes.h:202</a></div></div>
<div class="ttc" id="astructacpi__buffer_html_ae7c06f2850a47879d14be25a906d2c22"><div class="ttname"><a href="../../d0/d73/structacpi__buffer.html#ae7c06f2850a47879d14be25a906d2c22">acpi_buffer::Length</a></div><div class="ttdeci">ACPI_SIZE Length</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d8b/actypes_8h_source.html#l01053">actypes.h:1053</a></div></div>
<div class="ttc" id="astructstatus_html"><div class="ttname"><a href="../../d9/d66/structstatus.html">status</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d3a/ps_8c_source.html#l00097">ps.c:97</a></div></div>
<div class="ttc" id="atag_8h_html_a5cc8acd2cc8c25caced891be5a08f285"><div class="ttname"><a href="../../d2/dcd/tag_8h.html#a5cc8acd2cc8c25caced891be5a08f285">TAG_REINIT</a></div><div class="ttdeci">#define TAG_REINIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcd/tag_8h_source.html#l00084">tag.h:84</a></div></div>
<div class="ttc" id="atag_8h_html_a5fda82920711fed638f144aff052d4e3"><div class="ttname"><a href="../../d2/dcd/tag_8h.html#a5fda82920711fed638f144aff052d4e3">TAG_LDR_WSTR</a></div><div class="ttdeci">#define TAG_LDR_WSTR</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcd/tag_8h_source.html#l00102">tag.h:102</a></div></div>
<div class="ttc" id="atag_8h_html_a6f0ee2ea2d6b53a2e0584162ca106677"><div class="ttname"><a href="../../d2/dcd/tag_8h.html#a6f0ee2ea2d6b53a2e0584162ca106677">TAG_RTLREGISTRY</a></div><div class="ttdeci">#define TAG_RTLREGISTRY</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcd/tag_8h_source.html#l00097">tag.h:97</a></div></div>
<div class="ttc" id="atag_8h_html_a9146aedba83eab72ac95cf32641e869e"><div class="ttname"><a href="../../d2/dcd/tag_8h.html#a9146aedba83eab72ac95cf32641e869e">TAG_IO</a></div><div class="ttdeci">#define TAG_IO</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcd/tag_8h_source.html#l00080">tag.h:80</a></div></div>
<div class="ttc" id="atag_8h_html_aa721980a71e3fbd417666df64ce05e04"><div class="ttname"><a href="../../d2/dcd/tag_8h.html#aa721980a71e3fbd417666df64ce05e04">TAG_DRIVER_EXTENSION</a></div><div class="ttdeci">#define TAG_DRIVER_EXTENSION</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcd/tag_8h_source.html#l00061">tag.h:61</a></div></div>
<div class="ttc" id="atftpd_8cpp_html_a69c549a4f4a1e88fa4a2c38cde62f569"><div class="ttname"><a href="../../d0/dcf/tftpd_8cpp.html#a69c549a4f4a1e88fa4a2c38cde62f569">serviceName</a></div><div class="ttdeci">char serviceName[]</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dcf/tftpd_8cpp_source.html#l00034">tftpd.cpp:34</a></div></div>
<div class="ttc" id="atunneltest_8c_html_a450dec8394441d2f3bb56b715b899ca2"><div class="ttname"><a href="../../de/d46/tunneltest_8c.html#a450dec8394441d2f3bb56b715b899ca2">RTL_CONSTANT_STRING</a></div><div class="ttdeci">#define RTL_CONSTANT_STRING(s)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d46/tunneltest_8c_source.html#l00014">tunneltest.c:14</a></div></div>
<div class="ttc" id="atypedefs_8h_html_a0d5351e5911d4fb8332795b1b4f35b7d"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#a0d5351e5911d4fb8332795b1b4f35b7d">PWSTR</a></div><div class="ttdeci">uint16_t * PWSTR</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00056">typedefs.h:56</a></div></div>
<div class="ttc" id="atypedefs_8h_html_a9b3a762f8b8db86e6cb243f4af6d87ac"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#a9b3a762f8b8db86e6cb243f4af6d87ac">NTAPI</a></div><div class="ttdeci">#define NTAPI</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00036">typedefs.h:36</a></div></div>
<div class="ttc" id="atypedefs_8h_html_aaac1612081decdfbec707942ad793490"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#aaac1612081decdfbec707942ad793490">INT</a></div><div class="ttdeci">int32_t INT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00058">typedefs.h:58</a></div></div>
<div class="ttc" id="atypedefs_8h_html_ab329f640d89ba58a8e81e19004bdb7bd"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#ab329f640d89ba58a8e81e19004bdb7bd">RtlCopyMemory</a></div><div class="ttdeci">#define RtlCopyMemory(Destination, Source, Length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00263">typedefs.h:263</a></div></div>
<div class="ttc" id="atypedefs_8h_html_abd90afec09d7094004e811f9056461b3"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#abd90afec09d7094004e811f9056461b3">RtlZeroMemory</a></div><div class="ttdeci">#define RtlZeroMemory(Destination, Length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00262">typedefs.h:262</a></div></div>
<div class="ttc" id="atypedefs_8h_html_ac078b01ba50a19d9467601bd01f70131"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#ac078b01ba50a19d9467601bd01f70131">ULONG_PTR</a></div><div class="ttdeci">uint32_t ULONG_PTR</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00065">typedefs.h:65</a></div></div>
<div class="ttc" id="atypedefs_8h_html_ac2bbd6d630a06a980d9a92ddb9a49928"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a></div><div class="ttdeci">#define IN</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00039">typedefs.h:39</a></div></div>
<div class="ttc" id="atypedefs_8h_html_adb696f4512c9ed33dd7d571f296b7ebb"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#adb696f4512c9ed33dd7d571f296b7ebb">RtlMoveMemory</a></div><div class="ttdeci">#define RtlMoveMemory(Destination, Source, Length)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00264">typedefs.h:264</a></div></div>
<div class="ttc" id="atypedefs_8h_html_adba92689f88eda4c80df8f61dccff189"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#adba92689f88eda4c80df8f61dccff189">PWCHAR</a></div><div class="ttdeci">uint16_t * PWCHAR</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00056">typedefs.h:56</a></div></div>
<div class="ttc" id="atypedefs_8h_html_adec42d53dc3b3e16ab7a1cd98af1c5fc"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#adec42d53dc3b3e16ab7a1cd98af1c5fc">CONTAINING_RECORD</a></div><div class="ttdeci">#define CONTAINING_RECORD(address, type, field)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00260">typedefs.h:260</a></div></div>
<div class="ttc" id="atypedefs_8h_html_ae55b08f99eeb1fd267a24556e8171374"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#ae55b08f99eeb1fd267a24556e8171374">ULONG</a></div><div class="ttdeci">uint32_t ULONG</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00059">typedefs.h:59</a></div></div>
<div class="ttc" id="atypedefs_8h_html_aec78e7a9e90a406a56f859ee456e8eae"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a></div><div class="ttdeci">#define OUT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00040">typedefs.h:40</a></div></div>
<div class="ttc" id="atypedefs_8h_html_afce6a8c69adf1a5b94e5b1ed9618c542"><div class="ttname"><a href="../../d7/d69/typedefs_8h.html#afce6a8c69adf1a5b94e5b1ed9618c542">PCHAR</a></div><div class="ttdeci">char * PCHAR</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d69/typedefs_8h_source.html#l00051">typedefs.h:51</a></div></div>
<div class="ttc" id="audferr__usr_8h_html_a120a187f72577ad105c76fea7124fb72"><div class="ttname"><a href="../../df/db3/udferr__usr_8h.html#a120a187f72577ad105c76fea7124fb72">STATUS_INVALID_DEVICE_REQUEST</a></div><div class="ttdeci">#define STATUS_INVALID_DEVICE_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db3/udferr__usr_8h_source.html#l00138">udferr_usr.h:138</a></div></div>
<div class="ttc" id="audferr__usr_8h_html_a52c9a508482278e5a91348ba542df15f"><div class="ttname"><a href="../../df/db3/udferr__usr_8h.html#a52c9a508482278e5a91348ba542df15f">STATUS_INVALID_PARAMETER</a></div><div class="ttdeci">#define STATUS_INVALID_PARAMETER</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db3/udferr__usr_8h_source.html#l00135">udferr_usr.h:135</a></div></div>
<div class="ttc" id="audferr__usr_8h_html_a9102789550b4971083e4fb315b30a984"><div class="ttname"><a href="../../df/db3/udferr__usr_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a></div><div class="ttdeci">#define STATUS_UNSUCCESSFUL</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db3/udferr__usr_8h_source.html#l00132">udferr_usr.h:132</a></div></div>
<div class="ttc" id="audferr__usr_8h_html_ab9f3c338390cb777c51ec83bdd8ee56b"><div class="ttname"><a href="../../df/db3/udferr__usr_8h.html#ab9f3c338390cb777c51ec83bdd8ee56b">STATUS_OBJECT_NAME_COLLISION</a></div><div class="ttdeci">#define STATUS_OBJECT_NAME_COLLISION</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db3/udferr__usr_8h_source.html#l00150">udferr_usr.h:150</a></div></div>
<div class="ttc" id="audferr__usr_8h_html_aeb86c04f9593b4cdb1b56c71e76d2e36"><div class="ttname"><a href="../../df/db3/udferr__usr_8h.html#aeb86c04f9593b4cdb1b56c71e76d2e36">STATUS_INSUFFICIENT_RESOURCES</a></div><div class="ttdeci">#define STATUS_INSUFFICIENT_RESOURCES</div><div class="ttdef"><b>Definition:</b> <a href="../../df/db3/udferr__usr_8h_source.html#l00158">udferr_usr.h:158</a></div></div>
<div class="ttc" id="avfdcmd_8c_html_a5453a8bc4f99562e51daa49d57a65f3e"><div class="ttname"><a href="../../da/d5a/vfdcmd_8c.html#a5453a8bc4f99562e51daa49d57a65f3e">Link</a></div><div class="ttdeci">static int Link(const char **args)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d5a/vfdcmd_8c_source.html#l02414">vfdcmd.c:2414</a></div></div>
<div class="ttc" id="awdfcollection_8h_html_ade891b5bceeb9043185424b74b336930"><div class="ttname"><a href="../../d1/d7b/wdfcollection_8h.html#ade891b5bceeb9043185424b74b336930">Index</a></div><div class="ttdeci">_In_ WDFCOLLECTION _In_ ULONG Index</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d7b/wdfcollection_8h_source.html#l00181">wdfcollection.h:182</a></div></div>
<div class="ttc" id="awdfdevice_8h_html_a00ffdca01483ee815bcae322998da051"><div class="ttname"><a href="../../dd/d12/wdfdevice_8h.html#a00ffdca01483ee815bcae322998da051">DeviceObject</a></div><div class="ttdeci">_In_ PDEVICE_OBJECT DeviceObject</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d12/wdfdevice_8h_source.html#l02054">wdfdevice.h:2055</a></div></div>
<div class="ttc" id="awdfdriver_8h_html_a2adf9d77f6df66f4c1e07c7a1fb0f06a"><div class="ttname"><a href="../../d5/d7e/wdfdriver_8h.html#a2adf9d77f6df66f4c1e07c7a1fb0f06a">RegistryPath</a></div><div class="ttdeci">_Must_inspect_result_ _In_ PDRIVER_OBJECT _In_ PCUNICODE_STRING RegistryPath</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7e/wdfdriver_8h_source.html#l00215">wdfdriver.h:215</a></div></div>
<div class="ttc" id="awdfdriver_8h_html_add81a6c12e7171242e52d95255ba505f"><div class="ttname"><a href="../../d5/d7e/wdfdriver_8h.html#add81a6c12e7171242e52d95255ba505f">DriverObject</a></div><div class="ttdeci">_Must_inspect_result_ _In_ PDRIVER_OBJECT DriverObject</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7e/wdfdriver_8h_source.html#l00213">wdfdriver.h:213</a></div></div>
<div class="ttc" id="awinddi_8h_html_aef64f3bd22a72374c7cbbb7018b48959"><div class="ttname"><a href="../../db/d96/winddi_8h.html#aef64f3bd22a72374c7cbbb7018b48959">hDriver</a></div><div class="ttdeci">_In_ LPWSTR _In_ ULONG _In_ ULONG _In_ ULONG _Out_ DEVINFO _In_ HDEV _In_ LPWSTR _In_ HANDLE hDriver</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d96/winddi_8h_source.html#l03557">winddi.h:3557</a></div></div>
<div class="ttc" id="awintirpc_8h_html_aa367b75c5aed883fef5befbdf04835a4"><div class="ttname"><a href="../../d2/d3a/wintirpc_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a></div><div class="ttdeci">#define snprintf</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d3a/wintirpc_8h_source.html#l00048">wintirpc.h:48</a></div></div>
<div class="ttc" id="awork_8c_html_a8c10f13de7bb2f47358b32a157b9ed87"><div class="ttname"><a href="../../de/d56/work_8c.html#a8c10f13de7bb2f47358b32a157b9ed87">ExQueueWorkItem</a></div><div class="ttdeci">VOID NTAPI ExQueueWorkItem(IN PWORK_QUEUE_ITEM WorkItem, IN WORK_QUEUE_TYPE QueueType)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d56/work_8c_source.html#l00723">work.c:723</a></div></div>
<div class="ttc" id="axdk_2cmfuncs_8h_html_a87de90af0024b770708c3ca5e2fe4a09"><div class="ttname"><a href="../../d6/d83/xdk_2cmfuncs_8h.html#a87de90af0024b770708c3ca5e2fe4a09">ObjectName</a></div><div class="ttdeci">_In_ PVOID _Out_opt_ PULONG_PTR _Outptr_opt_ PCUNICODE_STRING * ObjectName</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d83/xdk_2cmfuncs_8h_source.html#l00064">cmfuncs.h:64</a></div></div>
<div class="ttc" id="axdk_2cmtypes_8h_html_a7d622c6e8def9d54f2887f46175bd0be"><div class="ttname"><a href="../../de/d2f/xdk_2cmtypes_8h.html#a7d622c6e8def9d54f2887f46175bd0be">SERVICE_RECOGNIZER_DRIVER</a></div><div class="ttdeci">#define SERVICE_RECOGNIZER_DRIVER</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2f/xdk_2cmtypes_8h_source.html#l00956">cmtypes.h:956</a></div></div>
<div class="ttc" id="axdk_2cmtypes_8h_html_af0d572c918e9e1758273b92149dabc79"><div class="ttname"><a href="../../de/d2f/xdk_2cmtypes_8h.html#af0d572c918e9e1758273b92149dabc79">SERVICE_FILE_SYSTEM_DRIVER</a></div><div class="ttdeci">#define SERVICE_FILE_SYSTEM_DRIVER</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d2f/xdk_2cmtypes_8h_source.html#l00954">cmtypes.h:954</a></div></div>
<div class="ttc" id="axdk_2exfuncs_8h_html_a32e635370272925052821e9a4a773d63"><div class="ttname"><a href="../../dd/dba/xdk_2exfuncs_8h.html#a32e635370272925052821e9a4a773d63">ExInitializeWorkItem</a></div><div class="ttdeci">#define ExInitializeWorkItem(Item, Routine, Context)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dba/xdk_2exfuncs_8h_source.html#l00265">exfuncs.h:265</a></div></div>
<div class="ttc" id="axdk_2extypes_8h_html_a9526fdfbf669a4f1ded757685b0be448a0582af2b39cb941dbea5fe0e6b3fa741"><div class="ttname"><a href="../../db/d49/xdk_2extypes_8h.html#a9526fdfbf669a4f1ded757685b0be448a0582af2b39cb941dbea5fe0e6b3fa741">DelayedWorkQueue</a></div><div class="ttdeci">@ DelayedWorkQueue</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d49/xdk_2extypes_8h_source.html#l00190">extypes.h:190</a></div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_a35f11de228808af9f90c3b963cd458e0"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#a35f11de228808af9f90c3b963cd458e0">DRVO_BUILTIN_DRIVER</a></div><div class="ttdeci">#define DRVO_BUILTIN_DRIVER</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02227">iotypes.h:2227</a></div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_a3823437693f46c40cf52800c2879d2d6"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#a3823437693f46c40cf52800c2879d2d6">IO_NO_INCREMENT</a></div><div class="ttdeci">#define IO_NO_INCREMENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l00598">iotypes.h:598</a></div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_a4c50fee2eca9a0ea94b1098ee59a9137"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#a4c50fee2eca9a0ea94b1098ee59a9137">DRIVER_OBJECT</a></div><div class="ttdeci">struct _DRIVER_OBJECT DRIVER_OBJECT</div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_a53640a56e4b226b0ad626ddea0c9a151"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#a53640a56e4b226b0ad626ddea0c9a151">PDRIVER_REINITIALIZE</a></div><div class="ttdeci">VOID(NTAPI * PDRIVER_REINITIALIZE)(_In_ struct _DRIVER_OBJECT *DriverObject, _In_opt_ PVOID Context, _In_ ULONG Count)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l04454">iotypes.h:4455</a></div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_a56f801e9f957ddfea75f7306ab84b5f1"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#a56f801e9f957ddfea75f7306ab84b5f1">PDRIVER_EXTENSION</a></div><div class="ttdeci">struct _DRIVER_EXTENSION * PDRIVER_EXTENSION</div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_a7e46add1e9b7abf819993f491892bf10"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#a7e46add1e9b7abf819993f491892bf10">DRVO_BOOTREINIT_REGISTERED</a></div><div class="ttdeci">#define DRVO_BOOTREINIT_REGISTERED</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l04471">iotypes.h:4471</a></div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_abfb03142686df4cd9bf3f3f4bce08141"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#abfb03142686df4cd9bf3f3f4bce08141">DRVO_UNLOAD_INVOKED</a></div><div class="ttdeci">#define DRVO_UNLOAD_INVOKED</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02225">iotypes.h:2225</a></div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_adb67717b473e01dadf3754c5053ab13b"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#adb67717b473e01dadf3754c5053ab13b">DRVO_REINIT_REGISTERED</a></div><div class="ttdeci">#define DRVO_REINIT_REGISTERED</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l04469">iotypes.h:4469</a></div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_ade157ec6ad626917e601334a1432402d"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#ade157ec6ad626917e601334a1432402d">IO_TYPE_DRIVER</a></div><div class="ttdeci">#define IO_TYPE_DRIVER</div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_ae5b6ac2bff8546255ae112e3031eaf73"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#ae5b6ac2bff8546255ae112e3031eaf73">DRVO_LEGACY_DRIVER</a></div><div class="ttdeci">#define DRVO_LEGACY_DRIVER</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02226">iotypes.h:2226</a></div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_afd014f12d0198da8a080c3b856803795"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#afd014f12d0198da8a080c3b856803795">IRP_MJ_MAXIMUM_FUNCTION</a></div><div class="ttdeci">#define IRP_MJ_MAXIMUM_FUNCTION</div></div>
<div class="ttc" id="axdk_2iotypes_8h_html_afd9a2a89638ac17d11c8ab2b1765cb07"><div class="ttname"><a href="../../d4/d1b/xdk_2iotypes_8h.html#afd9a2a89638ac17d11c8ab2b1765cb07">PDRIVER_INITIALIZE</a></div><div class="ttdeci">DRIVER_INITIALIZE * PDRIVER_INITIALIZE</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d1b/xdk_2iotypes_8h_source.html#l02235">iotypes.h:2235</a></div></div>
<div class="ttc" id="axdk_2kefuncs_8h_html_a2cc5c0a17902ef80dc0661ffc87634f7"><div class="ttname"><a href="../../d0/df5/xdk_2kefuncs_8h.html#a2cc5c0a17902ef80dc0661ffc87634f7">OldIrql</a></div><div class="ttdeci">_Requires_lock_held_ Interrupt _Releases_lock_ Interrupt _In_ _IRQL_restores_ KIRQL OldIrql</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/df5/xdk_2kefuncs_8h_source.html#l00792">kefuncs.h:792</a></div></div>
<div class="ttc" id="axdk_2ketypes_8h_html_a32f8868bc010efa7da787526013b93fba52c5e5ff72e961e2e009b1259be78c14"><div class="ttname"><a href="../../d7/deb/xdk_2ketypes_8h.html#a32f8868bc010efa7da787526013b93fba52c5e5ff72e961e2e009b1259be78c14">UserRequest</a></div><div class="ttdeci">@ UserRequest</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/xdk_2ketypes_8h_source.html#l00409">ketypes.h:409</a></div></div>
<div class="ttc" id="axdk_2ketypes_8h_html_a32f8868bc010efa7da787526013b93fbaef4a94e9f8e774dbbdc34d5860262fae"><div class="ttname"><a href="../../d7/deb/xdk_2ketypes_8h.html#a32f8868bc010efa7da787526013b93fbaef4a94e9f8e774dbbdc34d5860262fae">Executive</a></div><div class="ttdeci">@ Executive</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/xdk_2ketypes_8h_source.html#l00403">ketypes.h:403</a></div></div>
<div class="ttc" id="axdk_2ketypes_8h_html_a425eea3f57239dc3a8b77669eba3ca97"><div class="ttname"><a href="../../d7/deb/xdk_2ketypes_8h.html#a425eea3f57239dc3a8b77669eba3ca97">KPROCESSOR_MODE</a></div><div class="ttdeci">CCHAR KPROCESSOR_MODE</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/deb/xdk_2ketypes_8h_source.html#l00007">ketypes.h:7</a></div></div>
<div class="ttc" id="axdk_2mmfuncs_8h_html_a1ba20ae43929e8210df45da3126902ad"><div class="ttname"><a href="../../d8/db7/xdk_2mmfuncs_8h.html#a1ba20ae43929e8210df45da3126902ad">ROUND_TO_PAGES</a></div><div class="ttdeci">#define ROUND_TO_PAGES(Size)</div></div>
<div class="ttc" id="axdk_2obfuncs_8h_html_a42f8f0c0b436444dd94535fa11535d47"><div class="ttname"><a href="../../d0/dc1/xdk_2obfuncs_8h.html#a42f8f0c0b436444dd94535fa11535d47">ObDereferenceObject</a></div><div class="ttdeci">#define ObDereferenceObject</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dc1/xdk_2obfuncs_8h_source.html#l00203">obfuncs.h:203</a></div></div>
<div class="ttc" id="axdk_2psfuncs_8h_html_a5fe197230e9c4bda040a839cf3286eae"><div class="ttname"><a href="../../d7/dc1/xdk_2psfuncs_8h.html#a5fe197230e9c4bda040a839cf3286eae">PsGetCurrentProcess</a></div><div class="ttdeci">#define PsGetCurrentProcess</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc1/xdk_2psfuncs_8h_source.html#l00017">psfuncs.h:17</a></div></div>
<div class="ttc" id="axdk_2rtlfuncs_8h_html_a19cb1e15111d509d36c6a5d59f8ff9af"><div class="ttname"><a href="../../de/df5/xdk_2rtlfuncs_8h.html#a19cb1e15111d509d36c6a5d59f8ff9af">NT_ASSERT</a></div><div class="ttdeci">#define NT_ASSERT</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df5/xdk_2rtlfuncs_8h_source.html#l03310">rtlfuncs.h:3310</a></div></div>
<div class="ttc" id="axdk_2rtlfuncs_8h_html_a24df31d3375dfa4f65e93007d984d3a1"><div class="ttname"><a href="../../de/df5/xdk_2rtlfuncs_8h.html#a24df31d3375dfa4f65e93007d984d3a1">NT_VERIFY</a></div><div class="ttdeci">#define NT_VERIFY(exp)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/df5/xdk_2rtlfuncs_8h_source.html#l03287">rtlfuncs.h:3287</a></div></div>
<div class="ttc" id="axdk_2sefuncs_8h_html_a99f9d9d828428043a80a2d01a9854f11"><div class="ttname"><a href="../../d2/d87/xdk_2sefuncs_8h.html#a99f9d9d828428043a80a2d01a9854f11">PreviousMode</a></div><div class="ttdeci">_In_ KPROCESSOR_MODE PreviousMode</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d87/xdk_2sefuncs_8h_source.html#l00103">sefuncs.h:103</a></div></div>
<div class="ttc" id="axmlstorage_8h_html_a5db209418487128f0cbbe91eb4a4b560"><div class="ttname"><a href="../../dc/da3/xmlstorage_8h.html#a5db209418487128f0cbbe91eb4a4b560">WCHAR</a></div><div class="ttdeci">__wchar_t WCHAR</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/xmlstorage_8h_source.html#l00180">xmlstorage.h:180</a></div></div>
<div class="ttc" id="axmlstorage_8h_html_aebb9e13210d88d43e32e735ada43a425"><div class="ttname"><a href="../../dc/da3/xmlstorage_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a></div><div class="ttdeci">char CHAR</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da3/xmlstorage_8h_source.html#l00175">xmlstorage.h:175</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_af8ee41f3b3ee949318ebee67dfc7648.html">ntoskrnl</a></li><li class="navelem"><a class="el" href="../../dir_7a2afe904f7fa583bb70346c5f3e3e5a.html">io</a></li><li class="navelem"><a class="el" href="../../dir_38b099d204fffed626976e5701d409ed.html">iomgr</a></li><li class="navelem"><a class="el" href="../../d9/d9f/ntoskrnl_2io_2iomgr_2driver_8c.html">driver.c</a></li>
    <li class="footer">Generated on Sun Oct 1 2023 06:10:10 for ReactOS by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
